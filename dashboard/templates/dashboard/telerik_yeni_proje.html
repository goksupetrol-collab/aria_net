{% extends "dashboard/base.html" %}
{% load static %}

{% block title %}Yeni Telerik Projesi{% endblock %}

{% block extra_head %}
  <style>
    *{box-sizing:border-box}
    /* Sadece layout için minimal CSS - Telerik bileşenleri kendi stillerini kullanacak */
    .container{width:100%;height:auto;min-height:auto;padding:0;margin:0;overflow:visible}
    .header{display:none}
    .menu-container{display:none}
    #top-menu-bar{display:block !important;visibility:visible !important;width:100%;min-height:30px}
    #top-menu-bar .k-menu{display:block !important;width:100% !important;background:#fff !important}
    #top-menu-bar .k-menu-item{display:inline-block !important;visibility:visible !important}
    .content-area{width:100%;height:auto;margin-top:0;display:grid;grid-template-columns:620px 620px 640px;grid-template-rows:448px 438px;gap:5px;padding:0;max-width:100vw;overflow-x:hidden !important}
    .panel{position:relative;display:flex;flex-direction:column;overflow:hidden}
    .panel-content{flex:1;overflow:auto;position:relative}
    .mtr1-section{grid-column:1;grid-row:1}
    .mtr2-section{grid-column:2;grid-row:1}
    .right-section{grid-column:3;grid-row:1 / span 2;display:flex;flex-direction:column;gap:3px}
    .entry-section{grid-column:1;grid-row:2}
    .cars-section{grid-column:2;grid-row:2;display:flex;flex-direction:column;overflow:hidden}
    .right-column{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:600px 20px 25px 1fr;gap:3px;height:100%}
    .tahsilat-area{grid-column:1;grid-row:1}
    .odeme-area{grid-column:2;grid-row:1}
    .tahsilat-total{grid-column:1;grid-row:2;display:flex;align-items:center;justify-content:center;height:20px}
    .odeme-total{grid-column:2;grid-row:2;display:flex;align-items:center;justify-content:center;height:20px}
    .genel-total{grid-column:1 / span 2;grid-row:3;display:flex;align-items:center;justify-content:center;height:25px}
    .limits-area{grid-column:1 / span 2;grid-row:4;display:grid;grid-template-columns:1fr 1fr;gap:3px}
    .content-wrapper{width:100%;height:auto;overflow-x:hidden !important;overflow-y:auto;margin-top:0}
    
    /* Telerik Menu özelleştirmeleri - Resimdeki gibi */
    #top-menu-container{background:#e3f2fd !important}
    #top-menu-bar .k-menu{background:#e3f2fd !important;border:none !important;height:28px !important}
    #top-menu-bar .k-menu-item{background:transparent !important;border-right:1px solid #90caf9 !important;padding:4px 12px !important;height:28px !important;line-height:20px !important}
    #top-menu-bar .k-menu-item:hover{background:#bbdefb !important}
    #top-menu-bar .k-menu-item-text{font-size:11px !important;font-weight:normal !important;color:#000 !important}
    #top-menu-bar .k-menu-group{background:#fff !important;border:1px solid #90caf9 !important;box-shadow:0 2px 4px rgba(0,0,0,.1) !important}
    #top-menu-bar .k-menu-group .k-menu-item{background:#fff !important;border-right:none !important;padding:6px 12px !important;height:auto !important}
    #top-menu-bar .k-menu-group .k-menu-item:hover{background:#f5f5f5 !important}
    
    /* BAŞLIK: LOBI - Sadece menü (lobi) ekranında görünür */
    /* Başlangıçta görünür (lobi ekranı), JavaScript ile kontrol edilir */
    #title-bar{position:fixed;top:169px;left:0;right:0;z-index:9995;height:40px;background:linear-gradient(to bottom, rgb(60, 80, 100), rgb(40, 60, 80));display:flex;align-items:center;justify-content:center;padding:0;font-family:'Segoe UI',Arial,sans-serif;box-shadow:0 2px 6px rgba(0,0,0,0.2);display:none;}
    #title-bar div{color:#FFFFFF;font-size:18pt;font-weight:600;letter-spacing:1px;text-shadow:1px 1px 2px rgba(0,0,0,0.3);text-align:center;width:100%;}
    
    /* İçerik wrapper margin düzeltmesi */
    .content-wrapper{margin-top:0 !important;padding-top:0 !important;}
    
    /* İçerik alanı margin ayarı - base.html'deki main-content margin-top:169px var */
    #main-content-operasyon{margin-top:0 !important;padding-top:0 !important;display:block;}
    #main-content-kredi-karti{margin-top:0 !important;padding-top:0 !important;display:none;}
    #main-content-banka{margin-top:0 !important;padding-top:0 !important;display:none;}
    #main-content-tanker{margin-top:0 !important;padding-top:0 !important;display:none;}
    #main-content-fiyat-degisimi{margin-top:0 !important;padding-top:0 !important;display:none;}
    .container{padding:0 !important;margin:0 !important;}
    
    /* Kredi kartı ve banka sayfaları için overflow kontrolü */
    #kredi-karti-grid, #kredi-karti-grid .k-grid, #kredi-karti-grid .k-grid-content,
    #kredi-karti-grid .k-grid-header, #kredi-karti-grid .k-grid-header-wrap,
    #kredi-karti-grid .k-grid-content-wrap, #kredi-karti-grid table {overflow-x:hidden !important;max-width:100% !important;width:100% !important}
    
    #banka-grid, #banka-grid .k-grid, #banka-grid .k-grid-content,
    #banka-grid .k-grid-header, #banka-grid .k-grid-header-wrap,
    #banka-grid .k-grid-content-wrap, #banka-grid table {overflow-x:hidden !important;max-width:100% !important;width:100% !important}
    
    /* main-content içindeki tüm margin/padding sıfırla */
    #main-content > * {margin-top:0 !important;padding-top:0 !important;}
    #main-content .container {margin-top:0 !important;padding-top:0 !important;}
    #main-content .header {margin:0 !important;padding:0 !important;}
    #main-content .menu-container {margin:0 !important;padding:0 !important;}
    
    /* title-bar JavaScript ile kontrol ediliyor, CSS'de !important kullanmayalım */
    
    /* PROFESYONEL RENK PALETİ - Modern & Temiz */
    
    /* Sayfa Arka Planı */
    body, #main-content-operasyon, .content-wrapper {
      background-color: #fafafa !important;
    }
    
    /* Global Typography - Roboto font ailesi */
    .k-grid {
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif !important;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-size: 13px !important;
      line-height: 1.5 !important;
      letter-spacing: 0.01em !important;
      background-color: #ffffff !important;
    }
    
    /* Grid Header - Açık Mavi Ton, Profesyonel */
    .k-grid .k-grid-header th,
    .k-grid-header th,
    .k-grid-header-wrap th,
    .k-grid-header-wrap table th,
    .k-grid table th.k-header {
      background: linear-gradient(to bottom, #2196f3, #1976d2) !important;
      background-image: linear-gradient(to bottom, #2196f3, #1976d2) !important;
      color: #ffffff !important;
      font-weight: 600 !important;
      font-size: 12px !important;
      letter-spacing: 0.05em !important;
      text-transform: uppercase !important;
      padding: 12px 15px !important;
      border: none !important;
      border-right: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-bottom: 2px solid #1565c0 !important;
      text-align: center !important;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    }
    
    .k-grid .k-grid-header th:last-child,
    .k-grid-header th:last-child,
    .k-grid-header-wrap th:last-child {
      border-right: none !important;
    }
    
    /* Telerik'in header background override */
    .k-grid .k-grid-header,
    .k-grid-header-wrap {
      background: transparent !important;
    }
    
    /* Grid Cells - Professional padding, spacing - ÇOK GÜÇLÜ SELECTOR */
    .k-grid td,
    .k-grid tbody td,
    .k-grid-content td,
    .k-grid-content table td {
      padding: 12px 15px !important;
      border-right: 1px solid #e0e0e0 !important;
      border-bottom: 1px solid #e0e0e0 !important;
      border-top: none !important;
      font-size: 13px !important;
      line-height: 1.5 !important;
      color: #2d3748 !important;
      background-color: inherit !important;
      transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
    
    .k-grid td:last-child,
    .k-grid tbody td:last-child {
      border-right: none !important;
    }
    
    /* Row hover effect - Subtle, professional - ÇOK GÜÇLÜ */
    .k-grid tbody tr,
    .k-grid-content tbody tr {
      transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
    
    .k-grid tbody tr:hover,
    .k-grid-content tbody tr:hover {
      background-color: #e3f2fd !important;
    }
    
    /* Telerik'in hover override */
    .k-grid tbody tr:hover td,
    .k-grid-content tbody tr:hover td {
      background-color: #e3f2fd !important;
      border-color: #bbdefb !important;
    }
    
    /* Zebra striping - Temiz renkler */
    .k-grid tbody tr:nth-child(even),
    .k-grid-content tbody tr:nth-child(even) {
      background-color: #fafafa !important;
    }
    
    .k-grid tbody tr:nth-child(odd),
    .k-grid-content tbody tr:nth-child(odd) {
      background-color: #ffffff !important;
    }
    
    /* Telerik'in default background'larını override et */
    .k-grid tbody tr.k-alt,
    .k-grid tbody tr.k-state-selected {
      background-color: inherit !important;
    }
    
    /* Grid border radius - Modern look - ÇOK GÜÇLÜ */
    .k-grid,
    #motorin-grid,
    #benzin-grid,
    #tahsilat-grid,
    #odeme-grid,
    #hypco-grid,
    #aygaz-grid,
    #yakit-alimlari-grid,
    #araclar-grid {
      border-radius: 8px !important;
      overflow: hidden !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      border: 1px solid #e0e0e0 !important;
      background-color: #ffffff !important;
    }
    
    /* Grid header border radius */
    .k-grid-header,
    .k-grid .k-grid-header {
      border-radius: 8px 8px 0 0 !important;
    }
    
    /* Focus state - Professional */
    .k-grid td:focus,
    .k-grid td.k-state-focused {
      outline: 2px solid #4299e1 !important;
      outline-offset: -2px !important;
      background-color: #ebf8ff !important;
    }
    
    /* Editable cell styling */
    .k-grid td input {
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif !important;
      font-size: 13px !important;
      padding: 8px 12px !important;
      border: 1px solid rgba(0, 0, 0, 0.12) !important;
      border-radius: 4px !important;
      transition: border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }
    
    .k-grid td input:focus {
      border-color: #4299e1 !important;
      outline: none !important;
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1) !important;
    }
    
    /* Special row styling - Başlık satırları (KAPASİTE, ANLIK, SATIŞ, TARİH) - Açık & Temiz */
    .k-grid .header-row,
    .k-grid tbody tr.header-row,
    .k-grid-content tbody tr.header-row,
    .k-grid tbody tr.header-row td,
    .k-grid-content tbody tr.header-row td {
      background-color: #e3f2fd !important;
      color: #1565c0 !important;
      font-weight: 600 !important;
      border-top: 2px solid #2196f3 !important;
      border-bottom: 1px solid #bbdefb !important;
    }
    
    .k-grid .header-row td,
    .k-grid tbody tr.header-row td,
    .k-grid-content tbody tr.header-row td {
      color: #1565c0 !important;
      border-right: 1px solid #bbdefb !important;
      background-color: #e3f2fd !important;
    }
    
    /* Telerik override - header-row için */
    .k-grid tbody tr.header-row.k-alt,
    .k-grid tbody tr.header-row:hover {
      background-color: #e3f2fd !important;
    }
    
    .k-grid tbody tr.header-row:hover td {
      background-color: #bbdefb !important;
      color: #0d47a1 !important;
    }
    
    /* Sub-header row styling - Tarih satırları (Perşembe, Cuma, Cumartesi) - Açık & Temiz */
    .k-grid .sub-header-row,
    .k-grid tbody tr.sub-header-row,
    .k-grid-content tbody tr.sub-header-row,
    .k-grid tbody tr.sub-header-row td,
    .k-grid-content tbody tr.sub-header-row td {
      background-color: #f5f5f5 !important;
      color: #424242 !important;
      font-weight: 500 !important;
      border-top: 1px solid #e0e0e0 !important;
      border-bottom: 1px solid #e0e0e0 !important;
    }
    
    .k-grid .sub-header-row td,
    .k-grid tbody tr.sub-header-row td,
    .k-grid-content tbody tr.sub-header-row td {
      color: #424242 !important;
      border-right: 1px solid #e0e0e0 !important;
      background-color: #f5f5f5 !important;
    }
    
    /* Telerik override - sub-header-row için */
    .k-grid tbody tr.sub-header-row.k-alt,
    .k-grid tbody tr.sub-header-row:hover {
      background-color: #f5f5f5 !important;
    }
    
    .k-grid tbody tr.sub-header-row:hover td {
      background-color: #eeeeee !important;
      color: #212121 !important;
    }
    
    /* Number alignment - Right align for numbers */
    .k-grid .number-cell {
      text-align: right !important;
      font-variant-numeric: tabular-nums !important;
    }
    
    /* Center alignment */
    .k-grid .center-cell {
      text-align: center !important;
    }
    
    /* Panel Başlıkları - Açık Mavi Gradient */
    #motorin-toolbar > div,
    #benzin-toolbar > div,
    #tahsilat-toolbar > div,
    #odeme-toolbar > div,
    #hypco-toolbar > div,
    #aygaz-toolbar > div,
    #yakit-toolbar > div,
    #nakliye-toolbar > div {
      width: 100% !important;
      height: 36px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      font-family: 'Roboto', sans-serif !important;
      font-size: 13px !important;
      font-weight: 600 !important;
      letter-spacing: 0.05em !important;
      text-transform: uppercase !important;
      background: linear-gradient(to bottom, #2196f3, #1976d2) !important;
      color: #ffffff !important;
      border-radius: 8px 8px 0 0 !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      border-bottom: 2px solid #1565c0 !important;
    }
    
    /* Toplam çubukları */
    #tahsilat-total > div,
    #odeme-total > div,
    #genel-total > div {
      width: 100% !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      font-family: 'Roboto', sans-serif !important;
      font-weight: 600 !important;
      border-radius: 4px !important;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    #tahsilat-total > div {
      height: 24px !important;
      font-size: 12px !important;
      background: linear-gradient(to bottom, #48bb78, #38a169) !important;
      color: #ffffff !important;
    }
    
    #odeme-total > div {
      height: 24px !important;
      font-size: 12px !important;
      background: linear-gradient(to bottom, #f56565, #e53e3e) !important;
      color: #ffffff !important;
    }
    
    #genel-total > div {
      height: 28px !important;
      font-size: 13px !important;
      background: linear-gradient(to bottom, #4299e1, #3182ce) !important;
      color: #ffffff !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }
  </style>
{% endblock %}

{% block content %}
  <!-- BAŞLIK: LOBI - Sadece menü (lobi) ekranında görünür -->
  <div id="title-bar">
    <div>LOBI</div>
  </div>
  
  <div class="container" id="main-content-operasyon" style="display:block;">
    <div class="header">
      <div id="header-toolbar"></div>
    </div>
    
    <!-- Sol Üstte Kompakt Menü Yapısı -->
    <div class="menu-container">
      <!-- Altında: 3 İkonlu Buton - Kompakt -->
      <div id="middle-buttons" style="display:flex;gap:5px;padding:5px 0;margin-top:5px"></div>
      
      <!-- En Alt: 2 Sabit Öğe - Kompakt -->
      <div id="bottom-fixed" style="display:flex;gap:5px;padding:5px 0;margin-top:5px"></div>
    </div>
    
    <!-- İçerik Alanı (Dinamik) -->
    <div class="content-wrapper">
    <div class="content-area">
      <!-- MOTORİN Tablosu (Sol Üst) - Telerik PanelBar -->
      <div class="panel mtr1-section">
        <div id="motorin-toolbar"></div>
        <div class="panel-content">
          <div id="motorin-grid"></div>
        </div>
      </div>

      <!-- BENZİN Tablosu (Orta Üst) - Telerik PanelBar -->
      <div class="panel mtr2-section">
        <div id="benzin-toolbar"></div>
        <div class="panel-content">
          <div id="benzin-grid"></div>
        </div>
      </div>

      <!-- Sağ Blok -->
      <div class="right-section">
        <div class="right-column">
          <!-- TAHSİLAT Tablosu - Telerik Toolbar -->
          <div class="panel tahsilat-area">
            <div id="tahsilat-toolbar"></div>
            <div class="panel-content">
              <div id="tahsilat-grid"></div>
            </div>
          </div>

          <!-- ÖDEME Tablosu - Telerik Toolbar -->
          <div class="panel odeme-area">
            <div id="odeme-toolbar"></div>
            <div class="panel-content">
              <div id="odeme-grid"></div>
            </div>
          </div>

          <!-- Toplamlar - Telerik Badge/Label -->
          <div id="tahsilat-total" class="tahsilat-total"></div>
          <div id="odeme-total" class="odeme-total"></div>
          <div id="genel-total" class="genel-total"></div>

          <!-- HYPCO ve AYGAZ - Telerik Toolbar -->
          <div class="limits-area">
            <div class="panel">
              <div id="hypco-toolbar"></div>
              <div class="panel-content">
                <div id="hypco-grid"></div>
              </div>
            </div>
            <div class="panel">
              <div id="aygaz-toolbar"></div>
              <div class="panel-content">
                <div id="aygaz-grid"></div>
              </div>
            </div>
          </div>
          
          <!-- EXCEL DOSYASI YÜKLEME -->
          <div style="padding:15px;background:#fff;border-radius:8px;margin:10px 0;box-shadow:0 2px 4px rgba(0,0,0,0.1);">
            <div style="font-weight:bold;margin-bottom:10px;font-size:14px;color:#2d3748;">EXCEL DOSYASI YÜKLEME</div>
            <div id="upload-area" style="min-height:50px;"></div>
            <div id="upload-progress" style="margin-top:10px;display:none;padding:5px;background:#f0f0f0;border-radius:4px;font-size:12px;color:#2d3748;"></div>
          </div>
          
          <!-- ŞUBE BAZLI SATIŞ GRAFİĞİ -->
          <div style="padding:10px;background:#fff;border-radius:8px;margin:10px 0;box-shadow:0 2px 4px rgba(0,0,0,0.1);">
            <div style="font-weight:bold;margin-bottom:10px;font-size:14px;color:#2d3748;">ŞUBE BAZLI SATIŞ GRAFİĞİ</div>
            <div id="satis-grafik" style="height:300px;"></div>
          </div>
        </div>
      </div>

      <!-- YAKIT ALIMLARI (Sol Alt) - Telerik Toolbar -->
      <div class="panel entry-section">
        <div id="yakit-toolbar"></div>
        <div class="panel-content">
          <div id="yakit-alimlari-grid"></div>
        </div>
      </div>

      <!-- ARAÇLAR (Orta Alt) - Telerik Toolbar -->
      <div class="panel cars-section">
        <div id="nakliye-toolbar"></div>
        <div class="panel-content" style="overflow-y:auto;overflow-x:auto;">
          <div id="araclar-grid"></div>
        </div>
      </div>
    </div>
    </div>
  </div>

  <!-- KREDİ KARTI SAYFASI -->
  <div class="container" id="main-content-kredi-karti" style="display:none;padding:0;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">KREDİ KARTI TAKİP</h1>
    <div id="kredi-karti-grid" style="width:100%;max-width:100vw;height:800px;overflow-x:hidden !important;overflow-y:auto;margin:0;padding:0;"></div>
  </div>

  <!-- BANKA SAYFASI -->
  <div class="container" id="main-content-banka" style="display:none;padding:0;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">BANKA HESAP TAKİP</h1>
    <div id="banka-grid" style="width:100%;max-width:100vw;height:800px;overflow-x:hidden !important;overflow-y:auto;margin:0;padding:0;"></div>
  </div>

  <!-- TANKER SAYFASI -->
  <div class="container" id="main-content-tanker" style="display:none;padding:20px;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">TANKER</h1>
    <p style="text-align:center;color:#666;margin:20px 0;">Boş sayfa</p>
  </div>

  <!-- KREDİ KARTI SAYFASI -->
  <div class="container" id="main-content-kredi-karti" style="display:none;padding:0;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">KREDİ KARTI TAKİP</h1>
    <div id="kredi-karti-grid" style="width:100%;max-width:100vw;height:800px;overflow-x:hidden !important;overflow-y:auto;margin:0;padding:0;"></div>
  </div>

  <!-- BANKA SAYFASI -->
  <div class="container" id="main-content-banka" style="display:none;padding:0;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">BANKA HESAP TAKİP</h1>
    <div id="banka-grid" style="width:100%;max-width:100vw;height:800px;overflow-x:hidden !important;overflow-y:auto;margin:0;padding:0;"></div>
  </div>

  <!-- TANKER SAYFASI -->
  <div class="container" id="main-content-tanker" style="display:none;padding:20px;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">TANKER</h1>
    <p style="text-align:center;color:#666;margin:20px 0;">Boş sayfa</p>
  </div>

  <!-- FİYAT DEĞİŞİMİ SAYFASI -->
  <div class="container" id="main-content-fiyat-degisimi" style="display:none;padding:20px;width:100%;max-width:100vw;overflow-x:hidden !important;overflow-y:auto;box-sizing:border-box;margin:0;">
    <h1 style="text-align:center;color:#206d7d;margin:10px 0;font-size:20pt;font-weight:bold;">FİYAT DEĞİŞİMİ - TELERİK BİLEŞEN ÖRNEKLERİ</h1>
    
    <!-- 1. AUTOCOMPLETE -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">1. AUTOCOMPLETE (Otomatik Tamamlama)</h3>
      <p style="color:#666;font-size:12px;">Google arama gibi - "Aria" yazınca altında öneriler çıkar</p>
      <input id="autocomplete-fiyat" style="width:100%;max-width:400px;" placeholder="Firma adı yazın..." />
    </div>

    <!-- 2. PROGRESSBAR -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">2. PROGRESSBAR (İlerleme Çubuğu)</h3>
      <p style="color:#666;font-size:12px;">Dosya indirirken gördüğün çubuk gibi</p>
      <div id="progressbar-fiyat" style="width:100%;max-width:400px;"></div>
      <button onclick="testProgressBar()" style="margin-top:10px;padding:5px 15px;background:#206d7d;color:white;border:none;border-radius:3px;cursor:pointer;">İlerlemeyi Başlat</button>
    </div>

    <!-- 3. MULTISELECT -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">3. MULTISELECT (Çoklu Seçim)</h3>
      <p style="color:#666;font-size:12px;">WhatsApp'ta grup seçerken gibi - birden fazla şeyi seçebilirsin</p>
      <select id="multiselect-fiyat" multiple="multiple" style="width:100%;max-width:400px;"></select>
    </div>

    <!-- 4. DROPDOWNLIST -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">4. DROPDOWNLIST (Açılır Liste)</h3>
      <p style="color:#666;font-size:12px;">Açılır kutu - tıklayınca liste açılır, birini seçersin</p>
      <input id="dropdownlist-fiyat" style="width:100%;max-width:400px;" />
    </div>

    <!-- 5. MASKEDTEXTBOX -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">5. MASKEDTEXTBOX (Maskeli Metin)</h3>
      <p style="color:#666;font-size:12px;">Telefon numarası yazarken otomatik tire koyar</p>
      <input id="maskedtextbox-fiyat" style="width:100%;max-width:400px;" placeholder="Telefon: 555-123-4567" />
    </div>

    <!-- 6. GAUGE -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">6. GAUGE (Gösterge)</h3>
      <p style="color:#666;font-size:12px;">Araba göstergesi gibi - yuvarlak, içinde yüzde yazar</p>
      <div id="gauge-fiyat" style="width:100%;max-width:300px;height:200px;"></div>
    </div>

    <!-- 7. SPARKLINE -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">7. SPARKLINE (Mini Grafik)</h3>
      <p style="color:#666;font-size:12px;">Tabloda her satırın yanında küçük bir çizgi grafik</p>
      <div id="sparkline-fiyat" style="width:100%;max-width:400px;height:100px;"></div>
    </div>

    <!-- 8. EDITOR -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">8. EDITOR (Zengin Metin Editörü)</h3>
      <p style="color:#666;font-size:12px;">Word'de yazı yazarken gibi - kalın, italik, renkli yap</p>
      <textarea id="editor-fiyat" style="width:100%;max-width:600px;height:200px;"></textarea>
    </div>

    <!-- 9. COLORPICKER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">9. COLORPICKER (Renk Seçici)</h3>
      <p style="color:#666;font-size:12px;">Paint'te renk seçerken gibi - renk kutusu açılır</p>
      <input id="colorpicker-fiyat" style="width:100%;max-width:200px;" />
    </div>

    <!-- 10. SLIDER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">10. SLIDER (Kaydırıcı)</h3>
      <p style="color:#666;font-size:12px;">Ses açma/kapama çubuğu gibi - sağa sola kaydırırsın</p>
      <div id="slider-fiyat" style="width:100%;max-width:400px;"></div>
      <p id="slider-value-fiyat" style="margin-top:10px;font-weight:bold;color:#206d7d;">Değer: 50</p>
    </div>

    <!-- 11. FILTER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">11. FILTER (Filtre)</h3>
      <p style="color:#666;font-size:12px;">Excel'de filtre yaparken gibi - tarih aralığı, miktar aralığı filtrele</p>
      <div id="filter-fiyat" style="width:100%;max-width:600px;"></div>
    </div>

    <!-- 12. PIVOTGRID -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">12. PIVOTGRID (Pivot Tablo)</h3>
      <p style="color:#666;font-size:12px;">Excel'de pivot tablo yaparken gibi - şubeleri sütunlara koy, ürünleri satırlara koy</p>
      <div id="pivotgrid-fiyat" style="width:100%;max-width:800px;height:400px;"></div>
    </div>

    <!-- 13. DATETIMEPICKER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">13. DATETIMEPICKER (Tarih + Saat)</h3>
      <p style="color:#666;font-size:12px;">Takvimden tarih seç, sonra saat seç - ikisi bir arada</p>
      <input id="datetimepicker-fiyat" style="width:100%;max-width:300px;" />
    </div>

    <!-- 14. TIMEPICKER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">14. TIMEPICKER (Saat Seçici)</h3>
      <p style="color:#666;font-size:12px;">Saat seçerken gibi - saat ve dakika seçersin</p>
      <input id="timepicker-fiyat" style="width:100%;max-width:200px;" />
    </div>

    <!-- 15. LISTBOX -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">15. LISTBOX (Liste Kutusu)</h3>
      <p style="color:#666;font-size:12px;">Yan yana iki kutu - solda tüm liste, sağda seçtiklerin</p>
      <select id="listbox-fiyat" multiple="multiple" style="width:100%;max-width:400px;height:200px;"></select>
    </div>

    <!-- 16. TREEVIEW -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">16. TREEVIEW (Ağaç Görünümü)</h3>
      <p style="color:#666;font-size:12px;">Windows'ta klasörler gibi - ana klasör var, tıklayınca alt klasörler açılır</p>
      <div id="treeview-fiyat" style="width:100%;max-width:400px;"></div>
    </div>

    <!-- 17. TOOLTIP -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">17. TOOLTIP (İpucu)</h3>
      <p style="color:#666;font-size:12px;">Butonun üzerine fareyi getirince küçük bir kutu çıkar, açıklama yazar</p>
      <button id="tooltip-button-fiyat" style="padding:10px 20px;background:#206d7d;color:white;border:none;border-radius:3px;cursor:pointer;">Üzerime Gel</button>
    </div>

    <!-- 18. SPLITTER -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">18. SPLITTER (Bölücü)</h3>
      <p style="color:#666;font-size:12px;">İki panel arasında ince bir çizgi var, sürükleyince panellerin boyutu değişir</p>
      <div id="splitter-fiyat" style="width:100%;max-width:600px;height:300px;"></div>
    </div>

    <!-- 19. PANELBAR -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">19. PANELBAR (Panel Çubuğu)</h3>
      <p style="color:#666;font-size:12px;">Başlığa tıklayınca içerik açılır/kapanır, accordion gibi</p>
      <div id="panelbar-fiyat" style="width:100%;max-width:500px;"></div>
    </div>

    <!-- 20. MAP -->
    <div style="margin:20px 0;padding:15px;border:1px solid #ddd;border-radius:5px;background:#f9f9f9;">
      <h3 style="color:#206d7d;margin-top:0;">20. MAP (Harita)</h3>
      <p style="color:#666;font-size:12px;">Google Maps gibi - haritada şubelerin yerleri işaretli görünür</p>
      <div id="map-fiyat" style="width:100%;max-width:600px;height:400px;"></div>
    </div>

  </div>

  <!-- FIRMA YÖNETİMİ WINDOW -->
  <div id="firma-window" style="display:none;">
    <div id="firma-grid-container" style="padding:10px;height:100%;">
      <div id="firma-grid" style="height:500px;"></div>
    </div>
  </div>
  
  <!-- ÜRÜN YÖNETİMİ WINDOW -->
  <div id="urun-window" style="display:none;">
    <div id="urun-grid-container" style="padding:10px;height:100%;">
      <div id="urun-grid" style="height:500px;"></div>
    </div>
  </div>
  
  <!-- TANIMLAR ALT MENÜ -->
  <div id="tanimlar-menu" style="position:fixed;top:28px;left:0;background:#FFFFFF;border:1px solid #E0E0E0;box-shadow:0 2px 4px rgba(0,0,0,0.1);z-index:10001;display:none;min-width:200px;">
    <div id="tanimlar-firmalar" style="padding:5px 15px;cursor:pointer;border-bottom:1px solid #F0F0F0;">Firmalar</div>
    <div id="tanimlar-urunler" style="padding:5px 15px;cursor:pointer;">Ürünler</div>
  </div>
{% endblock %}

{% block extra_scripts %}
  <script>
    // Telerik Menüler ve Toolbar'lar
    $(document).ready(function() {
      // EN ÜST: 2 Açılır Menü (Tanımlar ve Kartlar) - Telerik Menu (HTML yapısı ile)
      // Telerik dokümantasyonuna göre: HTML <ul><li> yapısı kullanılmalı
      function initTelerikMenu() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoMenu !== 'undefined') {
          try {
            $("#top-menu-bar").kendoMenu({
              orientation: "horizontal",
              openOnClick: false,
              animation: false,
              select: function(e) {
                console.log("Menü tıklandı:", $(e.item).text());
              }
            });
            console.log("✅ Telerik Menu başarıyla oluşturuldu!");
          } catch(error) {
            console.error("❌ Telerik Menu oluşturulurken hata:", error);
            console.error("Hata detayı:", error.message, error.stack);
          }
        } else {
          console.log("⏳ Telerik yükleniyor, bekleniyor... (kendo:", typeof kendo, ", kendoMenu:", typeof $.fn.kendoMenu, ")");
          setTimeout(initTelerikMenu, 100);
        }
      }
      initTelerikMenu();
      
      // NOT: Ribbon butonlarına tıklama base.html'de tanımlı, burada tekrar tanımlamaya gerek yok
      // base.html'deki handler tüm sayfalarda çalışıyor
      
      // İlk açılışta hiçbir buton aktif değil (lobi gibi)
      var currentPage = null; // Şu anki sayfa yok
      
      // İçeriği gizle (ilk açılışta boş ekran - lobi)
      // Ama eğer eski program sayfasından geliyorsa veya sessionStorage'da flag varsa içeriği göster ve tab aç
      setTimeout(function() {
        var showContent = false;
        var hasTabs = false;
        
        // F5 yapıldı mı kontrol et - Performance Navigation API kullan
        var isPageRefresh = false;
        if (performance.navigation) {
          // Eski API (deprecated ama hala çalışıyor)
          isPageRefresh = (performance.navigation.type === 1); // TYPE_RELOAD = 1
        } else if (performance.getEntriesByType) {
          // Yeni API
          var navEntries = performance.getEntriesByType('navigation');
          if (navEntries.length > 0) {
            isPageRefresh = (navEntries[0].type === 'reload');
          }
        }
        
        // Eğer referrer yoksa veya aynı sayfa ise, F5 yapılmış olabilir
        if (!isPageRefresh) {
          var referrerPath = document.referrer ? new URL(document.referrer).pathname : '';
          var currentPath = window.location.pathname;
          if (!document.referrer || referrerPath === currentPath || referrerPath === '/' && currentPath === '/') {
            isPageRefresh = true;
          }
        }
        
        // Eğer F5 yapılmadıysa (başka bir sayfadan geldiyse), sessionStorage'dan tab'ları yükle
        if (!isPageRefresh) {
          loadTabsFromStorage();
          hasTabs = Object.keys(openTabs).length > 0;
        }
        
        // Referrer kontrolü kaldırıldı (eski program silindi)
        
        // SessionStorage kontrolü
        if (sessionStorage.getItem('showOperasyonContent') === 'true') {
          showContent = true;
          sessionStorage.removeItem('showOperasyonContent'); // Temizle
        }
        
        // Eğer tab'lar varsa içeriği göster
        if (hasTabs) {
          showContent = true;
        }
        
        if (showContent) {
          // İçeriği göster
          $('#main-content-operasyon').show();
          setActiveRibbonButton('operasyon_sayfasi');
          
          // Başlığı gizle (operasyon sayfası açıldı)
          $('#title-bar').hide();
          
          // Eğer tab yoksa Operasyon Sayfası tab'ını aç
          if (!hasTabs) {
            var operasyonItem = menuItems.find(function(item) { return item.name === 'operasyon_sayfasi'; });
            if (operasyonItem) {
              var tabBaslik = operasyonItem.tab_baslik || operasyonItem.baslik;
              openTab(tabBaslik, 'operasyon_sayfasi', operasyonItem.icon);
            }
          }
        } else {
          // Lobi ekranı - başlığı göster, içeriği gizle
          $('#main-content-operasyon').hide();
          $('#title-bar').show();
        }
      }, 50);
      
      // NOT: Ribbon butonlarına hover efekti base.html'de tanımlı, burada tekrar tanımlamaya gerek yok
      // NOT: Tab yönetimi (openTabs, activeTabId, openTab, setActiveTab, closeTab, saveTabsToStorage, loadTabsFromStorage, createTabElement, findTabByTitle, setActiveRibbonButton) base.html'de tanımlı, burada tekrar tanımlamaya gerek yok
      
      // TANIMLAR menüsüne tıklama - Alt menü aç
      $("#top-menu-bar-container span").first().on("click", function(e) {
        e.stopPropagation();
        var menu = $("#tanimlar-menu");
        if (menu.is(":visible")) {
          menu.hide();
        } else {
          var offset = $(this).offset();
          menu.css({
            top: offset.top + $(this).outerHeight(),
            left: offset.left
          }).show();
        }
      });
      
      // Dışarı tıklayınca menüyü kapat
      $(document).on("click", function(e) {
        if (!$(e.target).closest("#top-menu-bar-container span").first().length && 
            !$(e.target).closest("#tanimlar-menu").length) {
          kapatTanimlarMenu();
        }
      });
      
      function kapatTanimlarMenu() {
        $("#tanimlar-menu").hide();
      }
      
      // Alt menü item'larına tıklama
      $("#tanimlar-firmalar").on("click", function(e) {
        e.stopPropagation();
        console.log("Firmalar tıklandı");
        acFirmaYonetimPenceresi();
        kapatTanimlarMenu();
      });
      
      $("#tanimlar-urunler").on("click", function(e) {
        e.stopPropagation();
        console.log("Ürünler tıklandı");
        acUrunYonetimPenceresi();
        kapatTanimlarMenu();
      });
      
      // Hover efektleri
      $("#tanimlar-firmalar, #tanimlar-urunler").hover(
        function() { $(this).css("background", "#F5F5F5"); },
        function() { $(this).css("background", "#FFFFFF"); }
      );
      
      // FIRMA YÖNETİMİ PENCERESİ
      function acFirmaYonetimPenceresi() {
        // Window oluştur
        if (!$("#firma-window").data("kendoWindow")) {
          $("#firma-window").kendoWindow({
            title: "Firma Tanımları",
            width: 800,
            height: 600,
            modal: true,
            visible: false,
            actions: ["Close"],
            open: function() {
              // Grid'i oluştur
              console.log("Firma penceresi açıldı, grid oluşturuluyor...");
              setTimeout(function() {
                olusturFirmaGrid();
              }, 100);
            }
          });
        }
        
        var window = $("#firma-window").data("kendoWindow");
        window.center().open();
      }
      
      // FIRMA GRID'İ OLUŞTUR
      function olusturFirmaGrid() {
        // Önceki grid varsa yok et
        if ($("#firma-grid").data("kendoGrid")) {
          $("#firma-grid").data("kendoGrid").destroy();
        }
        
        console.log("Firma grid oluşturuluyor...");
        
        // Önce API'den veriyi test et
        $.ajax({
          url: "/api/firmalar/",
          type: "GET",
          dataType: "json",
          success: function(data) {
            console.log("API başarılı, veri:", data);
            console.log("Veri tipi:", typeof data, "Uzunluk:", Array.isArray(data) ? data.length : "Array değil");
            
            // Grid container'ı kontrol et
            var gridContainer = $("#firma-grid");
            if (gridContainer.length === 0) {
              console.error("Grid container bulunamadı! #firma-grid");
              if (typeof showWarning === 'function') {
                showWarning("Grid container bulunamadı!");
              } else {
                alert("Grid container bulunamadı!");
              }
              return;
            }
            console.log("Grid container bulundu:", gridContainer.length);
            
            // Önceki grid varsa yok et
            if (gridContainer.data("kendoGrid")) {
              console.log("Eski grid yok ediliyor...");
              gridContainer.data("kendoGrid").destroy();
            }
            
            // Grid'i oluştur
            gridContainer.kendoGrid({
              dataSource: {
                data: data,
                schema: {
                  model: {
                    id: "id",
                    fields: {
                      id: { type: "number", editable: false },
                      sira_no: { type: "number", validation: { required: true, min: 1 } },
                      ad: { type: "string", validation: { required: true } },
                      aktif: { type: "boolean", defaultValue: true }
                    }
                  }
                },
                pageSize: 20
              },
              height: 500,
              scrollable: true,
              sortable: true,
              filterable: false,
              pageable: {
                pageSizes: [10, 20, 50],
                buttonCount: 5
              },
              toolbar: [
                { name: "create", text: "Yeni Firma Ekle" },
                { name: "save", text: "Kaydet" },
                { name: "cancel", text: "İptal" }
              ],
              messages: {
                commands: {
                  edit: "Düzenle",
                  destroy: "Sil",
                  canceledit: "İptal",
                  update: "Güncelle"
                }
              },
              editable: {
                mode: "incell",
                confirmation: "Silmek istediğinizden emin misiniz?"
              },
              columns: [
                { field: "sira_no", title: "Sıra No", width: 100 },
                { field: "ad", title: "Firma Adı", width: 300 },
                { field: "aktif", title: "Aktif", width: 80, template: "#= aktif ? 'Evet' : 'Hayır' #" },
                { 
                  command: [
                    { name: "edit", text: "Düzenle", className: "k-button k-button-sm" },
                    { name: "destroy", text: "Sil", className: "k-button k-button-sm" }
                  ], 
                  title: "İşlemler", 
                  width: 150 
                }
              ],
              dataBound: function(e) {
                console.log("Grid yüklendi, kayıt sayısı:", e.sender.dataSource.total());
                console.log("Grid verileri:", e.sender.dataSource.data());
                if (e.sender.dataSource.total() === 0) {
                  console.warn("UYARI: Grid'de hiç veri yok!");
                }
              },
              error: function(e) {
                console.error("Grid hatası:", e);
              }
            });
          },
          error: function(xhr, status, error) {
            console.error("API hatası:", status, error, xhr.responseText);
            var errorMessage = "Firmalar yüklenirken hata oluştu: " + error;
            if (typeof showError === 'function') {
              showError(errorMessage);
            } else {
              alert(errorMessage + "\n\nDetay: " + xhr.responseText);
            }
          }
        });
      }
      
      // ÜRÜN YÖNETİMİ PENCERESİ
      function acUrunYonetimPenceresi() {
        // Window oluştur
        if (!$("#urun-window").data("kendoWindow")) {
          $("#urun-window").kendoWindow({
            title: "Ürün Tanımları",
            width: 800,
            height: 600,
            modal: true,
            visible: false,
            actions: ["Close"],
            open: function() {
              console.log("Ürün penceresi açıldı, grid oluşturuluyor...");
              setTimeout(function() {
                olusturUrunGrid();
              }, 100);
            }
          });
        }
        
        var window = $("#urun-window").data("kendoWindow");
        window.center().open();
      }
      
      // ÜRÜN GRID'İ OLUŞTUR
      function olusturUrunGrid() {
        // Önceki grid varsa yok et
        if ($("#urun-grid").data("kendoGrid")) {
          $("#urun-grid").data("kendoGrid").destroy();
        }
        
        console.log("Ürün grid oluşturuluyor...");
        
        // Önce API'den veriyi test et
        $.ajax({
          url: "/api/urunler/",
          type: "GET",
          dataType: "json",
          success: function(data) {
            console.log("API başarılı, veri:", data);
            console.log("Veri tipi:", typeof data, "Uzunluk:", Array.isArray(data) ? data.length : "Array değil");
            
            // Grid container'ı kontrol et
            var gridContainer = $("#urun-grid");
            if (gridContainer.length === 0) {
              console.error("Grid container bulunamadı! #urun-grid");
              if (typeof showWarning === 'function') {
                showWarning("Grid container bulunamadı!");
              } else {
                alert("Grid container bulunamadı!");
              }
              return;
            }
            console.log("Grid container bulundu:", gridContainer.length);
            
            // Önceki grid varsa yok et
            if (gridContainer.data("kendoGrid")) {
              console.log("Eski grid yok ediliyor...");
              gridContainer.data("kendoGrid").destroy();
            }
            
            // Grid'i oluştur
            gridContainer.kendoGrid({
              dataSource: {
                data: data,
                schema: {
                  model: {
                    id: "id",
                    fields: {
                      id: { type: "number", editable: false },
                      sira_no: { type: "number", validation: { required: true, min: 1 } },
                      ad: { type: "string", validation: { required: true } },
                      aktif: { type: "boolean", defaultValue: true }
                    }
                  }
                },
                pageSize: 20
              },
              height: 500,
              scrollable: true,
              sortable: true,
              filterable: false,
              pageable: {
                pageSizes: [10, 20, 50],
                buttonCount: 5
              },
              toolbar: [
                { name: "create", text: "Yeni Ürün Ekle" },
                { name: "save", text: "Kaydet" },
                { name: "cancel", text: "İptal" }
              ],
              editable: {
                mode: "incell",
                confirmation: "Silmek istediğinizden emin misiniz?"
              },
              columns: [
                { field: "sira_no", title: "Sıra No", width: 100 },
                { field: "ad", title: "Ürün Adı", width: 300 },
                { field: "aktif", title: "Aktif", width: 80, template: "#= aktif ? 'Evet' : 'Hayır' #" },
                { 
                  command: [
                    { name: "edit", text: "Düzenle", className: "k-button k-button-sm" },
                    { name: "destroy", text: "Sil", className: "k-button k-button-sm" }
                  ], 
                  title: "İşlemler", 
                  width: 150 
                }
              ],
              messages: {
                commands: {
                  edit: "Düzenle",
                  destroy: "Sil",
                  canceledit: "İptal",
                  update: "Güncelle"
                }
              },
              dataBound: function(e) {
                console.log("Grid yüklendi, kayıt sayısı:", e.sender.dataSource.total());
                console.log("Grid verileri:", e.sender.dataSource.data());
                if (e.sender.dataSource.total() === 0) {
                  console.warn("UYARI: Grid'de hiç veri yok!");
                }
              },
              error: function(e) {
                console.error("Grid hatası:", e);
              }
            });
          },
          error: function(xhr, status, error) {
            console.error("API hatası:", status, error, xhr.responseText);
            var errorMessage = "Ürünler yüklenirken hata oluştu: " + error;
            if (typeof showError === 'function') {
              showError(errorMessage);
            } else {
              alert(errorMessage + "\n\nDetay: " + xhr.responseText);
            }
          }
        });
      }
      
      // Panel Başlıkları - Profesyonel Gradient Stil
      var headerStyle = 'width:100%;height:36px;display:flex;align-items:center;justify-content:center;font-family:"Roboto",sans-serif;font-size:13px;font-weight:600;letter-spacing:0.05em;text-transform:uppercase;background:linear-gradient(to bottom, #4a5568, #2d3748);color:#ffffff;border-radius:8px 8px 0 0;box-shadow:0 2px 4px rgba(0,0,0,0.1);transition:all 0.2s cubic-bezier(0.4,0,0.2,1);';
      $("#motorin-toolbar").html('<div style="' + headerStyle + '">MOTORİN</div>');
      $("#benzin-toolbar").html('<div style="' + headerStyle + '">BENZİN</div>');
      $("#tahsilat-toolbar").html('<div style="' + headerStyle + '">TAHSİLAT</div>');
      $("#odeme-toolbar").html('<div style="' + headerStyle + '">ÖDEME</div>');
      $("#hypco-toolbar").html('<div style="' + headerStyle + '">HYPCO</div>');
      $("#aygaz-toolbar").html('<div style="' + headerStyle + '">AYGAZ</div>');
      $("#yakit-toolbar").html('<div style="' + headerStyle + '">YAKIT ALIMLARI</div>');
      $("#nakliye-toolbar").html('<div style="' + headerStyle + '">NAKLİYE</div>');
      
      // Header - Profesyonel Typography
      $("#header-toolbar").html('<h1 style="margin:0;font-family:\'Roboto\',sans-serif;color:#2d3748;font-size:24px;font-weight:600;letter-spacing:0.01em;line-height:1.3;">Yeni Bir Proje</h1>');
      
      // Toplam çubukları - Profesyonel Stil
      var totalStyle = 'width:100%;height:24px;display:flex;align-items:center;justify-content:center;font-family:"Roboto",sans-serif;font-size:12px;font-weight:600;border-radius:4px;transition:all 0.2s cubic-bezier(0.4,0,0.2,1);';
      $("#tahsilat-total").html('<div style="' + totalStyle + 'background:linear-gradient(to bottom, #48bb78, #38a169);color:#ffffff;box-shadow:0 1px 3px rgba(0,0,0,0.1);">₺0</div>');
      $("#odeme-total").html('<div style="' + totalStyle + 'background:linear-gradient(to bottom, #f56565, #e53e3e);color:#ffffff;box-shadow:0 1px 3px rgba(0,0,0,0.1);">₺0</div>');
      $("#genel-total").html('<div style="' + totalStyle + 'height:28px;font-size:13px;background:linear-gradient(to bottom, #4299e1, #3182ce);color:#ffffff;box-shadow:0 2px 4px rgba(0,0,0,0.15);">₺0</div>');
    });
    
    $(document).ready(function() {
      // MOTORİN Tablosu - 8 sütun, 27 satır
      var motorinColumns = [
        { field: "mtr", title: "MTR", width: 110, locked: true, editable: false },
        { field: "yagcilar", title: "YAĞCILAR", width: "auto" },
        { field: "tepekum", title: "TEPEKUM", width: "auto" },
        { field: "namdar", title: "NAMDAR", width: "auto" },
        { field: "seker", title: "ŞEKER", width: "auto" },
        { field: "akova", title: "AKOVA", width: "auto" },
        { field: "koop", title: "KOOP.", width: "auto" },
        { field: "nazilli", title: "NAZİLLİ", width: "auto" }
      ];
      
      var motorinData = [];
      var motorinRowLabels = ["KAPASİTE", "ANLIK", "SATIŞ", "TARİH"];
      var subeAdlari = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
      
      // İlk 4 satır: KAPASİTE, ANLIK, SATIŞ, TARİH
      var motorinKapasite = ["100.000", "100.000", "29.000", "60.000", "50.000", "60.000", "70.000"];
      for (var i = 0; i < 4; i++) {
        var row = { mtr: motorinRowLabels[i] };
        if (i === 0) { // KAPASİTE satırı - değerler
          for (var j = 0; j < 7; j++) {
            row[motorinColumns[j+1].field] = motorinKapasite[j];
          }
        } else if (i === 3) { // TARİH satırı - şube adları
          for (var j = 0; j < 7; j++) {
            row[motorinColumns[j+1].field] = subeAdlari[j];
          }
        } else {
          for (var j = 1; j < 8; j++) {
            row[motorinColumns[j].field] = "";
          }
        }
        motorinData.push(row);
      }
      
      // Tarih satırları: Perşembe, Cuma, Cumartesi ve boş satırlar
      var tarihSatirlari = ["Perşembe", "Cuma", "Cumartesi"];
      for (var i = 0; i < 23; i++) {
        var row = { mtr: i < 3 ? tarihSatirlari[i] : "" };
        for (var j = 1; j < 8; j++) {
          row[motorinColumns[j].field] = "";
        }
        motorinData.push(row);
      }
      
      // MOTORİN Grid'i oluştur - Profesyonel Stil
      $("#motorin-grid").kendoGrid({
        dataSource: { data: motorinData, pageSize: 100 },
        height: 420,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: motorinColumns.map(function(col) {
          if (col.field === "mtr") {
            return col;
          }
          return {
            field: col.field,
            title: col.title,
            width: col.width,
            attributes: { class: "number-cell", style: "text-align: right;" }
          };
        }),
        edit: function(e) {
          var dataItem = e.model;
          var mtrValue = dataItem.mtr;
          if (mtrValue === "KAPASİTE" || mtrValue === "ANLIK" || mtrValue === "TARİH") {
            e.container.find("input").prop("readonly", true);
          }
        },
        dataBound: function(e) {
          var grid = this;
          grid.tbody.find("tr").each(function(index) {
            var row = $(this);
            var mtrCell = row.find("td:first");
            var mtrValue = mtrCell.text().trim();
            
            // Başlık satırları için özel stil
            if (mtrValue && (mtrValue === "KAPASİTE" || mtrValue === "ANLIK" || mtrValue === "SATIŞ" || mtrValue === "TARİH")) {
              row.addClass("header-row");
            } else if (mtrValue && (mtrValue === "Perşembe" || mtrValue === "Cuma" || mtrValue === "Cumartesi")) {
              row.addClass("sub-header-row");
            }
          });
        }
      });

      // BENZİN Tablosu - 8 sütun, 27 satır
      var benzinData = [];
      var benzinRowLabels = ["KAPASİTE", "ANLIK", "SATIŞ", "TARİH"];
      
      // İlk 4 satır: KAPASİTE, ANLIK, SATIŞ, TARİH
      var benzinKapasite = ["20.000", "10.000", "9.000", "20.000", "10.000", "20.000", "15.000"];
      for (var i = 0; i < 4; i++) {
        var row = { mtr: benzinRowLabels[i] };
        if (i === 0) { // KAPASİTE satırı - değerler
          for (var j = 0; j < 7; j++) {
            row[motorinColumns[j+1].field] = benzinKapasite[j];
          }
        } else if (i === 3) { // TARİH satırı - şube adları
          for (var j = 0; j < 7; j++) {
            row[motorinColumns[j+1].field] = subeAdlari[j];
          }
        } else {
          for (var j = 1; j < 8; j++) {
            row[motorinColumns[j].field] = "";
          }
        }
        benzinData.push(row);
      }
      
      // Tarih satırları: Perşembe, Cuma, Cumartesi ve boş satırlar
      for (var i = 0; i < 23; i++) {
        var row = { mtr: i < 3 ? tarihSatirlari[i] : "" };
        for (var j = 1; j < 8; j++) {
          row[motorinColumns[j].field] = "";
        }
        benzinData.push(row);
      }
      
      $("#benzin-grid").kendoGrid({
        dataSource: { data: benzinData, pageSize: 100 },
        height: 420,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: motorinColumns.map(function(col) {
          if (col.field === "mtr") {
            return col;
          }
          return {
            field: col.field,
            title: col.title,
            width: col.width,
            attributes: { class: "number-cell", style: "text-align: right;" }
          };
        }),
        edit: function(e) {
          var dataItem = e.model;
          var mtrValue = dataItem.mtr;
          if (mtrValue === "KAPASİTE" || mtrValue === "ANLIK" || mtrValue === "TARİH") {
            e.container.find("input").prop("readonly", true);
          }
        },
        dataBound: function(e) {
          var grid = this;
          grid.tbody.find("tr").each(function(index) {
            var row = $(this);
            var mtrCell = row.find("td:first");
            var mtrValue = mtrCell.text().trim();
            
            if (mtrValue && (mtrValue === "KAPASİTE" || mtrValue === "ANLIK" || mtrValue === "SATIŞ" || mtrValue === "TARİH")) {
              row.addClass("header-row");
            } else if (mtrValue && (mtrValue === "Perşembe" || mtrValue === "Cuma" || mtrValue === "Cumartesi")) {
              row.addClass("sub-header-row");
            }
          });
        }
      });

      // TAHSİLAT Tablosu - 3 sütun, 35 satır
      var tahsilatData = [];
      for (var i = 0; i < 35; i++) {
        tahsilatData.push({ aciklama: "", tl: "", onay: "" });
      }
      
      $("#tahsilat-grid").kendoGrid({
        dataSource: { data: tahsilatData, pageSize: 100 },
        height: 572,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "aciklama", title: "AÇIKLAMA", width: "auto" },
          { 
            field: "tl", 
            title: "TL", 
            width: 80, 
            attributes: { class: "number-cell", style: "text-align: right;" },
            editor: function(container, options) {
              $('<input name="' + options.field + '"/>')
                .appendTo(container)
                .kendoNumericTextBox({
                  format: "n2",
                  decimals: 2,
                  culture: "tr-TR",
                  value: options.model[options.field] || 0,
                  min: 0
                });
            }
          },
          { field: "onay", title: "ONAY", width: 80, attributes: { class: "center-cell", style: "text-align: center;" } }
        ]
      });

      // ÖDEME Tablosu - 3 sütun, 35 satır
      var odemeData = [];
      for (var i = 0; i < 35; i++) {
        odemeData.push({ aciklama: "", tl: "", onay: "" });
      }
      
      $("#odeme-grid").kendoGrid({
        dataSource: { data: odemeData, pageSize: 100 },
        height: 572,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "aciklama", title: "AÇIKLAMA", width: "auto" },
          { 
            field: "tl", 
            title: "TL", 
            width: 80, 
            attributes: { class: "number-cell", style: "text-align: right;" },
            editor: function(container, options) {
              $('<input name="' + options.field + '"/>')
                .appendTo(container)
                .kendoNumericTextBox({
                  format: "n2",
                  decimals: 2,
                  culture: "tr-TR",
                  value: options.model[options.field] || 0,
                  min: 0
                });
            }
          },
          { field: "onay", title: "ONAY", width: 80, attributes: { class: "center-cell", style: "text-align: center;" } }
        ]
      });

      // HYPCO Tablosu - 4 sütun, 3 satır
      var hypcoData = [
        { firma: "Aria", nakit_limit: "", dbs_limit: "", top_borc: "" },
        { firma: "Namdar", nakit_limit: "", dbs_limit: "", top_borc: "" },
        { firma: "", nakit_limit: "", dbs_limit: "", top_borc: "" }
      ];
      
      $("#hypco-grid").kendoGrid({
        dataSource: { data: hypcoData, pageSize: 10 },
        height: 122,
        scrollable: false,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "firma", title: "Firma", width: "25%" },
          { field: "nakit_limit", title: "Nakit Limit", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "dbs_limit", title: "DBS Limit", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "top_borc", title: "Top. Borç", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } }
        ]
      });

      // AYGAZ Tablosu - 4 sütun, 3 satır
      var aygazData = [
        { firma: "Aria", nakit_limit: "", dbs_limit: "", top_borc: "" },
        { firma: "Namdar", nakit_limit: "", dbs_limit: "", top_borc: "" },
        { firma: "", nakit_limit: "", dbs_limit: "", top_borc: "" }
      ];
      
      $("#aygaz-grid").kendoGrid({
        dataSource: { data: aygazData, pageSize: 10 },
        height: 122,
        scrollable: false,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "firma", title: "Firma", width: "25%" },
          { field: "nakit_limit", title: "Nakit Limit", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "dbs_limit", title: "DBS Limit", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "top_borc", title: "Top. Borç", width: "25%", attributes: { class: "number-cell", style: "text-align: right;" } }
        ]
      });

      // YAKIT ALIMLARI Tablosu - 6 sütun, 30 satır
      var yakitData = [];
      for (var i = 0; i < 30; i++) {
        yakitData.push({ firma: "", urun: "", litre: "", tl: "", odeme_tur: "", onay: "" });
      }
      
      $("#yakit-alimlari-grid").kendoGrid({
        dataSource: { data: yakitData, pageSize: 100 },
        height: 410,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "firma", title: "FİRMA", width: "16.66%" },
          { field: "urun", title: "ÜRÜN", width: "16.66%" },
          { field: "litre", title: "LİTRE", width: "16.66%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "tl", title: "TL", width: "16.66%", attributes: { class: "number-cell", style: "text-align: right;" } },
          { field: "odeme_tur", title: "ÖDEME TÜR", width: "16.66%" },
          { field: "onay", title: "ONAY", width: "16.66%", attributes: { class: "center-cell", style: "text-align: center;" } }
        ]
      });

      // ARAÇLAR Tablosu - 20 araç kartı, her biri 4 sütun, 8 satır
      var aracData = [];
      for (var arac = 1; arac <= 20; arac++) {
        for (var satir = 1; satir <= 8; satir++) {
          aracData.push({
            arac_no: satir === 1 ? arac + " ARAÇ" : "",
            a: "",
            b: "",
            c: "",
            d: ""
          });
        }
      }
      
      $("#araclar-grid").kendoGrid({
        dataSource: { data: aracData, pageSize: 100 },
        height: 410,
        scrollable: true,
        navigatable: true,
        editable: {
          mode: "incell",
          update: true
        },
        sortable: false,
        filterable: false,
        selectable: false,
        pageable: false,
        resizable: true,
        columns: [
          { field: "arac_no", title: "ARAÇ", width: 100, locked: true },
          { field: "a", title: "A", width: "25%" },
          { field: "b", title: "B", width: "25%" },
          { field: "c", title: "C", width: "25%" },
          { field: "d", title: "D", width: "25%" }
        ],
        dataBound: function(e) {
          var grid = this;
          grid.tbody.find("tr").each(function(index) {
            var row = $(this);
            var aracCell = row.find("td:first");
            var aracValue = aracCell.text().trim();
            
            // Araç başlık satırları için özel stil
            if (aracValue && aracValue.match(/\d+\s+ARAÇ/)) {
              row.addClass("header-row");
            }
          });
        }
      });
      
      // COMBOBOX LİSTE VERİLERİ (Tüm Grid'lerde kullanılacak)
      var bankaListesi = [
        "Ziraat Bankası",
        "İş Bankası",
        "Garanti BBVA",
        "Akbank",
        "Yapı Kredi",
        "Halkbank",
        "Vakıfbank",
        "QNB Finansbank",
        "Denizbank",
        "TEB"
      ];
      
      var paraBirimiListesi = ["TL", "USD", "EUR", "GBP"];
      
      var hesapTuruListesi = ["Vadeli", "Vadesiz", "Tasarruf", "Cari"];
      
      var subeListesi = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
      
      // KREDİ KARTI GRID
      setTimeout(function() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoGrid !== 'undefined') {
          var emptyRows = [];
          for (var i = 0; i < 20; i++) {
            emptyRows.push({
              son_odeme: null,
              kalan_gun: null,
              tutar: "",
              banka: "",
              kime_ait: "",
              kart_numarasi: "",
              son_kullanim_tarihi: "",
              cv: "",
              iban: "",
              sifre: "",
              sutun1: "",
              sutun2: "",
              sutun3: ""
            });
          }
          
          var containerWidth = $("#kredi-karti-grid").parent().width() || $(window).width();
          var gridWidth = Math.min(containerWidth, 1920);
          
          $("#kredi-karti-grid").kendoGrid({
            dataSource: {
              data: emptyRows,
              schema: {
                model: {
                  fields: {
                    son_odeme: { type: "date" },
                    kalan_gun: { type: "number" },
                    tutar: { type: "string" },
                    banka: { type: "string" },
                    kime_ait: { type: "string" },
                    kart_numarasi: { type: "string" },
                    son_kullanim_tarihi: { type: "string" },
                    cv: { type: "string" },
                    iban: { type: "string" },
                    sifre: { type: "string" },
                    sutun1: { type: "string" },
                    sutun2: { type: "string" },
                    sutun3: { type: "string" }
                  }
                }
              }
            },
            width: gridWidth,
            height: "100%",
            scrollable: false,
            sortable: true,
            filterable: true,
            resizable: false,
            pageable: false,
            editable: {
              mode: "incell",
              update: true
            },
            columns: [
              { 
                field: "son_odeme", 
                title: "SON ÖDEME", 
                width: 125, 
                format: "{0:dd.MM.yyyy}",
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoDatePicker({
                      culture: "tr-TR",
                      format: "dd.MM.yyyy",
                      value: options.model[options.field] || null
                    });
                }
              },
              { field: "kalan_gun", title: "KALAN GÜN", width: 95, attributes: { class: "center-cell", style: "text-align: center;" } },
              { 
                field: "tutar", 
                title: "TUTAR", 
                width: 115, 
                attributes: { class: "number-cell", style: "text-align: right;" },
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoNumericTextBox({
                      format: "n2",
                      decimals: 2,
                      culture: "tr-TR",
                      value: options.model[options.field] || 0,
                      min: 0
                    });
                }
              },
              { 
                field: "banka", 
                title: "BANKA", 
                width: 135,
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoComboBox({
                      dataSource: bankaListesi,
                      filter: "contains",
                      placeholder: "Banka seçin...",
                      suggest: true,
                      value: options.model[options.field] || ""
                    });
                }
              },
              { field: "kime_ait", title: "KİME AİT", width: 115 },
              { field: "kart_numarasi", title: "KART NUMARASI", width: 175 },
              { field: "son_kullanim_tarihi", title: "SON KULLANMA TARİHİ", width: 135 },
              { field: "cv", title: "CV", width: 65, attributes: { class: "center-cell", style: "text-align: center;" } },
              { field: "iban", title: "İBAN", width: 195 },
              { field: "sifre", title: "ŞİFRE", width: 75, attributes: { class: "center-cell", style: "text-align: center;" } },
              { field: "sutun1", title: "Sütun1", width: 115 },
              { field: "sutun2", title: "Sütun2", width: 145 },
              { field: "sutun3", title: "Sütun3", width: 115 }
            ]
          });
        }
      }, 200);
      
      // BANKA GRID
      setTimeout(function() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoGrid !== 'undefined') {
          var emptyRows = [];
          for (var i = 0; i < 20; i++) {
            emptyRows.push({
              banka_adi: "",
              hesap_numarasi: "",
              iban: "",
              bakiye: "",
              para_birimi: "",
              hesap_turu: "",
              sube: "",
              acilis_tarihi: null,
              durum: "",
              sutun1: "",
              sutun2: "",
              sutun3: ""
            });
          }
          
          var containerWidth = $("#banka-grid").parent().width() || $(window).width();
          var gridWidth = Math.min(containerWidth, 1920);
          
          $("#banka-grid").kendoGrid({
            dataSource: {
              data: emptyRows,
              schema: {
                model: {
                  fields: {
                    banka_adi: { type: "string" },
                    hesap_numarasi: { type: "string" },
                    iban: { type: "string" },
                    bakiye: { type: "string" },
                    para_birimi: { type: "string" },
                    hesap_turu: { type: "string" },
                    sube: { type: "string" },
                    acilis_tarihi: { type: "date" },
                    durum: { type: "string" },
                    sutun1: { type: "string" },
                    sutun2: { type: "string" },
                    sutun3: { type: "string" }
                  }
                }
              }
            },
            width: gridWidth,
            height: "100%",
            scrollable: false,
            sortable: true,
            filterable: true,
            resizable: false,
            pageable: false,
            editable: {
              mode: "incell",
              update: true
            },
            columns: [
              { 
                field: "banka_adi", 
                title: "BANKA ADI", 
                width: 150,
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoComboBox({
                      dataSource: bankaListesi,
                      filter: "contains",
                      placeholder: "Banka seçin...",
                      suggest: true,
                      value: options.model[options.field] || ""
                    });
                }
              },
              { field: "hesap_numarasi", title: "HESAP NUMARASI", width: 150 },
              { field: "iban", title: "İBAN", width: 250 },
              { 
                field: "bakiye", 
                title: "BAKİYE", 
                width: 130, 
                attributes: { class: "number-cell", style: "text-align: right;" },
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoNumericTextBox({
                      format: "n2",
                      decimals: 2,
                      culture: "tr-TR",
                      value: options.model[options.field] || 0,
                      min: 0
                    });
                }
              },
              { 
                field: "para_birimi", 
                title: "PARA BİRİMİ", 
                width: 110, 
                attributes: { class: "center-cell", style: "text-align: center;" },
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoComboBox({
                      dataSource: paraBirimiListesi,
                      filter: "contains",
                      placeholder: "Para birimi seçin...",
                      suggest: true,
                      value: options.model[options.field] || ""
                    });
                }
              },
              { 
                field: "hesap_turu", 
                title: "HESAP TÜRÜ", 
                width: 120,
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoComboBox({
                      dataSource: hesapTuruListesi,
                      filter: "contains",
                      placeholder: "Hesap türü seçin...",
                      suggest: true,
                      value: options.model[options.field] || ""
                    });
                }
              },
              { 
                field: "sube", 
                title: "ŞUBE", 
                width: 120,
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoComboBox({
                      dataSource: subeListesi,
                      filter: "contains",
                      placeholder: "Şube seçin...",
                      suggest: true,
                      value: options.model[options.field] || ""
                    });
                }
              },
              { 
                field: "acilis_tarihi", 
                title: "AÇILIŞ TARİHİ", 
                width: 130, 
                format: "{0:dd.MM.yyyy}",
                editor: function(container, options) {
                  $('<input name="' + options.field + '"/>')
                    .appendTo(container)
                    .kendoDatePicker({
                      culture: "tr-TR",
                      format: "dd.MM.yyyy",
                      value: options.model[options.field] || null
                    });
                }
              },
              { field: "durum", title: "DURUM", width: 100, attributes: { class: "center-cell", style: "text-align: center;" } },
              { field: "sutun1", title: "Sütun1", width: 140 },
              { field: "sutun2", title: "Sütun2", width: 140 },
              { field: "sutun3", title: "Sütun3", width: 140 }
            ]
          });
        }
      }, 200);
      
      // ŞUBE BAZLI SATIŞ GRAFİĞİ
      setTimeout(function() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoChart !== 'undefined') {
          $("#satis-grafik").kendoChart({
            dataSource: {
              data: [
                { sube: "YAĞCILAR", motorin: 100000, benzin: 50000 },
                { sube: "TEPEKUM", motorin: 100000, benzin: 45000 },
                { sube: "NAMDAR", motorin: 29000, benzin: 25000 },
                { sube: "ŞEKER", motorin: 60000, benzin: 40000 },
                { sube: "AKOVA", motorin: 50000, benzin: 35000 },
                { sube: "KOOP.", motorin: 60000, benzin: 30000 },
                { sube: "NAZİLLİ", motorin: 70000, benzin: 40000 }
              ]
            },
            title: {
              text: "Şube Bazlı Satış Karşılaştırması",
              font: "14px 'Segoe UI', Arial, sans-serif",
              color: "#2d3748"
            },
            legend: {
              position: "top",
              labels: {
                font: "12px 'Segoe UI', Arial, sans-serif"
              }
            },
            seriesDefaults: {
              type: "column",
              gap: 0.5
            },
            series: [{
              name: "Motorin",
              field: "motorin",
              color: "#4CAF50"
            }, {
              name: "Benzin",
              field: "benzin",
              color: "#2196F3"
            }],
            categoryAxis: {
              field: "sube",
              labels: {
                rotation: -45,
                font: "11px 'Segoe UI', Arial, sans-serif"
              }
            },
            valueAxis: {
              labels: {
                format: "N0",
                font: "11px 'Segoe UI', Arial, sans-serif"
              },
              title: {
                text: "Satış (Litre)",
                font: "12px 'Segoe UI', Arial, sans-serif"
              }
            },
            tooltip: {
              visible: true,
              format: "{0}",
              template: "#= series.name #: #= kendo.format('{0:N0}', value) # Litre"
            }
          });
        }
      }, 300);
      
      // EXCEL DOSYASI YÜKLEME
      setTimeout(function() {
        console.log("🔔 Upload başlatılıyor...");
        console.log("kendo var mı?", typeof kendo !== 'undefined');
        console.log("kendoUpload var mı?", typeof $.fn.kendoUpload !== 'undefined');
        console.log("#upload-area elementi var mı?", $("#upload-area").length);
        console.log("jQuery var mı?", typeof $ !== 'undefined');
        
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoUpload !== 'undefined' && $("#upload-area").length > 0) {
          try {
            // Önce mevcut upload varsa yok et
            var existingUpload = $("#upload-area").data("kendoUpload");
            if (existingUpload) {
              existingUpload.destroy();
              console.log("Eski upload yok edildi");
            }
            
            // Upload bileşenini başlat
            var upload = $("#upload-area").kendoUpload({
              async: {
                saveUrl: "/api/upload-excel/",
                autoUpload: true
              },
              multiple: false,
              showFileList: false,  // Dosya listesini gizle, sadece buton göster
              validation: {
                allowedExtensions: [".xlsx", ".xls"],
                maxFileSize: 10485760  // 10 MB
              },
              upload: function(e) {
                // Yükleme başladı
                console.log("📤 Yükleme başladı:", e.files[0].name);
                $("#upload-progress").show().html("Yükleniyor...");
              },
              success: function(e) {
                // Yükleme başarılı
                console.log("✅ Yükleme başarılı:", e.response);
                var response = e.response;
                if (response && response.success) {
                  var message = "Dosya başarıyla yüklendi: " + (response.filename || "Excel dosyası");
                  if (typeof showSuccess === 'function') {
                    showSuccess(message);
                  } else {
                    alert(message);
                  }
                } else {
                  var errorMsg = response && response.error ? response.error : "Dosya yüklendi ancak işlenirken hata oluştu";
                  if (typeof showError === 'function') {
                    showError(errorMsg);
                  } else {
                    alert(errorMsg);
                  }
                }
                $("#upload-progress").hide();
              },
              error: function(e) {
                // Yükleme hatası
                console.error("❌ Yükleme hatası:", e);
                var response = e.response;
                var errorMsg = "Dosya yüklenirken hata oluştu";
                
                if (response) {
                  try {
                    if (typeof response === 'string') {
                      var parsed = JSON.parse(response);
                      errorMsg = parsed.error || errorMsg;
                    } else if (response.error) {
                      errorMsg = response.error;
                    }
                  } catch(e) {
                    console.error("JSON parse hatası:", e);
                  }
                }
                
                if (typeof showError === 'function') {
                  showError(errorMsg);
                } else {
                  alert(errorMsg);
                }
                $("#upload-progress").hide();
              },
              progress: function(e) {
                // İlerleme güncellemesi
                var percentComplete = e.percentComplete || 0;
                $("#upload-progress").html("Yükleniyor: %" + Math.round(percentComplete));
              },
              select: function(e) {
                // Dosya seçildi
                console.log("📁 Dosya seçildi:", e.files);
                var files = e.files;
                if (files.length > 0) {
                  var file = files[0];
                  var fileSize = (file.size / 1024 / 1024).toFixed(2);
                  $("#upload-progress").show().html("Dosya seçildi: " + file.name + " (" + fileSize + " MB)");
                }
              }
            }).data("kendoUpload");
            
            console.log("✅ Upload başarıyla başlatıldı!", upload);
            
            // Upload HTML'inin oluşmasını bekle ve buton metnini değiştir
            var checkUploadReady = function(attempt) {
              attempt = attempt || 0;
              var maxAttempts = 15;
              
              // Buton #upload-area içinde değil, parent veya kardeş elementlerde olabilir
              var $uploadArea = $("#upload-area");
              var $uploadButton = $uploadArea.siblings(".k-upload-button").add($uploadArea.find(".k-upload-button")).add($uploadArea.parent().find(".k-upload-button"));
              var $fileInput = $uploadArea.find("input[type='file']").add($uploadArea.siblings("input[type='file']")).add($uploadArea.parent().find("input[type='file']"));
              
              console.log("Kontrol " + attempt + ": Buton=" + $uploadButton.length + ", FileInput=" + $fileInput.length);
              console.log("Upload area HTML:", $uploadArea.html().substring(0, 200));
              console.log("Upload area parent:", $uploadArea.parent().html().substring(0, 300));
              
              if ($uploadButton.length > 0) {
                // Buton metnini değiştir (Telerik'in handler'ına dokunmadan)
                var $span = $uploadButton.find(".k-button-text, span");
                if ($span.length > 0) {
                  $span.text("Dosya Seç");
                  console.log("✅ Buton metni değiştirildi: Dosya Seç");
                } else {
                  $uploadButton.text("Dosya Seç");
                  console.log("✅ Buton metni direkt değiştirildi: Dosya Seç");
                }
                
                // "Drop files here" metnini değiştir
                $uploadArea.find(".k-dropzone, .k-upload-files").add($uploadArea.siblings(".k-dropzone")).each(function() {
                  var $dropzone = $(this);
                  var html = $dropzone.html();
                  if (html) {
                    html = html.replace(/Drop files here to upload/gi, "Dosyaları buraya sürükleyin");
                    html = html.replace(/Select files\.\.\./gi, "Dosya Seç");
                    $dropzone.html(html);
                  }
                });
                
                // File input'u bul ve ayarla
                if ($fileInput.length > 0) {
                  console.log("✅ File input bulundu!");
                  $fileInput.css({
                    position: "absolute",
                    opacity: 0,
                    width: "100%",
                    height: "100%",
                    cursor: "pointer",
                    zIndex: 10
                  });
                  
                  // Buton tıklanınca file input'u tetikle
                  $uploadButton.off("click.upload-custom").on("click.upload-custom", function(e) {
                    console.log("📁 Upload butonuna tıklandı!");
                    e.preventDefault();
                    e.stopPropagation();
                    $fileInput.first().trigger("click");
                    return false;
                  });
                } else {
                  // File input yoksa, Telerik'in kendi handler'ının çalışmasına izin ver
                  console.log("⚠️ File input bulunamadı, Telerik'in kendi handler'ı kullanılacak");
                  console.log("Upload bileşeni:", upload);
                  console.log("Upload metodları:", Object.keys(upload || {}));
                  
                  // Telerik Upload'un kendi handler'ına dokunmuyoruz
                  // Sadece buton metnini değiştirdik, handler çalışmaya devam edecek
                  // Telerik Upload buton tıklandığında otomatik olarak file input oluşturur ve tetikler
                  
                  // Buton tıklanınca file input'un oluşup oluşmadığını kontrol et
                  // Telerik Upload buton tıklandığında file input'u dinamik olarak oluşturur
                  $uploadButton.on("click.upload-test", function(e) {
                    console.log("📁 Upload butonuna tıklandı (test)!");
                    
                    // Telerik'in handler'ının çalışmasına izin ver (preventDefault yapmıyoruz)
                    // Handler çalıştıktan sonra file input'u kontrol et
                    setTimeout(function() {
                      var $newFileInput = $(upload.wrapper).find("input[type='file']");
                      console.log("Tıklamadan sonra file input sayısı:", $newFileInput.length);
                      if ($newFileInput.length > 0) {
                        console.log("✅ File input oluşturuldu!");
                        console.log("File input:", $newFileInput[0]);
                      } else {
                        console.log("❌ File input hala oluşturulmadı!");
                        console.log("Wrapper HTML:", $(upload.wrapper).html().substring(0, 500));
                      }
                    }, 100);
                  });
                  
                  // Upload bileşeninin tüm metodlarını listele
                  console.log("Upload bileşeni detayları:");
                  console.log("- element:", upload.element);
                  console.log("- options:", upload.options);
                  console.log("- wrapper:", upload.wrapper);
                  
                  // Upload wrapper'ı kontrol et
                  if (upload.wrapper) {
                    console.log("Upload wrapper HTML:", $(upload.wrapper).html().substring(0, 500));
                    var $wrapperFileInput = $(upload.wrapper).find("input[type='file']");
                    console.log("Wrapper içinde file input:", $wrapperFileInput.length);
                    
                    // Dropzone hint metnini değiştir
                    $(upload.wrapper).find(".k-dropzone-hint").text("Dosyaları buraya sürükleyin");
                  }
                }
                
                console.log("✅ Upload hazır! Buton metni Türkçe, Telerik'in handler'ı aktif.");
              } else if (attempt < maxAttempts) {
                // Henüz hazır değil, tekrar dene
                setTimeout(function() {
                  checkUploadReady(attempt + 1);
                }, 200);
              } else {
                console.error("❌ Upload butonu bulunamadı!");
                console.error("Upload area:", $uploadArea[0]);
                console.error("Upload area parent:", $uploadArea.parent()[0]);
              }
            };
            
            // İlk kontrolü başlat
            setTimeout(function() {
              checkUploadReady(0);
            }, 500);
            
          } catch(error) {
            console.error("❌ Upload başlatılırken hata:", error);
            console.error("Hata detayı:", error.stack);
            $("#upload-progress").html("Upload başlatılamadı: " + error.message).show();
          }
        } else {
          console.error("❌ Telerik Upload yüklenmemiş veya element bulunamadı!");
          console.error("kendo:", typeof kendo);
          console.error("kendoUpload:", typeof $.fn.kendoUpload);
          console.error("upload-area:", $("#upload-area").length);
          $("#upload-progress").html("Upload bileşeni yüklenemedi. Sayfayı yenileyin.").show();
        }
      }, 500);
    });

    // ============================================
    // FİYAT DEĞİŞİMİ SAYFASI - TÜM BİLEŞEN ÖRNEKLERİ
    // ============================================
    
    $(document).ready(function() {
      // Sayfa görünür olduğunda bileşenleri başlat
      var checkFiyatPage = setInterval(function() {
        if ($('#main-content-fiyat-degisimi').is(':visible')) {
          clearInterval(checkFiyatPage);
          initFiyatBilesenleri();
        }
      }, 100);
    });

    function initFiyatBilesenleri() {
      console.log("✅ Fiyat Değişimi sayfası bileşenleri başlatılıyor...");

      // 1. AUTOCOMPLETE
      try {
        $('#autocomplete-fiyat').kendoAutoComplete({
          dataSource: ['Aria Petrol', 'Aria Net', 'Aria Lojistik', 'Petrol Ofisi', 'BP', 'Shell'],
          filter: 'contains',
          placeholder: 'Firma adı yazın...',
          minLength: 1
        });
        console.log("✅ AutoComplete başlatıldı");
      } catch(e) { console.error("❌ AutoComplete hatası:", e); }

      // 2. PROGRESSBAR
      try {
        $('#progressbar-fiyat').kendoProgressBar({
          value: 0,
          min: 0,
          max: 100
        });
        console.log("✅ ProgressBar başlatıldı");
      } catch(e) { console.error("❌ ProgressBar hatası:", e); }

      // 3. MULTISELECT
      try {
        $('#multiselect-fiyat').kendoMultiSelect({
          dataSource: ['YAĞCILAR', 'TEPEKUM', 'NAMDAR', 'MERKEZ', 'ŞUBE 1', 'ŞUBE 2'],
          placeholder: 'Şube seçin...',
          value: []
        });
        console.log("✅ MultiSelect başlatıldı");
      } catch(e) { console.error("❌ MultiSelect hatası:", e); }

      // 4. DROPDOWNLIST
      try {
        $('#dropdownlist-fiyat').kendoDropDownList({
          dataSource: ['Aktif', 'Pasif', 'Beklemede'],
          optionLabel: 'Durum seçin...'
        });
        console.log("✅ DropDownList başlatıldı");
      } catch(e) { console.error("❌ DropDownList hatası:", e); }

      // 5. MASKEDTEXTBOX
      try {
        $('#maskedtextbox-fiyat').kendoMaskedTextBox({
          mask: '000-000-0000',
          value: ''
        });
        console.log("✅ MaskedTextBox başlatıldı");
      } catch(e) { console.error("❌ MaskedTextBox hatası:", e); }

      // 6. GAUGE
      try {
        $('#gauge-fiyat').kendoRadialGauge({
          pointer: {
            value: 75
          },
          scale: {
            min: 0,
            max: 100,
            majorUnit: 20,
            minorUnit: 5
          }
        });
        console.log("✅ Gauge başlatıldı");
      } catch(e) { console.error("❌ Gauge hatası:", e); }

      // 7. SPARKLINE
      try {
        $('#sparkline-fiyat').kendoSparkline({
          data: [10, 20, 15, 30, 25, 40, 35, 50, 45, 60],
          type: 'line',
          color: '#206d7d'
        });
        console.log("✅ Sparkline başlatıldı");
      } catch(e) { console.error("❌ Sparkline hatası:", e); }

      // 8. EDITOR
      try {
        $('#editor-fiyat').kendoEditor({
          tools: ['bold', 'italic', 'underline', 'foreColor', 'backColor', 'createLink', 'insertImage'],
          value: '<p>Buraya zengin metin yazabilirsiniz...</p>'
        });
        console.log("✅ Editor başlatıldı");
      } catch(e) { console.error("❌ Editor hatası:", e); }

      // 9. COLORPICKER
      try {
        $('#colorpicker-fiyat').kendoColorPicker({
          value: '#206d7d',
          buttons: true
        });
        console.log("✅ ColorPicker başlatıldı");
      } catch(e) { console.error("❌ ColorPicker hatası:", e); }

      // 10. SLIDER
      try {
        $('#slider-fiyat').kendoSlider({
          min: 0,
          max: 100,
          value: 50,
          change: function(e) {
            $('#slider-value-fiyat').text('Değer: ' + e.value);
          }
        });
        console.log("✅ Slider başlatıldı");
      } catch(e) { console.error("❌ Slider hatası:", e); }

      // 11. FILTER
      try {
        var filterData = [
          { id: 1, name: 'Motorin', price: 25.50, date: new Date('2024-01-15') },
          { id: 2, name: 'Benzin', price: 30.00, date: new Date('2024-01-16') },
          { id: 3, name: 'LPG', price: 15.75, date: new Date('2024-01-17') }
        ];
        $('#filter-fiyat').kendoFilter({
          dataSource: {
            data: filterData,
            schema: {
              model: {
                fields: {
                  name: { type: 'string' },
                  price: { type: 'number' },
                  date: { type: 'date' }
                }
              }
            }
          },
          expression: {
            logic: 'and',
            filters: []
          }
        });
        console.log("✅ Filter başlatıldı");
      } catch(e) { console.error("❌ Filter hatası:", e); }

      // 12. PIVOTGRID
      try {
        var pivotData = [
          { row: 'Motorin', column: 'YAĞCILAR', value: 1000 },
          { row: 'Motorin', column: 'TEPEKUM', value: 1500 },
          { row: 'Benzin', column: 'YAĞCILAR', value: 800 },
          { row: 'Benzin', column: 'TEPEKUM', value: 1200 }
        ];
        $('#pivotgrid-fiyat').kendoPivotGrid({
          dataSource: {
            data: pivotData,
            schema: {
              model: {
                fields: {
                  row: { type: 'string' },
                  column: { type: 'string' },
                  value: { type: 'number' }
                }
              }
            },
            columns: [{ name: 'column', expand: true }],
            rows: [{ name: 'row', expand: true }],
            values: [{ name: 'value', aggregate: 'sum' }]
          }
        });
        console.log("✅ PivotGrid başlatıldı");
      } catch(e) { console.error("❌ PivotGrid hatası:", e); }

      // 13. DATETIMEPICKER
      try {
        $('#datetimepicker-fiyat').kendoDateTimePicker({
          value: new Date(),
          format: 'dd.MM.yyyy HH:mm',
          timeFormat: 'HH:mm'
        });
        console.log("✅ DateTimePicker başlatıldı");
      } catch(e) { console.error("❌ DateTimePicker hatası:", e); }

      // 14. TIMEPICKER
      try {
        $('#timepicker-fiyat').kendoTimePicker({
          value: new Date(),
          format: 'HH:mm'
        });
        console.log("✅ TimePicker başlatıldı");
      } catch(e) { console.error("❌ TimePicker hatası:", e); }

      // 15. LISTBOX
      try {
        $('#listbox-fiyat').kendoListBox({
          dataSource: {
            data: ['Şube 1', 'Şube 2', 'Şube 3', 'Şube 4', 'Şube 5']
          },
          selectable: 'multiple',
          draggable: true,
          connectWith: null
        });
        console.log("✅ ListBox başlatıldı");
      } catch(e) { console.error("❌ ListBox hatası:", e); }

      // 16. TREEVIEW
      try {
        $('#treeview-fiyat').kendoTreeView({
          dataSource: [
            {
              text: 'Ana Şube',
              expanded: true,
              items: [
                { text: 'Alt Şube 1' },
                { text: 'Alt Şube 2' },
                {
                  text: 'Alt Şube 3',
                  items: [
                    { text: 'Alt-Alt Şube 1' },
                    { text: 'Alt-Alt Şube 2' }
                  ]
                }
              ]
            },
            {
              text: 'Diğer Şube',
              items: [
                { text: 'Alt Şube A' },
                { text: 'Alt Şube B' }
              ]
            }
          ]
        });
        console.log("✅ TreeView başlatıldı");
      } catch(e) { console.error("❌ TreeView hatası:", e); }

      // 17. TOOLTIP
      try {
        $('#tooltip-button-fiyat').kendoTooltip({
          content: 'Bu buton bir örnek butondur. Üzerine geldiğinizde bu açıklama görünür.',
          position: 'top'
        });
        console.log("✅ Tooltip başlatıldı");
      } catch(e) { console.error("❌ Tooltip hatası:", e); }

      // 18. SPLITTER
      try {
        $('#splitter-fiyat').kendoSplitter({
          panes: [
            { collapsible: true, size: '200px', content: '<div style="padding:10px;">Sol Panel<br/>Buraya içerik eklenebilir</div>' },
            { collapsible: false, content: '<div style="padding:10px;">Sağ Panel<br/>Buraya içerik eklenebilir</div>' }
          ]
        });
        console.log("✅ Splitter başlatıldı");
      } catch(e) { console.error("❌ Splitter hatası:", e); }

      // 19. PANELBAR
      try {
        $('#panelbar-fiyat').kendoPanelBar({
          dataSource: [
            {
              text: 'Panel 1',
              content: 'Panel 1 içeriği buraya gelir. Tıklayınca açılır/kapanır.',
              expanded: true
            },
            {
              text: 'Panel 2',
              content: 'Panel 2 içeriği buraya gelir. Tıklayınca açılır/kapanır.'
            },
            {
              text: 'Panel 3',
              content: 'Panel 3 içeriği buraya gelir. Tıklayınca açılır/kapanır.'
            }
          ]
        });
        console.log("✅ PanelBar başlatıldı");
      } catch(e) { console.error("❌ PanelBar hatası:", e); }

      // 20. MAP
      try {
        $('#map-fiyat').kendoMap({
          center: [41.0082, 28.9784], // İstanbul koordinatları
          zoom: 10,
          layers: [{
            type: 'tile',
            urlTemplate: 'https://#= subdomain #.tile.openstreetmap.org/#= zoom #/#= x #/#= y #.png',
            subdomains: ['a', 'b', 'c'],
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          }],
          markers: [{
            location: [41.0082, 28.9784],
            title: 'Şube 1'
          }, {
            location: [41.0123, 28.9856],
            title: 'Şube 2'
          }]
        });
        console.log("✅ Map başlatıldı");
      } catch(e) { console.error("❌ Map hatası:", e); }

      console.log("✅ Tüm bileşenler başlatıldı!");
    }

    // ProgressBar test fonksiyonu
    function testProgressBar() {
      var progressbar = $('#progressbar-fiyat').data('kendoProgressBar');
      if (progressbar) {
        progressbar.value(0);
        var interval = setInterval(function() {
          var current = progressbar.value();
          if (current >= 100) {
            clearInterval(interval);
            showSuccess('İlerleme tamamlandı!');
          } else {
            progressbar.value(current + 10);
          }
        }, 200);
      }
    }
  </script>
{% endblock %}
