{% load static %}
<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}Yeni Telerik Projesi{% endblock %}</title>
  <link rel="icon" href="data:,">
  <style>
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;height:100%;font-size:11px;overflow-x:hidden !important;overflow-y:auto;width:100%;max-width:100vw}
    /* Operasyon sayfası açıkken boş sayfada kaydırma çubuğunu gizle */
    body.operasyon-sayfasi-acik {
      overflow-y: hidden !important;
    }
    body.operasyon-sayfasi-acik html {
      overflow-y: hidden !important;
    }
    
    /* main-content overflow kontrolü - horizontal scroll olmasın */
    #main-content{overflow-x:hidden !important;overflow-y:auto;width:100% !important;max-width:100vw !important;position:relative;min-height:auto !important;height:auto !important}
    /* Operasyon sayfası açıkken main-content kaydırmasını gizle */
    body.operasyon-sayfasi-acik #main-content {
      overflow-y: hidden !important;
    }
    #main-content > * {max-width:100% !important;overflow-x:hidden !important;width:100% !important}
    
    /* Telerik Grid overflow kontrolü - tüm grid elementlerinde */
    .k-grid, .k-grid-content, .k-grid-header, .k-grid-header-wrap, .k-grid-content-wrap,
    .k-grid table, .k-grid-header table {overflow-x:hidden !important;max-width:100% !important}
    .k-grid-content-locked, .k-grid-header-locked {overflow-x:hidden !important}
    
    /* 3 Sabit Alan - Basit HTML ile */
    #fixed-area-1-container,
    #fixed-area-2-container,
    #fixed-area-3-container {
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    
    /* Tab Container - Basit HTML Tab Sistemi */
    #tabs-container {
      width: 100%;
      margin: 0;
      padding: 0;
      display: flex !important;
      visibility: visible !important;
      overflow-x: auto;
    }
    #tabs-list {
      display: flex !important;
      align-items: center;
      gap: 2px;
      padding: 0;
      margin: 0;
      height: 100%;
      list-style: none;
    }
    /* Flash sorunu çözümü: Tüm sabit alanları ve içeriği sayfa yüklenene kadar gizle */
    #fixed-area-1-container,
    #fixed-area-2-container,
    #tabs-container,
    #main-content {
      opacity: 0;
      transition: opacity 0.05s;
    }
    /* Sayfa yüklendikten sonra göster */
    body.loaded #fixed-area-1-container,
    body.loaded #fixed-area-2-container,
    body.loaded #tabs-container,
    body.loaded #main-content {
      opacity: 1 !important;
    }
    
    /* ALAN 1 - Ana Menü Butonları */
    #fixed-area-1-container {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 0;
    }

    /* ALAN 1 - Ana menü yazı boyutu */
    #ana-menu-bar .k-menu-item-text,
    #ana-menu-bar .k-link,
    #ana-menu-bar li span {
      font-size: 19px !important;
    }

    /* Alt menü yazıları - 16px ve sol hizalı */
    #ana-menu-bar .k-menu-group .k-menu-item-text,
    #ana-menu-bar .k-menu-group .k-link,
    #ana-menu-bar .k-popup .k-menu-item-text,
    #ana-menu-bar .k-popup .k-link {
      font-size: 16px !important;
      text-align: left !important;
      justify-content: flex-start !important;
    }

    /* Alt menü yazı boyutu - en güçlü zorlamalar */
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item,
    #ana-menu-bar .k-menu-group .k-item .k-link,
    #ana-menu-bar .k-popup .k-item .k-link,
    #ana-menu-bar .k-menu-group .k-item .k-menu-item-text,
    #ana-menu-bar .k-popup .k-item .k-menu-item-text,
    #ana-menu-bar .k-menu-group .k-item span,
    #ana-menu-bar .k-popup .k-item span {
      font-size: 16px !important;
    }

    /* Alt menü arka planı - açık gri */
    #ana-menu-bar .k-menu-group,
    #ana-menu-bar .k-popup,
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item {
      background: #f0f0f0 !important;
      background-color: #f0f0f0 !important;
    }

    /* Alt menü yazı hizası - sol baştan */
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item,
    #ana-menu-bar .k-menu-group .k-item .k-link,
    #ana-menu-bar .k-popup .k-item .k-link {
      text-align: left !important;
      justify-content: flex-start !important;
      align-items: center !important;
      padding-left: 12px !important;
    }

    /* Alt menü yumuşak geçiş */
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item,
    #ana-menu-bar .k-menu-group .k-item .k-link,
    #ana-menu-bar .k-popup .k-item .k-link {
      transition: background-color 0.15s ease, border-color 0.15s ease;
    }

    /* Çerçeve sabit dursun, sadece rengi değişsin */
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item {
      box-sizing: border-box !important;
      border: 1px solid transparent !important;
    }

    /* Alt menüde sol hizayı zorla sabitle */
    #ana-menu-bar .k-menu-group,
    #ana-menu-bar .k-popup {
      text-align: left !important;
    }
    #ana-menu-bar .k-menu-group .k-item,
    #ana-menu-bar .k-popup .k-item {
      display: flex !important;
      justify-content: flex-start !important;
      align-items: center !important;
      width: 100% !important;
    }
    #ana-menu-bar .k-menu-group .k-link,
    #ana-menu-bar .k-popup .k-link,
    #ana-menu-bar .k-menu-group .k-menu-link,
    #ana-menu-bar .k-popup .k-menu-link {
      display: flex !important;
      justify-content: flex-start !important;
      align-items: center !important;
      width: 100% !important;
      text-align: left !important;
      padding-left: 12px !important;
      margin-left: 0 !important;
    }
    #ana-menu-bar .k-menu-group .k-menu-item-text,
    #ana-menu-bar .k-popup .k-menu-item-text {
      display: inline-block !important;
      text-align: left !important;
      margin-left: 0 !important;
    }
    
    /* Telerik TabStrip için font boyutu (ALAN 3) */
    #tabs .k-tabstrip-item {
      font-size: 12px !important;
    }
    #tabs .k-tabstrip-item .k-link {
      font-size: 12px !important;
      padding: 4px 12px !important;
    }
    /* Eski CSS'ler temizlendi - Artık Telerik kullanılıyor */
    /* Ribbon buton stili - Resimdeki gibi kompakt */
    .ribbon-button {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 4px 6px;
      min-width: 70px;
      max-width: 70px;
      cursor: pointer;
      border-radius: 2px;
      transition: all 0.15s;
      background: transparent;
      border: 1px solid transparent;
    }
    .ribbon-button:hover {
      background: rgba(255,255,255,0.5);
      border: 1px solid #C0C0C0;
    }
    .ribbon-button.active {
      background: rgba(255,255,255,0.8);
      border: 1px solid #808080;
      box-shadow: inset 0 0 2px rgba(0,0,0,0.1);
    }
  </style>
  
  <!-- Telerik Kendo UI CSS -->
  <link rel="stylesheet" href="{% static 'dashboard/kendo/styles/default-main.css' %}" />
  
  <!-- jQuery (Telerik için gerekli) -->
  <script src="{% static 'dashboard/js/jquery-3.6.0.min.js' %}"></script>
  
  <!-- Telerik Kendo UI JavaScript (Tüm bileşenler) -->
  <script src="{% static 'dashboard/js/kendo.all.min.js' %}"></script>
  
  <!-- Telerik Türkçe Kültür -->
  <script src="{% static 'dashboard/js/cultures/kendo.culture.tr-TR.min.js' %}"></script>
  <script>
    kendo.culture("tr-TR");
  </script>
  
  <!-- Telerik Lisans -->
  <script src="{% static 'dashboard/kendo/telerik-license.js' %}"></script>
  
  {% block extra_head %}{% endblock %}
</head>

<body>
    <!-- 1. SABİT ALAN: ALAN 1 (En Üst) - Ana Menü Butonları -->
  <div id="fixed-area-1-container" style="position:fixed;top:0;left:0;right:0;z-index:10000;background:linear-gradient(to bottom, #f5f5f5, #eeeeee);height:28px;border-bottom:1px solid #e0e0e0;font-family:'Segoe UI',Arial,sans-serif;opacity:0;">
    <!-- Telerik Kendo UI Menu -->
    <ul id="ana-menu-bar" style="margin:0;padding:0;list-style:none;display:flex;height:100%;align-items:center;font-family:'Segoe UI',Arial,sans-serif !important;">
      <li>
        <span>Tanımlar</span>
        <ul>
          <li><span>Firma Tanımları</span></li>
          <li><span>Ürün Tanımları</span></li>
          <li><span>E Posta Tanımları</span></li>
          <li><span>Whatsapp Tanımları</span></li>
          <li><span>Sistem Tanımları</span></li>
          <li><span>Kullanıcı Tanımları</span></li>
          <li><span>Çıkış</span></li>
        </ul>
      </li>
      <li>
        <span>Kartlar</span>
        <ul>
          <li><span>Cari Kartlar</span></li>
        </ul>
      </li>
      <li>
        <span>Operasyon</span>
        <ul></ul>
      </li>
      <li>
        <span>Raporlar</span>
        <ul></ul>
      </li>
    </ul>
  </div>
  
  <!-- 2. SABİT ALAN: ALAN 2 (İkonlu Butonlar) - Açık Gri -->
  <div id="fixed-area-2-container" style="position:fixed;top:28px;left:0;right:0;z-index:9999;background:linear-gradient(to bottom, #f5f5f5, #eeeeee);height:80px;display:flex;align-items:center;justify-content:flex-start;padding:8px 6px;gap:4px;font-family:'Segoe UI',Arial,sans-serif;border-bottom:1px solid #e0e0e0;opacity:0;">
    <!-- İkonlu Butonlar (ALAN 2'nin içinde) -->
    <div id="main-ribbon-container" style="display:flex;align-items:center;gap:4px;overflow-x:auto;flex:1;justify-content:flex-start;">
      <div id="ribbon-buttons" style="display:flex;gap:4px;align-items:center;flex-wrap:nowrap"></div>
    </div>
    <!-- ALAN 2 Etiketi (Proje anlatımı için) -->
    <span style="position:absolute;left:50%;transform:translateX(-50%);color:#FF0000;font-size:12pt;font-weight:bold;pointer-events:none;z-index:1;white-space:nowrap;">
      ALAN 2 
      <span style="color:#FF0000;font-size:10pt;margin-left:10px;">↕ 80px</span>
      <span style="color:#FF0000;font-size:10pt;margin-left:10px;">↔ 100%</span>
    </span>
  </div>
  
  <!-- 3. Tab Container - Telerik TabStrip - Açık Gri (ALAN 2 ile aynı) -->
  <div id="tabs-container" style="position:fixed;top:108px;left:0;right:0;z-index:9998;height:26px;background:#f5f5f5;border-bottom:1px solid #e0e0e0;padding:0;opacity:0;">
    <div id="tabs"></div>
    <!-- ALAN 3 Etiketi (Proje anlatımı için) -->
    <span style="position:absolute;left:50%;transform:translateX(-50%);color:#FF0000;font-size:12pt;font-weight:bold;pointer-events:none;z-index:1;white-space:nowrap;">
      ALAN 3 
      <span style="color:#FF0000;font-size:10pt;margin-left:10px;">↕ 26px</span>
      <span style="color:#FF0000;font-size:10pt;margin-left:10px;">↔ 100%</span>
    </span>
  </div>
  
  <!-- TANIMLAR ALT MENÜ -->
  <div id="tanimlar-menu" style="position:fixed;top:28px;left:0;background:#FFFFFF;border:1px solid #E0E0E0;box-shadow:0 2px 4px rgba(0,0,0,0.1);z-index:10001;display:none;min-width:200px;">
    <div id="tanimlar-firmalar" style="padding:5px 15px;cursor:pointer;border-bottom:1px solid #F0F0F0;">Firmalar</div>
    <div id="tanimlar-urunler" style="padding:5px 15px;cursor:pointer;">Ürünler</div>
  </div>
  
  <!-- FIRMA TANIMLARI WINDOW -->
  <div id="firma-tanimlari-window" style="display:none;">
    <div style="padding:12px;">
      <label for="firma-adi-input" style="display:block;margin-bottom:6px;font-weight:600;">Firma İsmi</label>
      <input id="firma-adi-input" style="width:100%;" />
    </div>
  </div>
  
  <!-- ÜRÜN TANIMLARI WINDOW -->
  <div id="urun-tanimlari-window" style="display:none;">
    <div style="padding:12px;">
      <label for="urun-adi-input" style="display:block;margin-bottom:6px;font-weight:600;">Ürün İsmi</label>
      <input id="urun-adi-input" style="width:100%;" />
    </div>
  </div>

  <!-- SİSTEM TANIMLARI WINDOW -->
  <div id="sistem-tanimlari-window" style="display:none;">
    <div style="padding:12px;">
      <label for="sistem-adi-input" style="display:block;margin-bottom:6px;font-weight:600;">Sistem Adı</label>
      <input id="sistem-adi-input" style="width:100%;" />
    </div>
  </div>

  <!-- KULLANICI TANIMLARI WINDOW + SPLITTER -->
  <div id="kullanici-tanimlari-window" style="display:none;">
    <div id="kullanici-splitter" style="height:100%;">
      <div style="padding:10px;">
        <h3 style="margin:0 0 8px 0;">Kullanıcı Listesi</h3>
        <div>Ahmet Yılmaz</div>
        <div>Ayşe Demir</div>
        <div>Mehmet Kaya</div>
      </div>
      <div style="padding:10px;">
        <h3 style="margin:0 0 8px 0;">Kullanıcı Detayı</h3>
        <div>Ad Soyad: Ahmet Yılmaz</div>
        <div>Rol: Yönetici</div>
        <div>Durum: Aktif</div>
      </div>
    </div>
  </div>

  <!-- E POSTA TANIMLARI DIALOG -->
  <div id="eposta-dialog" style="display:none;">
    <div style="padding:12px;">
      <label for="eposta-adres-input" style="display:block;margin-bottom:6px;font-weight:600;">E-Posta</label>
      <input id="eposta-adres-input" style="width:100%;" />
    </div>
  </div>
  
  <!-- FIRMA YÖNETİMİ WINDOW -->
  <div id="firma-window" style="display:none;">
    <div id="firma-grid-container" style="padding:10px;height:100%;">
      <div id="firma-grid" style="height:300px;"></div>
    </div>
  </div>
  
  <!-- ÜRÜN YÖNETİMİ WINDOW -->
  <div id="urun-window" style="display:none;">
    <div id="urun-grid-container" style="padding:10px;height:100%;">
      <div id="urun-grid" style="height:300px;"></div>
    </div>
  </div>
  
  <!-- İÇERİK ALANI -->
  <div id="main-content" style="margin-top:134px;padding-top:0;opacity:0;">
    {% block content %}{% endblock %}
  </div>
  
  <!-- TELERİK NOTIFICATION BİLEŞENİ -->
  <div id="notification"></div>
  
  <script>
    // Menü öğelerini veritabanından yükle
    var menuItems = {{ menu_items|safe }};

    // Tanımlar menüsü - geçiş için örnek veri (Petronet mantığına hazırlık)
    // Şimdilik mevcut Tanımlar alt başlıklarıyla aynı içerik verildi.
    var tanimlarMenuData = [
      { text: "Firma Tanımları", key: "firma_tanimlari" },
      { text: "Ürün Tanımları", key: "urun_tanimlari" },
      { text: "E Posta Tanımları", key: "eposta_tanimlari" },
      { text: "Whatsapp Tanımları", key: "whatsapp_tanimlari" },
      { text: "Sistem Tanımları", key: "sistem_tanimlari" },
      { text: "Kullanıcı Tanımları", key: "kullanici_tanimlari" },
      { text: "Çıkış", key: "cikis" }
    ];

    // Bu bayrak true olduğunda Tanımlar alt menüsü veriden doldurulur.
    // Şu an içerik aynı olduğu için ekranda fark yoktur.
    var useTanimlarMenuData = true;

    function renderTanimlarMenuFromData() {
      if (!useTanimlarMenuData || !Array.isArray(tanimlarMenuData) || tanimlarMenuData.length === 0) {
        return;
      }

      var tanimlarMenu = $("#ana-menu-bar > li").filter(function() {
        return $(this).children("span").first().text().trim() === "Tanımlar";
      }).first();

      if (!tanimlarMenu.length) {
        return;
      }

      var subList = tanimlarMenu.children("ul");
      if (!subList.length) {
        subList = $("<ul></ul>").appendTo(tanimlarMenu);
      }

      subList.empty();
      tanimlarMenuData.forEach(function(item) {
        var li = $("<li></li>");
        if (item.key) {
          li.attr("data-menu-key", item.key);
        }
        li.append($("<span></span>").text(item.text));
        subList.append(li);
      });
    }
    
    // Tab yönetimi - Sadece Operasyon sayfası için test
    var tabStrip = null;
    var ignoreSelectEvent = false; // Tab kapatılırken select event'ini ignore et
    var activeTabIdToKeep = null; // Pasif tab kapatıldığında aktif tab ID'sini korumak için
    
    // Ribbon butonlarını başlat
    // TELERİK NOTIFICATION BİLEŞENİ - Tüm sayfalarda kullanılabilir
    var notification = null;
    
    // Bildirim gösterme fonksiyonları
    function showSuccess(message) {
      if (notification) {
        notification.show(message, "success");
      } else {
        // Fallback: Notification henüz hazır değilse alert kullan
        setTimeout(function() {
          if (notification) {
            notification.show(message, "success");
          } else {
            alert(message);
          }
        }, 100);
      }
    }
    
    function showError(message) {
      if (notification) {
        // Hata mesajları için daha uzun süre göster (5 saniye)
        var errorNotification = notification.show(message, "error");
        setTimeout(function() {
          if (errorNotification && notification) {
            notification.hide(errorNotification);
          }
        }, 5000);
      } else {
        // Fallback: Notification henüz hazır değilse alert kullan
        setTimeout(function() {
          if (notification) {
            var errorNotification = notification.show(message, "error");
            setTimeout(function() {
              if (errorNotification && notification) {
                notification.hide(errorNotification);
              }
            }, 5000);
          } else {
            alert(message);
          }
        }, 100);
      }
    }
    
    function showInfo(message) {
      if (notification) {
        notification.show(message, "info");
      } else {
        // Fallback: Notification henüz hazır değilse alert kullan
        setTimeout(function() {
          if (notification) {
            notification.show(message, "info");
          } else {
            alert(message);
          }
        }, 100);
      }
    }
    
    function showWarning(message) {
      if (notification) {
        // Uyarı mesajları için orta süre göster (4 saniye)
        var warningNotification = notification.show(message, "warning");
        setTimeout(function() {
          if (warningNotification && notification) {
            notification.hide(warningNotification);
          }
        }, 4000);
      } else {
        // Fallback: Notification henüz hazır değilse alert kullan
        setTimeout(function() {
          if (notification) {
            var warningNotification = notification.show(message, "warning");
            setTimeout(function() {
              if (warningNotification && notification) {
                notification.hide(warningNotification);
              }
            }, 4000);
          } else {
            alert(message);
          }
        }, 100);
      }
    }
    
    $(document).ready(function() {
      // Flash sorunu çözümü: Sayfa yüklendiğinde body'ye 'loaded' class'ı ekle
      $('body').addClass('loaded');

      // Tanımlar menüsünü veriden doldur (geçiş hazırlığı)
      renderTanimlarMenuFromData();

      // TELERİK NOTIFICATION BAŞLAT
      if (typeof kendo !== 'undefined' && typeof $.fn.kendoNotification !== 'undefined') {
        try {
          notification = $("#notification").kendoNotification({
            position: { top: 50, right: 50 },
            stacking: "down",
            hideAfter: 3000  // Varsayılan 3 saniye
          }).data("kendoNotification");
          
          // TEST İÇİN: Konsoldan test edebilmek için global fonksiyonlar
          // Tarayıcı konsolunda (F12) şunları yazabilirsiniz:
          // showSuccess("Test başarı mesajı")
          // showError("Test hata mesajı")
          // showWarning("Test uyarı mesajı")
          // showInfo("Test bilgi mesajı")
        } catch(error) {
          console.error("Notification başlatılırken hata:", error);
        }
      }

      // ALAN 1 - Ana Menü Butonları (Telerik Kendo UI Menu)
      var anaMenu = null;
      var enablePetronetMenuStyles = false;
      var allowHoverOpen = false;
      function applyAltMenuFontSize() {
        $("#ana-menu-bar .k-menu-group .k-item, #ana-menu-bar .k-popup .k-item").each(function() {
          this.style.setProperty('font-size', '16px', 'important');
        });
        $("#ana-menu-bar .k-menu-group .k-link, #ana-menu-bar .k-popup .k-link").each(function() {
          this.style.setProperty('font-size', '16px', 'important');
        });
        $("#ana-menu-bar .k-menu-group .k-menu-item-text, #ana-menu-bar .k-popup .k-menu-item-text").each(function() {
          this.style.setProperty('font-size', '16px', 'important');
        });
        $("#ana-menu-bar .k-menu-group span, #ana-menu-bar .k-popup span").each(function() {
          this.style.setProperty('font-size', '16px', 'important');
        });
      }
      function initAnaMenu() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoMenu !== 'undefined') {
          try {
            anaMenu = $("#ana-menu-bar").kendoMenu({
              orientation: "horizontal",
              openOnClick: true,
              highlightFirst: false, // COPILOT ÇÖZÜMÜ - Varsayılan hover'ları engelle
              animation: {
                open: {
                  effects: "fadeIn",
                  duration: 150
                },
                close: {
                  effects: "fadeOut",
                  duration: 100
                }
              },
              open: function(e) {
                applyAltMenuFontSize();
                if (!enablePetronetMenuStyles) {
                  return;
                }
                // Menü açıldığında tıklanan butonu koyu mavi yap (#64B5F6)
                var $item = $(e.item);
                $item.addClass('menu-acik');
                $item.css({
                  'background': '#64B5F6 !important',
                  'background-color': '#64B5F6 !important'
                });
                // Diğer tüm ana menü butonlarını açık mavi yap
                $("#ana-menu-bar > li").not($item).css({
                  'background': '#E3F2FD !important',
                  'background-color': '#E3F2FD !important'
                });
                // Alt menü stillerini uygula - daha uzun bekleme
                setTimeout(function() {
                  if (typeof applyPetronetStyles === 'function' && !isApplyingStyles) {
                    applyPetronetStyles();
                  }
                  // Ekstra kontrol - alt menü .k-link'leri zorla düzelt
                  setTimeout(function() {
                    $("#ana-menu-bar .k-menu-group .k-link, #ana-menu-bar .k-popup .k-link").each(function() {
                      this.style.setProperty('font-size', '15px', 'important');
                      this.style.setProperty('font-weight', 'normal', 'important');
                      this.style.setProperty('color', '#333333', 'important');
                      // Varsayılan arka planı transparent yap
                      this.style.setProperty('background', 'transparent', 'important');
                      this.style.setProperty('background-color', 'transparent', 'important');
                    });
                  }, 100);
                  // Telerik kontrolü yap
                  setTimeout(checkTelerikMenuStyles, 300);
                }, 300);
              },
              close: function(e) {
                if (!enablePetronetMenuStyles) {
                  return;
                }
                // Menü kapandığında tüm butonları açık mavi yap
                var $item = $(e.item);
                $item.removeClass('menu-acik');
                $item.css({
                  'background': '#E3F2FD',
                  'background-color': '#E3F2FD'
                });
                // Tüm ana menü butonlarını açık mavi yap
                $("#ana-menu-bar > li").css({
                  'background': '#E3F2FD',
                  'background-color': '#E3F2FD'
                });
                // Stilleri tekrar uygula (sadece bir kez)
                setTimeout(function() {
                  if (typeof applyPetronetStyles === 'function' && !isApplyingStyles) {
                    applyPetronetStyles();
                  }
                }, 150);
                console.log("Menü kapandı:", $item.text());
              },
              select: function(e) {
                var menuText = $(e.item).text().trim();
                console.log("Ana menü tıklandı:", menuText);
                // Alt menü öğelerine tıklama işlemleri
                if (menuText === "Firma Tanımları") {
                  openFirmaTanimlariWindow();
                } else if (menuText === "Ürün Tanımları") {
                  openUrunTanimlariWindow();
                } else if (menuText === "Sistem Tanımları") {
                  openSistemTanimlariWindow();
                } else if (menuText === "Kullanıcı Tanımları") {
                  openKullaniciTanimlariWindow();
                } else if (menuText === "E Posta Tanımları") {
                  openEpostaDialog();
                } else if (menuText === "Cari Kartlar" || menuText === "Cari Kart") {
                  openCariKartTab();
                }
              }
            }).data("kendoMenu");
            console.log("✅ Ana menü başarıyla oluşturuldu!");
            setTimeout(applyAltMenuFontSize, 50);

            // Hover ile açma sadece tıklamadan sonra aktif olsun
            $("#ana-menu-bar").on("click", "li.k-item", function(e) {
              if ($(this).closest(".k-menu-group, .k-popup").length > 0) {
                return;
              }
              allowHoverOpen = true;
            });

            $("#ana-menu-bar").on("mouseenter", "li.k-item", function() {
              if (!allowHoverOpen || !anaMenu) {
                return;
              }
              if ($(this).closest(".k-menu-group, .k-popup").length > 0) {
                return;
              }
              var $item = $(this);
              $item.siblings("li.k-item").each(function() {
                anaMenu.close($(this));
              });
              anaMenu.open($item);
            });

            // ALAN 1 dışına tıklanınca hover açma kapansın
            $(document).on("click", function(e) {
              if ($(e.target).closest("#fixed-area-1-container").length === 0) {
                allowHoverOpen = false;
                if (anaMenu) {
                  $("#ana-menu-bar > li.k-item").each(function() {
                    anaMenu.close($(this));
                  });
                }
              }
            });
            
            // Menü oluşturulduktan sonra Petronet görüntüsüne göre tüm stilleri uygula
            var isApplyingStyles = false; // Sonsuz döngü önleme
            var lastApplyTime = 0; // Throttle için
            
            function applyPetronetStyles() {
              if (!enablePetronetMenuStyles) {
                return;
              }
              // Throttle: 300ms içinde tekrar çağrılırsa çık
              var now = Date.now();
              if (now - lastApplyTime < 300) return;
              lastApplyTime = now;
              
              if (isApplyingStyles) return; // Zaten uygulanıyorsa çık
              isApplyingStyles = true;
              
              try {
                // Ana menü container arka planı
                $("#fixed-area-1-container").css({
                  'background': '#E3F2FD',
                  'background-color': '#E3F2FD',
                  'background-image': 'none'
                });
                
                // Ana menü butonları
                $("#ana-menu-bar > li, #ana-menu-bar .k-menu-item, #ana-menu-bar li").each(function() {
                  var $item = $(this);
                  $item.css({
                    'background': '#E3F2FD',
                    'background-color': '#E3F2FD',
                    'padding': '0 12px',
                    'margin': '0',
                    'height': '28px',
                    'line-height': '28px',
                    'font-family': "'Segoe UI', Arial, sans-serif",
                    'border-right': '1px solid #90caf9'
                  });
                  // Ana menü yazı - Telerik .k-link'i zorla override et
                  $item.find('.k-menu-item-text, .k-link, span').css({
                    'font-size': '16px',
                    'font-weight': '600',
                    'font-family': "'Segoe UI', Arial, sans-serif",
                    'color': '#333333',
                    'letter-spacing': '0.3px',
                    'line-height': '28px'
                  });
                  
                  // .k-link'i özellikle hedefle ve zorla uygula
                  var kLink = $item.find('.k-link').first();
                  if (kLink.length > 0) {
                    kLink[0].style.setProperty('font-size', '16px', 'important');
                    kLink[0].style.setProperty('font-weight', '600', 'important');
                    kLink[0].style.setProperty('color', '#333333', 'important');
                    kLink[0].style.setProperty('font-family', "'Segoe UI', Arial, sans-serif", 'important');
                  }
                });
                
                // Alt menü container
                $("#ana-menu-bar .k-menu-group, #ana-menu-bar .k-popup").css({
                  'background': '#D9D9FF',
                  'background-color': '#D9D9FF',
                  'padding': '0'
                });
                
                // Alt menü öğeleri - ayırıcı çizgi YOK, sol tarafta mavi çizgi VAR
                $("#ana-menu-bar .k-menu-group .k-menu-item, #ana-menu-bar .k-popup .k-menu-item, #ana-menu-bar .k-menu-group .k-item").each(function() {
                  var item = this; // DOM elementi
                  var $item = $(this);
                  
                  // Alt menü öğesi padding'i zorla uygula - DOM elementine direkt - DİKEY ORTALANMIŞ
                  item.style.setProperty('padding', '0 20px 0 25px', 'important'); /* Üst ve alt padding 0, sol padding 25px - YAZILAR DAHA SOLDAN BAŞLAR */
                  item.style.setProperty('padding-left', '25px', 'important'); /* Sol padding 25px (20px mavi çizgi + 5px boşluk) */
                  item.style.setProperty('margin', '0', 'important');
                  item.style.setProperty('min-height', '28px', 'important');
                  item.style.setProperty('line-height', '28px', 'important'); /* min-height ile aynı - dikey ortalama için */
                  item.style.setProperty('font-family', "'Segoe UI', Arial, sans-serif", 'important');
                  item.style.setProperty('background', '#D9D9FF', 'important');
                  item.style.setProperty('background-color', '#D9D9FF', 'important');
                  item.style.setProperty('border-bottom', 'none', 'important');
                  item.style.setProperty('border-top', 'none', 'important');
                  item.style.setProperty('position', 'relative', 'important');
                  item.style.setProperty('font-size', '15px', 'important'); // li elementinin font boyutu
                  item.style.setProperty('display', 'flex', 'important'); /* Flexbox ile dikey ortalama */
                  item.style.setProperty('align-items', 'center', 'important'); /* Dikey ortalama */
                  item.style.setProperty('justify-content', 'flex-start', 'important'); /* Sol baştan hizalama */
                  
                  // COPILOT ÇÖZÜMÜ - Runtime inline stillerini kaldır (SADECE background stilleri)
                  $item.off('mouseenter mouseleave').on('mouseenter', function() {
                    var item = this;
                    
                    // SADECE background ile ilgili inline stilleri temizle (padding/margin korunmalı)
                    var currentStyle = item.getAttribute('style') || '';
                    var styleParts = currentStyle.split(';');
                    var newStyleParts = [];
                    for (var i = 0; i < styleParts.length; i++) {
                      var part = styleParts[i].trim();
                      if (part && 
                          !part.toLowerCase().includes('background') && 
                          !part.toLowerCase().includes('box-shadow') &&
                          !part.toLowerCase().includes('border-color')) {
                        newStyleParts.push(part);
                      }
                    }
                    item.setAttribute('style', newStyleParts.join('; '));
                    
                    // Düz sarı-turuncu arka plan uygula
                    item.style.setProperty('background', '#F3E9C9', 'important');
                    item.style.setProperty('background-color', '#F3E9C9', 'important');
                    item.style.setProperty('border-color', '#E5C76B', 'important');
                    item.style.setProperty('background-image', 'none', 'important');
                    item.style.setProperty('box-shadow', 'none', 'important');
                    item.style.setProperty('border', 'none', 'important');
                    
                    // TÜM çocuk elementlerin SADECE background stillerini temizle (padding/margin korunmalı)
                    $(item).find('*').each(function() {
                      // SADECE background stillerini temizle
                      this.style.background = 'transparent';
                      this.style.backgroundColor = 'transparent';
                      this.style.backgroundImage = 'none';
                      this.style.boxShadow = 'none';
                      // padding, margin, position, left, top, width, height gibi değerleri KORU
                    });
                  }).on('mouseleave', function() {
                    var item = this;
                    if (!item.classList.contains('k-state-selected') && 
                        !item.classList.contains('k-state-active')) {
                      // Varsayılan arka plana dön
                      item.style.setProperty('background', '#D9D9FF', 'important');
                      item.style.setProperty('background-color', '#D9D9FF', 'important');
                      item.style.setProperty('border-color', 'transparent', 'important');
                      item.style.setProperty('background-image', 'none', 'important');
                      
                      // Çocuk elementleri transparent yap
                      $(item).find('*').each(function() {
                        this.style.background = 'transparent';
                        this.style.backgroundColor = 'transparent';
                        this.style.backgroundImage = 'none';
                      });
                    }
                  });
                  
                  // Hover durumunu temizle (varsayılan arka planı zorla uygula)
                  if (!item.classList.contains('k-state-hover') && 
                      !item.classList.contains('k-state-selected') && 
                      !item.classList.contains('k-state-active')) {
                    item.style.setProperty('background', '#D9D9FF', 'important');
                    item.style.setProperty('background-color', '#D9D9FF', 'important');
                  }
                  
                  // JavaScript ile eklenen span'leri kaldır (CSS ::before kullanıyoruz)
                  $item.find('span[style*="position:absolute"][style*="left:0"]').remove();
                  
                  // TÜM .k-link elementlerini bul ve zorla uygula - İLK HARFLER ALT ALTA BAŞLAMALI
                  // DİKEY ORTALAMA İÇİN line-height ve display: flex ekle, SOL BAŞTAN HİZALAMA
                  var kLinks = item.querySelectorAll('.k-link');
                  kLinks.forEach(function(kLink) {
                    kLink.style.setProperty('font-size', '15px', 'important');
                    kLink.style.setProperty('font-weight', 'normal', 'important');
                    kLink.style.setProperty('color', '#333333', 'important');
                    kLink.style.setProperty('font-family', "'Segoe UI', Arial, sans-serif", 'important');
                    kLink.style.setProperty('letter-spacing', '0.2px', 'important');
                    kLink.style.setProperty('line-height', '28px', 'important'); /* min-height ile aynı - dikey ortalama için */
                    kLink.style.setProperty('text-align', 'left', 'important'); /* Sol baştan hizalama */
                    // FLEXBOX İLE DİKEY ORTALAMA VE SOL HİZALAMA
                    kLink.style.setProperty('display', 'flex', 'important'); /* Flexbox yapısı */
                    kLink.style.setProperty('align-items', 'center', 'important'); /* Dikey ortalama */
                    kLink.style.setProperty('justify-content', 'flex-start', 'important'); /* Sol baştan hizalama */
                    kLink.style.setProperty('text-align', 'left', 'important'); /* Metin sol hizalama */
                    // İLK HARFLER ALT ALTA BAŞLAMALI - padding ve margin 0
                    kLink.style.setProperty('padding-left', '0', 'important');
                    kLink.style.setProperty('padding-right', '0', 'important');
                    kLink.style.setProperty('padding-top', '0', 'important');
                    kLink.style.setProperty('padding-bottom', '0', 'important');
                    kLink.style.setProperty('margin-left', '0', 'important');
                    kLink.style.setProperty('margin-right', '0', 'important');
                    kLink.style.setProperty('margin-top', '0', 'important');
                    kLink.style.setProperty('margin-bottom', '0', 'important');
                    // Varsayılan arka planı transparent yap (merdiven görünümünü önlemek için)
                    kLink.style.setProperty('background', 'transparent', 'important');
                    kLink.style.setProperty('background-color', 'transparent', 'important');
                    kLink.style.setProperty('background-image', 'none', 'important');
                    
                    // .k-link içindeki TÜM elementlerin padding ve margin'i 0 olmalı
                    var linkChildren = kLink.querySelectorAll('*');
                    linkChildren.forEach(function(child) {
                      child.style.setProperty('padding-left', '0', 'important');
                      child.style.setProperty('padding-right', '0', 'important');
                      child.style.setProperty('margin-left', '0', 'important');
                      child.style.setProperty('margin-right', '0', 'important');
                    });
                  });
                  
                  // .k-menu-item-text için - GRID YAPISI İLE SOL HİZALAMA
                  var menuItemTexts = item.querySelectorAll('.k-menu-item-text');
                  menuItemTexts.forEach(function(text) {
                    text.style.setProperty('padding-left', '0', 'important');
                    text.style.setProperty('padding-right', '0', 'important');
                    text.style.setProperty('margin-left', '0', 'important');
                    text.style.setProperty('margin-right', '0', 'important');
                    text.style.setProperty('text-align', 'left', 'important'); /* Sol baştan hizalama */
                    text.style.setProperty('justify-self', 'start', 'important'); /* Grid içinde sol hizalama */
                    text.style.setProperty('display', 'block', 'important'); /* Block element */
                    text.style.setProperty('width', 'auto', 'important'); /* Otomatik genişlik */
                  });
                  
                  // .k-link içindeki span'ler için de sol hizalama (FLEXBOX UYUMLU)
                  var linkSpans = item.querySelectorAll('.k-link span');
                  linkSpans.forEach(function(span) {
                    span.style.setProperty('text-align', 'left', 'important'); /* Sol baştan hizalama */
                    span.style.setProperty('flex', '0 0 auto', 'important'); /* Flexbox içinde otomatik boyut */
                    span.style.setProperty('align-self', 'flex-start', 'important'); /* Sol baştan hizalama */
                    /* display: block kaldırıldı - flexbox ile uyumlu olmalı */
                  });
                  
                  // Diğer yazı elementleri - SOL BAŞTAN HİZALAMA (FLEXBOX UYUMLU)
                  var spans = item.querySelectorAll('span:not([style*="position"])');
                  spans.forEach(function(span) {
                    if (!span.classList.contains('k-link')) {
                      span.style.setProperty('font-size', '15px', 'important');
                      span.style.setProperty('color', '#333333', 'important');
                      span.style.setProperty('text-align', 'left', 'important'); /* Sol baştan hizalama */
                      /* display: block kaldırıldı - flexbox ile uyumlu olmalı */
                    }
                  });
                });
              } catch(e) {
                console.error("Stil uygulama hatası:", e);
              } finally {
                isApplyingStyles = false;
              }
            }
            
            // İlk uygulama - sadece birkaç kez
            setTimeout(applyPetronetStyles, 300);
            setTimeout(applyPetronetStyles, 800);
            
            // AGRESIF ÇÖZÜM - Telerik'in inline style'larını tamamen temizle ve zorla uygula
            function forceLeftAlignment() {
              // Parent li için - Telerik'in inline style'larını temizle ve zorla uygula
              $('#ana-menu-bar .k-menu-group li.k-item, #ana-menu-bar .k-popup li.k-item').each(function() {
                // Telerik'in inline style'larını tamamen temizle
                this.removeAttribute('style');
                // Zorla flexbox ayarları uygula
                this.style.setProperty('display', 'flex', 'important');
                this.style.setProperty('align-items', 'center', 'important');
                this.style.setProperty('justify-content', 'flex-start', 'important');
                this.style.setProperty('text-align', 'left', 'important');
              });
              
              // .k-link için - Telerik'in inline style'larını temizle ve zorla uygula
              $('#ana-menu-bar .k-menu-group .k-menu-item .k-link, #ana-menu-bar .k-popup .k-menu-item .k-link').each(function() {
                // Telerik'in inline style'larını tamamen temizle
                this.removeAttribute('style');
                // Zorla flexbox ayarları uygula
                this.style.setProperty('display', 'flex', 'important');
                this.style.setProperty('align-items', 'center', 'important');
                this.style.setProperty('justify-content', 'flex-start', 'important');
                this.style.setProperty('text-align', 'left', 'important');
                this.style.setProperty('padding-left', '0', 'important');
                this.style.setProperty('margin-left', '0', 'important');
              });
              
              // .k-menu-item-text için - Telerik'in inline style'larını temizle ve zorla uygula
              $('#ana-menu-bar .k-menu-group .k-menu-item .k-menu-item-text, #ana-menu-bar .k-popup .k-menu-item .k-menu-item-text').each(function() {
                // Telerik'in inline style'larını tamamen temizle
                this.removeAttribute('style');
                // Zorla sol hizalama uygula
                this.style.setProperty('text-align', 'left', 'important');
                this.style.setProperty('margin-left', '0', 'important');
                this.style.setProperty('padding-left', '0', 'important');
                this.style.setProperty('display', 'block', 'important');
                this.style.setProperty('width', 'auto', 'important');
              });
            }
            
            // İlk uygulama
            setTimeout(forceLeftAlignment, 500);
            setTimeout(forceLeftAlignment, 1000);
            setTimeout(forceLeftAlignment, 1500);
            
            // Menü açıldığında da uygula
            if (anaMenu) {
              anaMenu.bind('open', function() {
                setTimeout(forceLeftAlignment, 50);
                setTimeout(forceLeftAlignment, 200);
                setTimeout(forceLeftAlignment, 500);
              });
            }
            
            // Sürekli kontrol et (Telerik'in runtime değişikliklerini yakala)
            setInterval(function() {
              $('#ana-menu-bar .k-menu-group li.k-item').each(function() {
                var justifyContent = window.getComputedStyle(this).justifyContent;
                if (justifyContent !== 'flex-start') {
                  this.style.setProperty('justify-content', 'flex-start', 'important');
                }
              });
              
              $('#ana-menu-bar .k-menu-group .k-menu-item .k-link').each(function() {
                var justifyContent = window.getComputedStyle(this).justifyContent;
                var textAlign = window.getComputedStyle(this).textAlign;
                if (justifyContent !== 'flex-start') {
                  this.style.setProperty('justify-content', 'flex-start', 'important');
                }
                if (textAlign !== 'left') {
                  this.style.setProperty('text-align', 'left', 'important');
                }
              });
              
              $('#ana-menu-bar .k-menu-group .k-menu-item .k-menu-item-text').each(function() {
                var textAlign = window.getComputedStyle(this).textAlign;
                if (textAlign !== 'left') {
                  this.style.setProperty('text-align', 'left', 'important');
                }
              });
            }, 100); // Her 100ms'de bir kontrol et
            
            // Hover rengi sadece üstündeyken kalsın, çıkınca sıfırla
            $("#ana-menu-bar").on("mouseenter", "li.k-item", function() {
              var $item = $(this);
              
              // SADECE background ile ilgili inline stilleri temizle (padding/margin korunmalı)
              var currentStyle = this.getAttribute('style') || '';
              var styleParts = currentStyle.split(';');
              var newStyleParts = [];
              for (var i = 0; i < styleParts.length; i++) {
                var part = styleParts[i].trim();
                if (part && 
                    !part.toLowerCase().includes('background') && 
                    !part.toLowerCase().includes('box-shadow') &&
                    !part.toLowerCase().includes('border-color')) {
                  newStyleParts.push(part);
                }
              }
              this.setAttribute('style', newStyleParts.join('; '));
              
              // Hover rengi uygula
              this.style.setProperty('background', '#F3E9C9', 'important');
              this.style.setProperty('background-color', '#F3E9C9', 'important');
              this.style.setProperty('border-color', '#E5C76B', 'important');
              this.style.setProperty('background-image', 'none', 'important');
              this.style.setProperty('box-shadow', 'none', 'important');
              
              // Çocuk elementlerin arka planını temizle
              $item.find("*").each(function() {
                this.style.background = "transparent";
                this.style.backgroundColor = "transparent";
                this.style.backgroundImage = "none";
                this.style.boxShadow = "none";
              });
            }).on("mouseleave", "li.k-item", function() {
              var $item = $(this);
              // Hover bittiğinde inline arka planı temizle
              this.style.removeProperty('background');
              this.style.removeProperty('background-color');
              this.style.removeProperty('background-image');
              this.style.removeProperty('box-shadow');
              this.style.setProperty('border-color', 'transparent', 'important');
              
              // Çocuk elementlerin inline arka planını temizle
              $item.find("*").each(function() {
                this.style.removeProperty('background');
                this.style.removeProperty('background-color');
                this.style.removeProperty('background-image');
                this.style.removeProperty('box-shadow');
              });
            });
            
            // TELERIK KARŞILAŞTIRMA KONTROLÜ - Fonksiyon olarak tanımla
            function checkTelerikMenuStyles() {
              console.log("\n\n========================================");
              console.log("=== TELERIK MENU KARŞILAŞTIRMA KONTROLÜ ===");
              console.log("========================================\n");
              
              // Ana menü container kontrolü
              var menuBar = document.getElementById('ana-menu-bar');
              if (!menuBar) {
                console.log("❌ #ana-menu-bar bulunamadı!");
                return;
              }
              console.log("✅ #ana-menu-bar bulundu");
              
              // Ana menü öğelerini kontrol et - TÜM YOLLARLA
              var anaMenuItems1 = $("#ana-menu-bar > li");
              var anaMenuItems2 = $("#ana-menu-bar .k-item");
              var anaMenuItems3 = $("#ana-menu-bar .k-menu-item");
              var anaMenuItems4 = $("#ana-menu-bar li");
              
              console.log("\n--- ANA MENÜ KONTROLÜ ---");
              console.log("  - #ana-menu-bar > li sayısı:", anaMenuItems1.length);
              console.log("  - .k-item sayısı:", anaMenuItems2.length);
              console.log("  - .k-menu-item sayısı:", anaMenuItems3.length);
              console.log("  - li sayısı:", anaMenuItems4.length);
              
              var anaMenuItems = anaMenuItems1.length > 0 ? anaMenuItems1 : anaMenuItems4;
              console.log("\n✅ Kullanılan selector ile bulunan öğe sayısı:", anaMenuItems.length);
              
              if (anaMenuItems.length > 0) {
                anaMenuItems.each(function(index) {
                  var $item = $(this);
                  var itemText = $item.text().trim().replace(/\s+/g, ' ').substring(0, 50);
                  var hasKItem = $item.hasClass('k-item');
                  var hasKMenuItem = $item.hasClass('k-menu-item');
                  var kLink = $item.find('.k-link').first();
                  var kLinkText = kLink.length > 0 ? kLink.text().trim() : '';
                  var computedBg = window.getComputedStyle(this).backgroundColor;
                  var computedFontSize = window.getComputedStyle(this).fontSize;
                  var computedColor = window.getComputedStyle(this).color;
                  
                  console.log(`\n  📌 Ana Menü ${index + 1}: "${itemText}"`);
                  console.log("    ✓ k-item class:", hasKItem);
                  console.log("    ✓ k-menu-item class:", hasKMenuItem);
                  console.log("    ✓ .k-link bulundu:", kLink.length > 0);
                  if (kLink.length > 0) {
                    console.log("    ✓ .k-link metni:", kLinkText || "(boş)");
                    var kLinkBg = window.getComputedStyle(kLink[0]).backgroundColor;
                    var kLinkFontSize = window.getComputedStyle(kLink[0]).fontSize;
                    var kLinkColor = window.getComputedStyle(kLink[0]).color;
                    console.log("    ✓ .k-link arka plan:", kLinkBg);
                    console.log("    ✓ .k-link font boyutu:", kLinkFontSize);
                    console.log("    ✓ .k-link yazı rengi:", kLinkColor);
                  }
                  console.log("    ✓ Arka plan rengi:", computedBg);
                  console.log("    ✓ Font boyutu:", computedFontSize);
                  console.log("    ✓ Yazı rengi:", computedColor);
                });
              } else {
                console.log("  ⚠️ Ana menü öğeleri bulunamadı!");
                console.log("  💡 HTML yapısını kontrol edin: $('#ana-menu-bar').html()");
              }
              
              // Alt menü öğelerini kontrol et - TÜM YOLLARLA
              console.log("\n\n--- ALT MENÜ KONTROLÜ ---");
              var altMenuItems1 = $("#ana-menu-bar .k-menu-group .k-menu-item");
              var altMenuItems2 = $("#ana-menu-bar .k-popup .k-menu-item");
              var altMenuItems3 = $("#ana-menu-bar .k-menu-group .k-item");
              var altMenuItems4 = $("#ana-menu-bar .k-popup .k-item");
              
              console.log("  - .k-menu-group .k-menu-item sayısı:", altMenuItems1.length);
              console.log("  - .k-popup .k-menu-item sayısı:", altMenuItems2.length);
              console.log("  - .k-menu-group .k-item sayısı:", altMenuItems3.length);
              console.log("  - .k-popup .k-item sayısı:", altMenuItems4.length);
              
              var altMenuItems = altMenuItems1.length > 0 ? altMenuItems1 : 
                                 altMenuItems2.length > 0 ? altMenuItems2 :
                                 altMenuItems3.length > 0 ? altMenuItems3 : altMenuItems4;
              
              console.log("\nKullanılan selector ile bulunan öğe sayısı:", altMenuItems.length);
              
              if (altMenuItems.length > 0) {
                console.log("\n✅ Alt menü öğeleri bulundu!");
                altMenuItems.each(function(index) {
                  var $item = $(this);
                  var itemText = $item.text().trim().replace(/\s+/g, ' ').substring(0, 50);
                  var kLink = $item.find('.k-link').first();
                  var kLinkText = kLink.length > 0 ? kLink.text().trim() : '';
                  var computedBg = window.getComputedStyle(this).backgroundColor;
                  var computedFontSize = window.getComputedStyle(this).fontSize;
                  var computedPaddingLeft = window.getComputedStyle(this).paddingLeft;
                  var computedColor = window.getComputedStyle(this).color;
                  
                  console.log(`\n  📌 Alt Menü ${index + 1}: "${itemText}"`);
                  console.log("    ✓ .k-link bulundu:", kLink.length > 0);
                  if (kLink.length > 0) {
                    console.log("    ✓ .k-link metni:", kLinkText || "(boş)");
                    var kLinkBg = window.getComputedStyle(kLink[0]).backgroundColor;
                    var kLinkFontSize = window.getComputedStyle(kLink[0]).fontSize;
                    var kLinkColor = window.getComputedStyle(kLink[0]).color;
                    console.log("    ✓ .k-link arka plan:", kLinkBg);
                    console.log("    ✓ .k-link font boyutu:", kLinkFontSize);
                    console.log("    ✓ .k-link yazı rengi:", kLinkColor);
                  }
                  console.log("    ✓ Arka plan rengi:", computedBg);
                  console.log("    ✓ Font boyutu:", computedFontSize);
                  console.log("    ✓ Sol padding:", computedPaddingLeft);
                  console.log("    ✓ Yazı rengi:", computedColor);
                });
              } else {
                console.log("  ⚠️ Alt menü öğeleri bulunamadı!");
                console.log("  💡 İpucu: 'Tanımlar' menüsünü AÇIK tutun ve konsolda şunu yazın:");
                console.log("     checkTelerikMenuStyles()");
              }
              
              // Telerik varsayılan stillerini kontrol et
              console.log("\n\n--- TELERIK VARSAYILAN STİLLER ---");
              var kendoStyles = document.querySelector('link[href*="kendo"]');
              if (kendoStyles) {
                console.log("✅ Telerik CSS yüklendi:", kendoStyles.href);
              } else {
                console.log("⚠️ Telerik CSS bulunamadı!");
              }
              
              console.log("\n========================================");
              console.log("=== KONTROL TAMAMLANDI ===");
              console.log("========================================\n");
            }
            
            // İlk kontrol - sayfa yüklendiğinde
            setTimeout(checkTelerikMenuStyles, 2000);
            
            // Global fonksiyon olarak tanımla - konsoldan çağrılabilir
            window.checkTelerikMenuStyles = checkTelerikMenuStyles;
          } catch(error) {
            console.error("❌ Ana menü oluşturulurken hata:", error);
          }
        } else {
          console.log("⏳ Telerik yükleniyor, ana menü bekleniyor...");
          setTimeout(initAnaMenu, 100);
        }
      }
      initAnaMenu();
      
      // Firma Tanımları Window (boş içerik)
      var firmaTanimlariWindow = null;
      var urunTanimlariWindow = null;
      var sistemTanimlariWindow = null;
      var kullaniciTanimlariWindow = null;
      var epostaDialog = null;
      function initFirmaTanimlariWindow() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoWindow !== 'undefined') {
          try {
            firmaTanimlariWindow = $("#firma-tanimlari-window").kendoWindow({
              title: "Firma Tanımları",
              width: "60%",
              height: "60%",
              visible: false,
              modal: false,
              resizable: true,
              draggable: true,
              actions: ["Maximize", "Minimize", "Close"]
            }).data("kendoWindow");
            
            if (typeof $.fn.kendoTextBox !== 'undefined') {
              $("#firma-adi-input").kendoTextBox({
                placeholder: "Firma ismi yazın..."
              });
            }
          } catch (error) {
            console.error("Firma Tanımları Window başlatılırken hata:", error);
          }
        } else {
          setTimeout(initFirmaTanimlariWindow, 100);
        }
      }
      initFirmaTanimlariWindow();

      function initUrunTanimlariWindow() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoWindow !== 'undefined') {
          try {
            urunTanimlariWindow = $("#urun-tanimlari-window").kendoWindow({
              title: "Ürün Tanımları",
              width: "60%",
              height: "60%",
              visible: false,
              modal: false,
              resizable: true,
              draggable: true,
              actions: ["Maximize", "Minimize", "Close"]
            }).data("kendoWindow");
            
            if (typeof $.fn.kendoTextBox !== 'undefined') {
              $("#urun-adi-input").kendoTextBox({
                placeholder: "Ürün ismi yazın..."
              });
            }
          } catch (error) {
            console.error("Ürün Tanımları Window başlatılırken hata:", error);
          }
        } else {
          setTimeout(initUrunTanimlariWindow, 100);
        }
      }
      initUrunTanimlariWindow();

      function initSistemTanimlariWindow() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoWindow !== 'undefined') {
          try {
            sistemTanimlariWindow = $("#sistem-tanimlari-window").kendoWindow({
              title: "Sistem Tanımları",
              width: "60%",
              height: "60%",
              visible: false,
              modal: false,
              resizable: true,
              draggable: true,
              actions: ["Maximize", "Minimize", "Close"]
            }).data("kendoWindow");

            if (typeof $.fn.kendoTextBox !== 'undefined') {
              $("#sistem-adi-input").kendoTextBox({
                placeholder: "Sistem adı yazın..."
              });
            }
          } catch (error) {
            console.error("Sistem Tanımları Window başlatılırken hata:", error);
          }
        } else {
          setTimeout(initSistemTanimlariWindow, 100);
        }
      }
      initSistemTanimlariWindow();

      function initKullaniciTanimlariWindow() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoWindow !== 'undefined') {
          try {
            kullaniciTanimlariWindow = $("#kullanici-tanimlari-window").kendoWindow({
              title: "Kullanıcı Tanımları",
              width: "70%",
              height: "60%",
              visible: false,
              modal: false,
              resizable: true,
              draggable: true,
              actions: ["Maximize", "Minimize", "Close"]
            }).data("kendoWindow");

            if (typeof $.fn.kendoSplitter !== 'undefined') {
              $("#kullanici-splitter").kendoSplitter({
                panes: [
                  { size: "35%", collapsible: true },
                  { collapsible: true }
                ]
              });
            }
          } catch (error) {
            console.error("Kullanıcı Tanımları Window başlatılırken hata:", error);
          }
        } else {
          setTimeout(initKullaniciTanimlariWindow, 100);
        }
      }
      initKullaniciTanimlariWindow();

      function initEpostaDialog() {
        if (typeof kendo !== 'undefined' && typeof $.fn.kendoDialog !== 'undefined') {
          try {
            epostaDialog = $("#eposta-dialog").kendoDialog({
              title: "E Posta Tanımları",
              width: "420px",
              visible: false,
              modal: true,
              actions: [
                { text: "Kapat" }
              ]
            }).data("kendoDialog");

            if (typeof $.fn.kendoTextBox !== 'undefined') {
              $("#eposta-adres-input").kendoTextBox({
                placeholder: "E-posta adresi yazın..."
              });
            }
          } catch (error) {
            console.error("E Posta Dialog başlatılırken hata:", error);
          }
        } else {
          setTimeout(initEpostaDialog, 100);
        }
      }
      initEpostaDialog();
      
      function isWindowOpen(win) {
        return !!(win && win.wrapper && win.wrapper.is(":visible"));
      }

      function openWindowCascade(win) {
        if (!win) {
          return;
        }

        win.open();
        win.center();

        var openCount = 0;
        if (isWindowOpen(firmaTanimlariWindow)) {
          openCount += 1;
        }
        if (isWindowOpen(urunTanimlariWindow)) {
          openCount += 1;
        }
        if (isWindowOpen(sistemTanimlariWindow)) {
          openCount += 1;
        }
        if (isWindowOpen(kullaniciTanimlariWindow)) {
          openCount += 1;
        }

        if (openCount > 1) {
          var offset = (openCount - 1) * 30;
          var wrapper = win.wrapper;
          var top = parseInt(wrapper.css("top"), 10) || 0;
          var left = parseInt(wrapper.css("left"), 10) || 0;
          var maxTop = $(window).height() - wrapper.outerHeight() - 10;
          var maxLeft = $(window).width() - wrapper.outerWidth() - 10;

          top = Math.max(10, Math.min(top + offset, maxTop));
          left = Math.max(10, Math.min(left + offset, maxLeft));

          wrapper.css({ top: top + "px", left: left + "px" });
        }
      }

      function openFirmaTanimlariWindow() {
        if (!firmaTanimlariWindow) {
          initFirmaTanimlariWindow();
          return;
        }
        openWindowCascade(firmaTanimlariWindow);
      }
      
      function openUrunTanimlariWindow() {
        if (!urunTanimlariWindow) {
          initUrunTanimlariWindow();
          return;
        }
        openWindowCascade(urunTanimlariWindow);
      }

      function openSistemTanimlariWindow() {
        if (!sistemTanimlariWindow) {
          initSistemTanimlariWindow();
          return;
        }
        openWindowCascade(sistemTanimlariWindow);
      }

      function openKullaniciTanimlariWindow() {
        if (!kullaniciTanimlariWindow) {
          initKullaniciTanimlariWindow();
          return;
        }
        openWindowCascade(kullaniciTanimlariWindow);
      }

      function openEpostaDialog() {
        if (!epostaDialog) {
          initEpostaDialog();
          return;
        }
        epostaDialog.open();
      }

      // Ribbon butonlarını oluştur (ALAN 2)
      loadRibbonButtons();

      // Telerik TabStrip başlat (ALAN 3) - Sadece operasyon için
      if (typeof kendo !== 'undefined' && typeof $.fn.kendoTabStrip !== 'undefined') {
        tabStrip = $("#tabs").kendoTabStrip({
          animation: false,
          tabPosition: "top",
          select: function(e) {
            // Tab kapatılırken select event'ini ignore et
            if (ignoreSelectEvent) {
              console.log("Select event ignore edildi (tab kapatılıyor)");
              
              // Eğer aktif tab korunması gerekiyorsa koru
              if (activeTabIdToKeep) {
                console.log("Aktif tab korunuyor (select event içinde):", activeTabIdToKeep);
                showPageOnly(activeTabIdToKeep);
                activeTabIdToKeep = null; // Temizle
                ignoreSelectEvent = false; // Flag'i kapat
                return;
              }
              
              ignoreSelectEvent = false; // Flag'i kapat
              return;
            }
            
            // Tab'a tıklayınca sayfayı göster
            var tabItem = $(e.item);
            var tabId = tabItem.attr("data-tab-id");
            var tabText = tabItem.text() || tabItem.html() || "";
            
            console.log("Tab tıklandı, tabId:", tabId, "tabText:", tabText);
            
            // data-tab-id yoksa tabText'ten bul
            if (!tabId) {
              if (tabText.indexOf("Operasyon") >= 0) {
                tabId = "operasyon";
              } else if (tabText.indexOf("Kredi Kartı") >= 0 || tabText.indexOf("Kredi") >= 0) {
                tabId = "kredi-karti";
              } else if (tabText.indexOf("Cari Kart") >= 0) {
                tabId = "cari-kart";
              } else if (tabText.indexOf("Banka") >= 0) {
                tabId = "banka";
              } else if (tabText.indexOf("Tanker") >= 0) {
                tabId = "tanker";
              } else if (tabText.indexOf("Fiyat") >= 0) {
                tabId = "fiyat-degisimi";
              }
            }
            
            if (tabId) {
              console.log("Sayfa gösteriliyor:", tabId);
              showPageOnly(tabId);
            } else {
              console.log("Tab ID bulunamadı!");
            }
          }
        }).data("kendoTabStrip");
        
      }
      
      // X butonlarına event delegation (dinamik elementler için)
      $(document).on("click", ".tab-close-operasyon", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Operasyon X butonuna tıklandı!");
        closeOperasyonTab();
      });
      
      $(document).on("click", ".tab-close-kredi-karti", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Kredi Kartı X butonuna tıklandı!");
        closeKrediKartiTab();
      });
      
      $(document).on("click", ".tab-close-cari-kart", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Cari Kart X butonuna tıklandı!");
        closeCariKartTab();
      });
      
      $(document).on("click", ".tab-close-banka", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Banka X butonuna tıklandı!");
        closeBankaTab();
      });
      
      $(document).on("click", ".tab-close-tanker", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Tanker X butonuna tıklandı!");
        closeTankerTab();
      });
      
      $(document).on("click", ".tab-close-fiyat-degisimi", function(e) {
        e.stopPropagation();
        e.preventDefault();
        console.log("Fiyat Değişimi X butonuna tıklandı!");
        closeFiyatDegisimiTab();
      });
    });
    
    // Ribbon butonlarını oluştur (tüm sayfalarda kullanılabilir) - Telerik Button ile
    function loadRibbonButtons() {
      // Önce mevcut butonları temizle
      $("#ribbon-buttons").empty();
      
      menuItems.forEach(function(item) {
        if (item.aktif) {
          // Yazıları kısa tut, uzunsa kısalt
          var baslik = item.baslik;
          if (baslik.length > 12) {
            baslik = baslik.substring(0, 10) + '...';
          }
          
          // Telerik Button için HTML oluştur
          var buttonId = 'ribbon-btn-' + item.name;
          var buttonHtml = '<button id="' + buttonId + '" class="k-button k-button-md ribbon-button" data-page="' + item.name + '" style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4px 6px;min-width:70px;max-width:70px;height:70px;">' +
            '<span style="font-size:32px;margin-bottom:2px;line-height:1;">' + item.icon + '</span>' +
            '<span style="text-align:center;font-size:12px;line-height:1.1;max-width:65px;word-wrap:break-word;">' + baslik + '</span>' +
            '</button>';
          
          $("#ribbon-buttons").append(buttonHtml);
          
          // Telerik Button'ı başlat (sadece görsel)
          if (typeof kendo !== 'undefined' && typeof $.fn.kendoButton !== 'undefined') {
            $("#" + buttonId).kendoButton();
          }
        }
      });
    }
    
    // Tab yönetimi fonksiyonları temizlendi - Baştan yazılacak
    
    // Aktif ribbon butonunu ayarlama fonksiyonu - Telerik Button için
    function setActiveRibbonButton(pageName) {
      $('button[data-page]').each(function() {
        var page = $(this).data('page');
        var button = $(this).data('kendoButton');
        if (pageName && page === pageName) {
          $(this).addClass('k-state-active');
          $(this).css({
            'background': 'rgba(255,255,255,0.8)',
            'border': '1px solid #808080',
            'box-shadow': 'inset 0 0 2px rgba(0,0,0,0.1)'
          });
        } else {
          $(this).removeClass('k-state-active');
          $(this).css({
            'background': '',
            'border': '',
            'box-shadow': ''
          });
        }
      });
    }
    
    // Aktif tab ID'sini bul
    function getActiveTabId() {
      var activeTab = tabStrip.select();
      if (!activeTab) return null;
      
      var activeTabElement = $(activeTab);
      var activeTabId = activeTabElement.attr("data-tab-id");
      var activeTabText = activeTabElement.text() || activeTabElement.html() || "";
      
      if (!activeTabId) {
        if (activeTabText.indexOf("Operasyon") >= 0) {
          activeTabId = "operasyon";
        } else if (activeTabText.indexOf("Kredi Kartı") >= 0 || activeTabText.indexOf("Kredi") >= 0) {
          activeTabId = "kredi-karti";
        } else if (activeTabText.indexOf("Cari Kart") >= 0) {
          activeTabId = "cari-kart";
        } else if (activeTabText.indexOf("Banka") >= 0) {
          activeTabId = "banka";
        } else if (activeTabText.indexOf("Tanker") >= 0) {
          activeTabId = "tanker";
        } else if (activeTabText.indexOf("Fiyat") >= 0) {
          activeTabId = "fiyat-degisimi";
        }
      }
      
      return activeTabId;
    }
    
    // Tab ID'sine göre tab index'ini bul (GitHub çözümü)
    function getTabIndexById(tabId) {
      var items = tabStrip.items();
      var index = -1;
      for (var i = 0; i < items.length; i++) {
        var tab = $(items[i]);
        var currentTabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        // data-tab-id yoksa tabText'ten bul
        if (!currentTabId) {
          if (tabText.indexOf("Operasyon") >= 0) {
            currentTabId = "operasyon";
          } else if (tabText.indexOf("Kredi Kartı") >= 0 || tabText.indexOf("Kredi") >= 0) {
            currentTabId = "kredi-karti";
          } else if (tabText.indexOf("Cari Kart") >= 0) {
            currentTabId = "cari-kart";
          } else if (tabText.indexOf("Banka") >= 0) {
            currentTabId = "banka";
          } else if (tabText.indexOf("Tanker") >= 0) {
            currentTabId = "tanker";
          } else if (tabText.indexOf("Fiyat") >= 0) {
            currentTabId = "fiyat-degisimi";
          }
        }
        
        if (currentTabId === tabId) {
          index = i;
          break;
        }
      }
      return index;
    }
    
    // Tab kapatıldığında solundaki tab'ı bul ve göster
    function showNextTabAfterClose(closedTabIndex, wasActiveTab) {
      setTimeout(function() {
        var remainingTabs = tabStrip.items();
        var remainingTabsCount = remainingTabs.length;
        console.log("Kalan tab sayısı:", remainingTabsCount, "Kapatılan tab index:", closedTabIndex, "Aktif tab mıydı:", wasActiveTab);
        
        if (remainingTabsCount === 0) {
          // Hiç tab kalmadı → Lobiye dön
          console.log("Tüm tab'lar kapandı, lobiye dönülüyor...");
          showPageOnly(null);
          setActiveRibbonButton(null);
        } else {
          // Aktif tab kapatıldıysa → Solundaki tab'ı göster
          // Aktif olmayan tab kapatıldıysa → Aktif tab'ı koru (sayfa değişmesin)
          if (wasActiveTab) {
            // Aktif tab kapatıldı → Solundaki tab'ı aktif yap
            var nextTabIndex;
            if (closedTabIndex > 0) {
              // Solunda tab var → Solundaki tab'ı göster
              nextTabIndex = closedTabIndex - 1;
            } else {
              // En soldaki tab kapatıldı → En soldaki tab'ı göster (şimdi index 0)
              nextTabIndex = 0;
            }
            
            // Index sınırlarını kontrol et
            if (nextTabIndex >= remainingTabsCount) {
              nextTabIndex = remainingTabsCount - 1;
            }
            
            var nextTab = remainingTabs[nextTabIndex];
            
            if (nextTab) {
              var nextTabElement = $(nextTab);
              var nextTabId = nextTabElement.attr("data-tab-id");
              var nextTabText = nextTabElement.text() || nextTabElement.html() || "";
              
              // data-tab-id yoksa tabText'ten bul
              if (!nextTabId) {
                if (nextTabText.indexOf("Operasyon") >= 0) {
                  nextTabId = "operasyon";
                } else if (nextTabText.indexOf("Kredi Kartı") >= 0 || nextTabText.indexOf("Kredi") >= 0) {
                  nextTabId = "kredi-karti";
                } else if (nextTabText.indexOf("Cari Kart") >= 0) {
                  nextTabId = "cari-kart";
                } else if (nextTabText.indexOf("Banka") >= 0) {
                  nextTabId = "banka";
                } else if (nextTabText.indexOf("Tanker") >= 0) {
                  nextTabId = "tanker";
                } else if (nextTabText.indexOf("Fiyat") >= 0) {
                  nextTabId = "fiyat-degisimi";
                }
              }
              
              if (nextTabId) {
                console.log("Aktif tab kapatıldı, solundaki tab gösteriliyor:", nextTabId, "Index:", nextTabIndex);
                // Aktif tab kapatıldığında select event'ini ignore et (çünkü manuel olarak select yapıyoruz)
                ignoreSelectEvent = true;
                tabStrip.select(nextTabIndex);
                showPageOnly(nextTabId);
                ignoreSelectEvent = false;
              } else {
                console.log("Solundaki tab ID bulunamadı, lobiye dönülüyor...");
                showPageOnly(null);
              }
            } else {
              console.log("Solundaki tab bulunamadı, lobiye dönülüyor...");
              showPageOnly(null);
            }
          } else {
            // Aktif olmayan tab kapatıldı → Aktif tab'ı koru, sayfa değişmesin
            console.log("Aktif olmayan tab kapatıldı, aktif tab korunuyor...");
            var currentActiveTab = tabStrip.select();
            var remainingTabsArray = tabStrip.items();
            var currentActiveTabIndex = -1;
            for (var j = 0; j < remainingTabsArray.length; j++) {
              if ($(remainingTabsArray[j])[0] === $(currentActiveTab)[0]) {
                currentActiveTabIndex = j;
                break;
              }
            }
            
            if (currentActiveTabIndex >= 0 && currentActiveTabIndex < remainingTabsCount) {
              var activeTabElement = $(currentActiveTab);
              var activeTabId = activeTabElement.attr("data-tab-id");
              var activeTabText = activeTabElement.text() || activeTabElement.html() || "";
              
              // data-tab-id yoksa tabText'ten bul
              if (!activeTabId) {
                if (activeTabText.indexOf("Operasyon") >= 0) {
                  activeTabId = "operasyon";
                } else if (activeTabText.indexOf("Kredi Kartı") >= 0 || activeTabText.indexOf("Kredi") >= 0) {
                  activeTabId = "kredi-karti";
                } else if (activeTabText.indexOf("Cari Kart") >= 0) {
                  activeTabId = "cari-kart";
                } else if (activeTabText.indexOf("Banka") >= 0) {
                  activeTabId = "banka";
                } else if (activeTabText.indexOf("Tanker") >= 0) {
                  activeTabId = "tanker";
                } else if (activeTabText.indexOf("Fiyat") >= 0) {
                  activeTabId = "fiyat-degisimi";
                }
              }
              
              if (activeTabId) {
                console.log("Aktif tab korunuyor:", activeTabId);
                showPageOnly(activeTabId);
              }
            }
          }
          
          setActiveRibbonButton(null);
        }
        
        // Flag'i her zaman sıfırla (işlem bittikten sonra)
        ignoreSelectEvent = false;
      }, 50);
    }
    
    // Tüm sayfaları gizle, sadece belirtilen sayfayı göster
    function showPageOnly(pageId) {
      // Body class'larını temizle
      $('body').removeClass('operasyon-sayfasi-acik kredi-karti-sayfasi-acik cari-kart-sayfasi-acik banka-sayfasi-acik tanker-sayfasi-acik fiyat-degisimi-sayfasi-acik');
      
      // Tüm sayfaları gizle
      $('#main-content-operasyon').hide();
      $('#main-content-kredi-karti').hide();
      $('#main-content-cari-kart').hide();
      $('#main-content-banka').hide();
      $('#main-content-tanker').hide();
      $('#main-content-fiyat-degisimi').hide();
      
      // Belirtilen sayfayı göster
      if (pageId === 'operasyon') {
        $('body').addClass('operasyon-sayfasi-acik');
        $('#main-content-operasyon').show();
        $('#title-bar').hide();
      } else if (pageId === 'kredi-karti') {
        $('body').addClass('kredi-karti-sayfasi-acik');
        $('#main-content-kredi-karti').show();
        $('#title-bar').hide();
      } else if (pageId === 'cari-kart') {
        $('body').addClass('cari-kart-sayfasi-acik');
        $('#main-content-cari-kart').show();
        $('#title-bar').hide();
      } else if (pageId === 'banka') {
        $('body').addClass('banka-sayfasi-acik');
        $('#main-content-banka').show();
        $('#title-bar').hide();
      } else if (pageId === 'tanker') {
        $('body').addClass('tanker-sayfasi-acik');
        $('#main-content-tanker').show();
        $('#title-bar').hide();
      } else if (pageId === 'fiyat-degisimi') {
        $('body').addClass('fiyat-degisimi-sayfasi-acik');
        $('#main-content-fiyat-degisimi').show();
        $('#title-bar').hide();
      } else {
        // Hiçbir sayfa açık değilse lobi göster
        $('#title-bar').show();
      }
    }
    
    // Sadece Operasyon sayfası için basit tab mantığı
    function openOperasyonTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      // Tab zaten var mı kontrol et - Tüm tab'ları kontrol et
      var allTabs = tabStrip.items();
      var operasyonTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        // data-tab-id veya içerikte "Operasyon" kelimesi varsa
        if (tabId === "operasyon" || tabText.indexOf("Operasyon") >= 0) {
          operasyonTabIndex = i;
          break;
        }
      }
      
      // Tab zaten varsa sadece aktif yap
      if (operasyonTabIndex >= 0) {
        console.log("Operasyon tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(operasyonTabIndex);
        showPageOnly('operasyon');
        return;
      }
      
      // Yeni tab ekle
      console.log("Yeni operasyon tab'ı ekleniyor...");
      
      // ÖNCE sayfayı göster (tab eklenmeden önce)
      showPageOnly('operasyon');
      
      var tabContent = '⛽ Operasyon Sayfası <span class="tab-close-operasyon" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      // Tab elementine data-tab-id ekle
      setTimeout(function() {
        var allTabsArray = tabStrip.items();
        var addedTab = allTabsArray[allTabsArray.length - 1];
        $(addedTab).attr("data-tab-id", "operasyon");
        
        // Event delegation zaten document ready'de tanımlı, burada ekstra bir şey yapmaya gerek yok
        
        // Tab'ı aktif yap
        var tabIndex = allTabsArray.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Operasyon tab'ını kapat
    function closeOperasyonTab() {
      console.log("closeOperasyonTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      // Tab'ı bul ve kapat
      var allTabs = tabStrip.items();
      var operasyonTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "operasyon" || tabText.indexOf("Operasyon") >= 0) {
          operasyonTabIndex = i;
          break;
        }
      }
      
      // Kapatılmadan önce aktif tab mı kontrol et ve aktif tab ID'sini kaydet
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (operasyonTabIndex >= 0 && operasyonTabIndex === activeTabIndex);
      
      if (operasyonTabIndex < 0) {
        console.log("Operasyon tab'ı bulunamadı!");
        return;
      }
      
      // Pasif tab kapatılıyorsa aktif tab ID'sini kaydet
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true; // Select event'ini ignore et
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      // GitHub çözümü: setTimeout ile remove() çağrısını ertele
      setTimeout(function() {
        try {
          console.log("Operasyon tab'ı kapatılıyor... Index:", operasyonTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(operasyonTabIndex);
          console.log("Tab kapatıldı, kalan tab sayısı:", tabStrip.items().length);
          
          // Pasif tab kapatıldıysa aktif tab'ı manuel olarak tekrar seç
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true; // Manuel seçim sırasında select event'ini ignore et
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            // Aktif tab kapatıldıysa solundaki tab'ı göster
            showNextTabAfterClose(operasyonTabIndex, wasActiveTab);
          }
        } catch(error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }
    
    // Kredi kartı tab'ını aç - Operasyon kodlarının birebir aynısı
    function openKrediKartiTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      // Tab zaten var mı kontrol et - Tüm tab'ları kontrol et
      var allTabs = tabStrip.items();
      var krediKartiTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        // data-tab-id veya içerikte "Kredi Kartı" kelimesi varsa
        if (tabId === "kredi-karti" || tabText.indexOf("Kredi Kartı") >= 0) {
          krediKartiTabIndex = i;
          break;
        }
      }
      
      // Tab zaten varsa sadece aktif yap
      if (krediKartiTabIndex >= 0) {
        console.log("Kredi Kartı tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(krediKartiTabIndex);
        showPageOnly('kredi-karti');
        return;
      }
      
      // Yeni tab ekle
      console.log("Yeni kredi kartı tab'ı ekleniyor...");
      
      // ÖNCE sayfayı göster (tab eklenmeden önce)
      showPageOnly('kredi-karti');
      
      var tabContent = '💳 Kredi Kartı <span class="tab-close-kredi-karti" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      // Tab elementine data-tab-id ekle
      setTimeout(function() {
        var allTabsArray = tabStrip.items();
        var addedTab = allTabsArray[allTabsArray.length - 1];
        $(addedTab).attr("data-tab-id", "kredi-karti");
        
        // Event delegation zaten document ready'de tanımlı, burada ekstra bir şey yapmaya gerek yok
        
        // Tab'ı aktif yap
        var tabIndex = allTabsArray.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Kredi kartı tab'ını kapat - Operasyon kodlarının birebir aynısı
    function closeKrediKartiTab() {
      console.log("closeKrediKartiTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      // Tab'ı bul ve kapat
      var allTabs = tabStrip.items();
      var krediKartiTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "kredi-karti" || tabText.indexOf("Kredi Kartı") >= 0) {
          krediKartiTabIndex = i;
          break;
        }
      }
      
      // Kapatılmadan önce aktif tab mı kontrol et ve aktif tab ID'sini kaydet
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (krediKartiTabIndex >= 0 && krediKartiTabIndex === activeTabIndex);
      
      if (krediKartiTabIndex < 0) {
        console.log("Kredi Kartı tab'ı bulunamadı!");
        return;
      }
      
      // Pasif tab kapatılıyorsa aktif tab ID'sini kaydet
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true;
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      // GitHub çözümü: setTimeout ile remove() çağrısını ertele
      setTimeout(function() {
        try {
          console.log("Kredi Kartı tab'ı kapatılıyor... Index:", krediKartiTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(krediKartiTabIndex);
          
          // Pasif tab kapatıldıysa aktif tab'ı manuel olarak tekrar seç
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true;
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            showNextTabAfterClose(krediKartiTabIndex, wasActiveTab);
          }
        } catch(error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }
    
    // Cari kart tab'ını aç - Operasyon kodlarının birebir aynısı
    function openCariKartTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var cariKartTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "cari-kart" || tabText.indexOf("Cari Kart") >= 0) {
          cariKartTabIndex = i;
          break;
        }
      }
      
      if (cariKartTabIndex >= 0) {
        console.log("Cari Kart tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(cariKartTabIndex);
        showPageOnly('cari-kart');
        return;
      }
      
      console.log("Yeni cari kart tab'ı ekleniyor...");
      showPageOnly('cari-kart');
      
      var tabContent = '👤 Cari Kartlar <span class="tab-close-cari-kart" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      setTimeout(function() {
        var allTabsArray = tabStrip.items();
        var addedTab = allTabsArray[allTabsArray.length - 1];
        $(addedTab).attr("data-tab-id", "cari-kart");
        var tabIndex = allTabsArray.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Cari kart tab'ını kapat - Operasyon kodlarının birebir aynısı
    function closeCariKartTab() {
      console.log("closeCariKartTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var cariKartTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "cari-kart" || tabText.indexOf("Cari Kart") >= 0) {
          cariKartTabIndex = i;
          break;
        }
      }
      
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (cariKartTabIndex >= 0 && cariKartTabIndex === activeTabIndex);
      
      if (cariKartTabIndex < 0) {
        console.log("Cari Kart tab'ı bulunamadı!");
        return;
      }
      
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true;
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      setTimeout(function() {
        try {
          console.log("Cari Kart tab'ı kapatılıyor... Index:", cariKartTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(cariKartTabIndex);
          
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true;
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            showNextTabAfterClose(cariKartTabIndex, wasActiveTab);
          }
        } catch (error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }
    
    // Banka tab'ını aç - Operasyon kodlarının birebir aynısı
    function openBankaTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var bankaTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "banka" || tabText.indexOf("Banka") >= 0) {
          bankaTabIndex = i;
          break;
        }
      }
      
      if (bankaTabIndex >= 0) {
        console.log("Banka tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(bankaTabIndex);
        showPageOnly('banka');
        return;
      }
      
      console.log("Yeni banka tab'ı ekleniyor...");
      showPageOnly('banka');
      
      var tabContent = '🏦 Banka <span class="tab-close-banka" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      setTimeout(function() {
        var allTabsArray = tabStrip.items();
        var addedTab = allTabsArray[allTabsArray.length - 1];
        $(addedTab).attr("data-tab-id", "banka");
        var tabIndex = allTabsArray.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Banka tab'ını kapat - Operasyon kodlarının birebir aynısı
    function closeBankaTab() {
      console.log("closeBankaTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var bankaTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "banka" || tabText.indexOf("Banka") >= 0) {
          bankaTabIndex = i;
          break;
        }
      }
      
      // Kapatılmadan önce aktif tab mı kontrol et ve aktif tab ID'sini kaydet
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (bankaTabIndex >= 0 && bankaTabIndex === activeTabIndex);
      
      if (bankaTabIndex < 0) {
        console.log("Banka tab'ı bulunamadı!");
        return;
      }
      
      // Pasif tab kapatılıyorsa aktif tab ID'sini kaydet
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true;
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      // GitHub çözümü: setTimeout ile remove() çağrısını ertele
      setTimeout(function() {
        try {
          console.log("Banka tab'ı kapatılıyor... Index:", bankaTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(bankaTabIndex);
          
          // Pasif tab kapatıldıysa aktif tab'ı manuel olarak tekrar seç
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true;
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            showNextTabAfterClose(bankaTabIndex, wasActiveTab);
          }
        } catch(error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }
    
    // Tanker tab'ını aç - Operasyon kodlarının birebir aynısı
    function openTankerTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var tankerTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "tanker" || tabText.indexOf("Tanker") >= 0) {
          tankerTabIndex = i;
          break;
        }
      }
      
      if (tankerTabIndex >= 0) {
        console.log("Tanker tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(tankerTabIndex);
        showPageOnly('tanker');
        return;
      }
      
      console.log("Yeni tanker tab'ı ekleniyor...");
      showPageOnly('tanker');
      
      var tabContent = '🚛 Tanker <span class="tab-close-tanker" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      setTimeout(function() {
        var allTabsArray = tabStrip.items();
        var addedTab = allTabsArray[allTabsArray.length - 1];
        $(addedTab).attr("data-tab-id", "tanker");
        var tabIndex = allTabsArray.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Tanker tab'ını kapat - Operasyon kodlarının birebir aynısı
    function closeTankerTab() {
      console.log("closeTankerTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var tankerTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "tanker" || tabText.indexOf("Tanker") >= 0) {
          tankerTabIndex = i;
          break;
        }
      }
      
      // Kapatılmadan önce aktif tab mı kontrol et ve aktif tab ID'sini kaydet
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (tankerTabIndex >= 0 && tankerTabIndex === activeTabIndex);
      
      if (tankerTabIndex < 0) {
        console.log("Tanker tab'ı bulunamadı!");
        return;
      }
      
      // Pasif tab kapatılıyorsa aktif tab ID'sini kaydet
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true;
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      // GitHub çözümü: setTimeout ile remove() çağrısını ertele
      setTimeout(function() {
        try {
          console.log("Tanker tab'ı kapatılıyor... Index:", tankerTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(tankerTabIndex);
          
          // Pasif tab kapatıldıysa aktif tab'ı manuel olarak tekrar seç
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true;
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            showNextTabAfterClose(tankerTabIndex, wasActiveTab);
          }
        } catch(error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }
    
    // Fiyat değişimi tab'ını aç - Operasyon kodlarının birebir aynısı
    function openFiyatDegisimiTab() {
      if (!tabStrip) {
        console.error("TabStrip başlatılmamış!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var fiyatDegisimiTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "fiyat-degisimi" || tabText.indexOf("Fiyat") >= 0) {
          fiyatDegisimiTabIndex = i;
          break;
        }
      }
      
      if (fiyatDegisimiTabIndex >= 0) {
        console.log("Fiyat Değişimi tab'ı zaten var, aktif yapılıyor...");
        tabStrip.select(fiyatDegisimiTabIndex);
        showPageOnly('fiyat-degisimi');
        return;
      }
      
      console.log("Yeni fiyat değişimi tab'ı ekleniyor...");
      showPageOnly('fiyat-degisimi');
      
      var tabContent = '💰 Fiyat Değişimi <span class="tab-close-fiyat-degisimi" style="margin-left:6px;cursor:pointer;padding:2px 4px;border-radius:4px;font-weight:bold;">×</span>';
      
      tabStrip.append({
        text: tabContent,
        content: '<div></div>',
        encoded: false
      });
      
      setTimeout(function() {
        var allTabs = tabStrip.items();
        var addedTab = allTabs[allTabs.length - 1];
        $(addedTab).attr("data-tab-id", "fiyat-degisimi");
        var tabIndex = allTabs.length - 1;
        if (tabIndex >= 0) {
          tabStrip.select(tabIndex);
        }
      }, 100);
    }
    
    // Fiyat değişimi tab'ını kapat - Operasyon kodlarının birebir aynısı
    function closeFiyatDegisimiTab() {
      console.log("closeFiyatDegisimiTab çağrıldı");
      if (!tabStrip) {
        console.error("TabStrip yok!");
        return;
      }
      
      var allTabs = tabStrip.items();
      var fiyatDegisimiTabIndex = -1;
      
      for (var i = 0; i < allTabs.length; i++) {
        var tab = $(allTabs[i]);
        var tabId = tab.attr("data-tab-id");
        var tabText = tab.text() || tab.html() || "";
        
        if (tabId === "fiyat-degisimi" || tabText.indexOf("Fiyat") >= 0) {
          fiyatDegisimiTabIndex = i;
          break;
        }
      }
      
      // Kapatılmadan önce aktif tab mı kontrol et ve aktif tab ID'sini kaydet
      var activeTab = tabStrip.select();
      var allTabsArray = tabStrip.items();
      var activeTabIndex = -1;
      for (var j = 0; j < allTabsArray.length; j++) {
        if ($(allTabsArray[j])[0] === $(activeTab)[0]) {
          activeTabIndex = j;
          break;
        }
      }
      var wasActiveTab = (fiyatDegisimiTabIndex >= 0 && fiyatDegisimiTabIndex === activeTabIndex);
      
      if (fiyatDegisimiTabIndex < 0) {
        console.log("Fiyat Değişimi tab'ı bulunamadı!");
        return;
      }
      
      // Pasif tab kapatılıyorsa aktif tab ID'sini kaydet
      if (!wasActiveTab) {
        activeTabIdToKeep = getActiveTabId();
        ignoreSelectEvent = true;
        console.log("Pasif tab kapatılıyor, aktif tab korunacak:", activeTabIdToKeep);
      }
      
      // GitHub çözümü: setTimeout ile remove() çağrısını ertele
      setTimeout(function() {
        try {
          console.log("Fiyat Değişimi tab'ı kapatılıyor... Index:", fiyatDegisimiTabIndex, "Aktif tab mı:", wasActiveTab);
          tabStrip.remove(fiyatDegisimiTabIndex);
          
          // Pasif tab kapatıldıysa aktif tab'ı manuel olarak tekrar seç
          if (!wasActiveTab && activeTabIdToKeep) {
            var desiredTabIndex = getTabIndexById(activeTabIdToKeep);
            if (desiredTabIndex >= 0) {
              console.log("Aktif tab manuel olarak tekrar seçiliyor:", activeTabIdToKeep, "Index:", desiredTabIndex);
              ignoreSelectEvent = true;
              tabStrip.select(desiredTabIndex);
              showPageOnly(activeTabIdToKeep);
              ignoreSelectEvent = false;
              activeTabIdToKeep = null;
            }
          } else if (wasActiveTab) {
            showNextTabAfterClose(fiyatDegisimiTabIndex, wasActiveTab);
          }
        } catch(error) {
          console.error("Tab kapatılırken hata:", error);
          ignoreSelectEvent = false;
          activeTabIdToKeep = null;
        }
      }, 0);
    }

    
    // Ribbon butonlarına tıklama - Tüm sayfalar için
    $(document).on("click", ".ribbon-button", function(e) {
      e.preventDefault();
      e.stopPropagation();
      
      var pageName = $(this).data('page');
      console.log("Ribbon buton tıklandı, pageName:", pageName);
      
      // Operasyon sayfası
      if (pageName === 'operasyon_sayfasi' || pageName === 'operasyon') {
        console.log("Operasyon sayfası açılıyor...");
        openOperasyonTab();
        setActiveRibbonButton(pageName);
      }
      // Kredi Kartı sayfası
      else if (pageName === 'kredi_karti' || pageName === 'kredi-karti' || pageName === 'kredi_kart') {
        console.log("Kredi Kartı sayfası açılıyor...");
        openKrediKartiTab();
        setActiveRibbonButton(pageName);
      }
      // Cari Kart sayfası
      else if (pageName === 'cari_kart' || pageName === 'cari-kart' || pageName === 'carikart') {
        console.log("Cari Kart sayfası açılıyor...");
        openCariKartTab();
        setActiveRibbonButton(pageName);
      }
      // Banka sayfası
      else if (pageName === 'banka') {
        console.log("Banka sayfası açılıyor...");
        openBankaTab();
        setActiveRibbonButton(pageName);
      }
      // Tanker sayfası
      else if (pageName === 'tanker') {
        console.log("Tanker sayfası açılıyor...");
        openTankerTab();
        setActiveRibbonButton(pageName);
      }
      // Fiyat Değişimi sayfası
      else if (pageName === 'fiyat_degisimi' || pageName === 'fiyat-degisimi') {
        console.log("Fiyat Değişimi sayfası açılıyor...");
        openFiyatDegisimiTab();
        setActiveRibbonButton(pageName);
      } else {
        // Diğer sayfalar için şimdilik bir şey yapma
        console.log("Diğer sayfa:", pageName, "- Şimdilik çalışmıyor");
      }
    });
    
    // duzeltGridBorderSorunu fonksiyonu - Grid border sorununu düzeltir
    function duzeltGridBorderSorunu(gridSelector, gridWidth) {
      try {
        var $grid = $(gridSelector);
        if ($grid.length === 0) {
          console.warn("Grid bulunamadı:", gridSelector);
          return;
        }
        
        // Grid container genişliğini ayarla
        $grid.css({
          'width': gridWidth + 'px',
          'max-width': gridWidth + 'px',
          'min-width': gridWidth + 'px'
        });
        
        // Grid wrapper genişliğini ayarla
        var $wrapper = $grid.closest('.k-grid-wrapper, .k-widget');
        if ($wrapper.length > 0) {
          $wrapper.css({
            'width': gridWidth + 'px',
            'max-width': gridWidth + 'px'
          });
        }
        
        console.log("Grid border sorunu düzeltildi:", gridSelector, "Genişlik:", gridWidth + 'px');
      } catch(error) {
        console.error("duzeltGridBorderSorunu hatası:", error);
      }
    }
    
    // Global fonksiyon olarak tanımla
    window.duzeltGridBorderSorunu = duzeltGridBorderSorunu;
  </script>
  
  {% block extra_scripts %}{% endblock %}
</body>
</html>
