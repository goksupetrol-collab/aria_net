{% load static %}
<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard - İskelet</title>
  <style>
    *{box-sizing:border-box}
    body{margin:0;overflow:hidden;font-family:Segoe UI,Arial,sans-serif;background:#e6e6e6;font-size:11px}

    /* 1900x890 sabit çalışma alanı */
    #scale-root{width:1900px;height:890px;transform-origin:top left}

    /* ANA LAYOUT */
    .wrap{
      width:1900px;height:890px;
      display:grid;
      grid-template-columns: 620px 620px 640px;
      grid-template-rows: 448px 438px;
      gap:10px;
      padding:10px;
    }

    /* Sol üst 2 MTR */
    .mtr1{grid-column:1;grid-row:1}
    .mtr2{grid-column:2;grid-row:1}

    /* Sağ üst blok (TAHSİLAT/ÖDEME + toplamlar + sağ taraf alt bloklar) */
    .right{grid-column:3;grid-row:1 / span 2;min-height:0}

    /* Alt sol giriş */
    .entry{grid-column:1;grid-row:2}

    /* Alt orta araçlar */
    .cars{grid-column:2;grid-row:2;min-height:0}
    .cars .panel{height:100%;display:flex;flex-direction:column;overflow:hidden}
    .cars .carsGrid{flex:1;min-height:0;overflow-y:auto;overflow-x:auto}
    .cars .title-container{
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:relative;
    }
    .cars .title-container .title{
      flex:1;
      margin:0;
    }
    .cars .arac-bilgi-btn{
      padding:6px 12px;
      background:#1e3a8a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:11px;
      font-weight:700;
      cursor:pointer;
      margin-right:5px;
    }
    .cars .arac-bilgi-btn:hover{
      background:#1e5a9a;
    }
    /* Arac Bilgi Modal */
    .arac-bilgi-modal, .tahsilat-aciklama-modal, .odeme-aciklama-modal{
      display:none;
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,.5);
      z-index:10000;
      justify-content:center;
      align-items:center;
    }
    .tahsilat-aciklama-modal.show, .odeme-aciklama-modal.show{
      display:flex;
    }
    .tahsilat-aciklama-modal-content{
      background:#fff;
      border-radius:8px;
      padding:20px;
      width:500px;
      max-height:90vh;
      overflow-y:auto;
      box-shadow:0 4px 20px rgba(0,0,0,.3);
    }
    .tahsilat-aciklama-modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:15px;
      padding-bottom:10px;
      border-bottom:2px solid #1e3a8a;
    }
    .tahsilat-aciklama-modal-header h2{
      margin:0;
      color:#1e3a8a;
      font-size:16px;
    }
    .tahsilat-aciklama-modal-close{
      background:none;
      border:none;
      font-size:24px;
      cursor:pointer;
      color:#666;
      padding:0;
      width:30px;
      height:30px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .tahsilat-aciklama-modal-close:hover{
      color:#000;
    }
    .tahsilat-aciklama-modal-body{
      margin-bottom:15px;
    }
    .tahsilat-aciklama-input-row{
      display:flex;
      align-items:center;
      margin-bottom:8px;
    }
    .tahsilat-aciklama-input-row label{
      width:30px;
      font-size:11px;
      font-weight:600;
      color:#333;
      margin-right:8px;
    }
    .tahsilat-aciklama-input-row input{
      flex:1;
      padding:6px;
      border:1px solid #ccc;
      border-radius:4px;
      font-size:12px;
    }
    .tahsilat-aciklama-input-row input:focus{
      outline:none;
      border-color:#1e3a8a;
    }
    .tahsilat-aciklama-modal-actions{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      margin-top:15px;
      padding-top:15px;
      border-top:1px solid #eee;
    }
    .tahsilat-aciklama-btn-save{
      padding:8px 20px;
      background:#1fa34a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
    }
    .tahsilat-aciklama-btn-save:hover{
      background:#1d8f3f;
    }
    .tahsilat-aciklama-btn-cancel{
      padding:8px 20px;
      background:#ccc;
      color:#333;
      border:none;
      border-radius:4px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
    }
    .tahsilat-aciklama-btn-cancel:hover{
      background:#bbb;
    }
    .odeme-aciklama-modal-content{
      background:#fff;
      border-radius:8px;
      padding:20px;
      width:500px;
      max-height:90vh;
      overflow-y:auto;
      box-shadow:0 4px 20px rgba(0,0,0,.3);
    }
    .odeme-aciklama-modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:15px;
      padding-bottom:10px;
      border-bottom:2px solid #1e3a8a;
    }
    .odeme-aciklama-modal-header h2{
      margin:0;
      color:#1e3a8a;
      font-size:16px;
    }
    .odeme-aciklama-modal-close{
      background:none;
      border:none;
      font-size:24px;
      cursor:pointer;
      color:#666;
      padding:0;
      width:30px;
      height:30px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .odeme-aciklama-modal-close:hover{
      color:#000;
    }
    .odeme-aciklama-modal-body{
      margin-bottom:15px;
    }
    .odeme-aciklama-input-row{
      display:flex;
      align-items:center;
      margin-bottom:8px;
    }
    .odeme-aciklama-input-row label{
      width:30px;
      font-size:11px;
      font-weight:600;
      color:#333;
      margin-right:8px;
    }
    .odeme-aciklama-input-row input{
      flex:1;
      padding:6px;
      border:1px solid #ccc;
      border-radius:4px;
      font-size:12px;
    }
    .odeme-aciklama-input-row input:focus{
      outline:none;
      border-color:#1e3a8a;
    }
    .odeme-aciklama-modal-actions{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      margin-top:15px;
      padding-top:15px;
      border-top:1px solid #eee;
    }
    .odeme-aciklama-btn-save{
      padding:8px 20px;
      background:#1fa34a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
    }
    .odeme-aciklama-btn-save:hover{
      background:#1d8f3f;
    }
    .odeme-aciklama-btn-cancel{
      padding:8px 20px;
      background:#ccc;
      color:#333;
      border:none;
      border-radius:4px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
    }
    .odeme-aciklama-btn-cancel:hover{
      background:#bbb;
    }
    .arac-bilgi-modal.show{
      display:flex;
    }
    .arac-bilgi-modal-content{
      background:#fff;
      border-radius:8px;
      padding:20px;
      width:95%;
      max-width:1600px;
      max-height:90vh;
      overflow-y:auto;
      box-shadow:0 4px 20px rgba(0,0,0,.3);
    }
    .arac-bilgi-table-container{
      overflow-x:auto;
      margin-bottom:20px;
    }
    .arac-bilgi-table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    .arac-bilgi-table th{
      background:#1e3a8a;
      color:#fff;
      padding:8px 4px;
      text-align:center;
      font-weight:700;
      border:1px solid rgba(0,0,0,.1);
      position:sticky;
      top:0;
      z-index:10;
    }
    .arac-bilgi-table td{
      padding:6px 4px;
      border:1px solid rgba(0,0,0,.1);
      text-align:center;
    }
    .arac-bilgi-table input{
      width:100%;
      padding:4px;
      border:1px solid #ccc;
      border-radius:3px;
      font-size:11px;
      text-align:center;
      box-sizing:border-box;
    }
    .arac-bilgi-table input:focus{
      outline:none;
      border-color:#1e3a8a;
      background:#f0f4ff;
    }
    .arac-bilgi-table tbody tr:nth-child(even){
      background:#f9f9f9;
    }
    .arac-bilgi-table tbody tr:hover{
      background:#f0f4ff;
    }
    .arac-bilgi-table tbody tr.aktif{
      background:#90ee90 !important;
    }
    .arac-bilgi-table tbody tr.aktif:hover{
      background:#7dd87d !important;
    }
    /* Araç sıra butonları kaldırıldı */
    .arac-bilgi-modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:20px;
      padding-bottom:10px;
      border-bottom:2px solid #1e3a8a;
    }
    .arac-bilgi-modal-header h2{
      margin:0;
      color:#1e3a8a;
      font-size:18px;
    }
    .arac-bilgi-modal-close{
      background:none;
      border:none;
      font-size:24px;
      cursor:pointer;
      color:#666;
      padding:0;
      width:30px;
      height:30px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .arac-bilgi-modal-close:hover{
      color:#000;
    }
    .arac-bilgi-form-row{
      display:flex;
      margin-bottom:15px;
      align-items:center;
    }
    .arac-bilgi-form-label{
      width:120px;
      font-weight:600;
      color:#333;
      font-size:12px;
    }
    .arac-bilgi-form-input{
      flex:1;
      padding:8px;
      border:1px solid #ccc;
      border-radius:4px;
      font-size:12px;
    }
    .arac-bilgi-form-input:focus{
      outline:none;
      border-color:#1e3a8a;
    }
    .arac-bilgi-modal-actions{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      margin-top:20px;
      padding-top:15px;
      border-top:1px solid #eee;
    }
    /* Araç kaydet butonu kaldırıldı */
    .arac-bilgi-btn-cancel{
      padding:10px 20px;
      background:#ccc;
      color:#333;
      border:none;
      border-radius:4px;
      font-size:13px;
      font-weight:700;
      cursor:pointer;
    }
    .arac-bilgi-btn-cancel:hover{
      background:#bbb;
    }

    /* Ortak panel */
    .panel{
      background:#fff;
      border:1px solid #cfcfcf;
      border-radius:6px;
      overflow:hidden;
      min-height:0;
      box-shadow:0 0 0 1px rgba(0,0,0,.02) inset;
    }
    .title{
      height:28px;
      background:#1e3a8a;
      color:#fff;
      font-weight:800;
      font-size:12px;
      display:flex;
      align-items:center;
      justify-content:center;
      letter-spacing:.3px;
    }

    /* Placeholder çizgiler */
    .sheet{height:calc(100% - 28px)}
    .lines-white{
      background:repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0) 0px,
        rgba(0,0,0,0) 20px,
        rgba(0,0,0,.08) 20px,
        rgba(0,0,0,.08) 21px
      );
    }
    .lines-cream{
      background:repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0) 0px,
        rgba(0,0,0,0) 18px,
        rgba(0,0,0,.10) 18px,
        rgba(0,0,0,.10) 19px
      );
    }
    .cream{background:#d7cba9}

    /* Sağ taraf: kesin grid */
    .rightColumn{
      height:100%;
      min-height:0;
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 600px 20px 25px 1fr;
      grid-template-areas:
        "tahsilat odeme"
        "tahTotal odemeTotal"
        "genel    genel"
        "limits   limits";
      gap:5px;
    }

    /* Sağ üst tablolar */
    #p-tahsilat{grid-area:tahsilat}
    #p-odeme{grid-area:odeme}

    /* TAHSİLAT ve ÖDEME tabloları */
    .tahsilat-table-container, .odeme-table-container{
      height:100%;
      overflow-y:auto;
      overflow-x:hidden;
    }
    .tahsilat-table, .odeme-table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    .tahsilat-table thead, .odeme-table thead{
      position:sticky;
      top:0;
      z-index:10;
      background:#1e3a8a;
    }
    .tahsilat-table th, .odeme-table th{
      background:#1e3a8a;
      color:#fff;
      padding:6px 4px;
      text-align:center;
      font-weight:700;
      font-size:11px;
      border:1px solid rgba(255,255,255,.2);
    }
    .tahsilat-table th:nth-child(3), .tahsilat-table td:nth-child(3){
      width:80px;
      min-width:80px;
      max-width:80px;
    }
    /* Ödeme tablosu AÇIKLAMA sütunu genişliği */
    .odeme-table th:nth-child(1), .odeme-table td:nth-child(1){
      min-width:150px;
      width:auto;
    }
    .tahsilat-table td, .odeme-table td{
      padding:4px;
      border:1px solid rgba(0,0,0,.1);
      text-align:left;
      background:#fff;
    }
    .tahsilat-table td:nth-child(2), .odeme-table td:nth-child(2){
      text-align:right;
    }
    .tahsilat-table td:nth-child(3), .odeme-table td:nth-child(3){
      text-align:center;
    }
    .tahsilat-table input, .odeme-table input{
      width:100%;
      border:none;
      background:transparent;
      padding:2px 4px;
      font-size:11px;
      box-sizing:border-box;
    }
    .tahsilat-table td:nth-child(2) input, .odeme-table td:nth-child(2) input{
      text-align:right;
    }
    .tahsilat-table input:focus, .odeme-table input:focus{
      outline:none;
      background:#f0f4ff;
    }
    .tahsilat-table tbody tr:nth-child(even), .odeme-table tbody tr:nth-child(even){
      background:#f9f9f9;
    }
    .tahsilat-table tbody tr:hover, .odeme-table tbody tr:hover{
      background:#f0f4ff;
    }
    .tahsilat-table tbody tr.aktif{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .tahsilat-table tbody tr.aktif:hover{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .tahsilat-table tbody tr.aktif td{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .tahsilat-table tbody tr.aktif td input{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .tahsilat-table tbody tr.aktif:hover td{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .tahsilat-table tbody tr.aktif:hover td input{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif:hover{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif td{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif td input{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif:hover td{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .odeme-table tbody tr.aktif:hover td input{
      background:#dc3545 !important;
      color:#fff !important;
    }
    .tahsilat-table td.onay-cell, .odeme-table td.onay-cell{
      position:relative;
      padding:0 !important;
      text-align:center;
      width:80px;
      min-width:80px;
      max-width:80px;
    }
    /* Onay butonları kaldırıldı */

    /* HYPCO ve AYGAZ tabloları */
    .hypco-table-container, .aygaz-table-container{
      height:100%;
      overflow-y:auto;
      overflow-x:hidden;
    }
    .hypco-table, .aygaz-table{
      width:100%;
      border-collapse:collapse;
      font-size:11px;
    }
    .hypco-table thead, .aygaz-table thead{
      position:sticky;
      top:0;
      z-index:10;
      background:#1e3a8a;
    }
    .hypco-table th, .aygaz-table th{
      background:#1e3a8a;
      color:#fff;
      padding:6px 4px;
      text-align:center;
      font-weight:700;
      font-size:11px;
      border:1px solid rgba(255,255,255,.2);
    }
    .hypco-table td, .aygaz-table td{
      padding:4px;
      border:1px solid rgba(0,0,0,.1);
      text-align:left;
      background:#fff;
    }
    .hypco-table td:nth-child(2), .hypco-table td:nth-child(3), .hypco-table td:nth-child(4),
    .aygaz-table td:nth-child(2), .aygaz-table td:nth-child(3), .aygaz-table td:nth-child(4){
      text-align:right;
    }
    .hypco-table input, .aygaz-table input{
      width:100%;
      border:none;
      background:transparent;
      padding:2px 4px;
      font-size:11px;
      box-sizing:border-box;
    }
    .hypco-table input:focus, .aygaz-table input:focus{
      outline:none;
      background:#f0f4ff;
    }
    .hypco-table tbody tr:nth-child(even), .aygaz-table tbody tr:nth-child(even){
      background:#f9f9f9;
    }
    .hypco-table tbody tr:hover, .aygaz-table tbody tr:hover{
      background:#f0f4ff;
    }


    /* Yeşil barlar */
    .totalBar{
      background:#1fa34a;
      color:#fff;
      font-weight:900;
      border-radius:6px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:22px;
    }
    #tahTotal{grid-area:tahTotal}
    #odemeTotal{
      grid-area:odemeTotal;
      background:#dc3545 !important;
    }
    #odemeTotal:hover{
      background:#c82333 !important;
    }
    #genelTotal{
      grid-area:genel;
      background:#1fa34a !important;
    }
    #genelTotal:hover{
      background:#1fa34a !important;
    }

    /* Alt limitler (HYPCO + AYGAZ yan yana) */
    .limitsRow{
      grid-area:limits;
      min-height:0;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .limitsRow .panel{min-height:0;height:150px}

    /* Araçlar 2x10 (20 kart) */
    .carsGrid{
      min-height:2150px;
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(10, 210px);
      gap:10px;
    }
    .carCard .title{height:24px;font-size:11px}
    .carCard .sheet{height:calc(100% - 24px);min-height:186px}
    .carCard{min-height:210px}

    /* Entry biraz daha çizgili his */
    .entry .sheet{background:repeating-linear-gradient(to bottom,#0000 0 16px, rgba(0,0,0,.08) 16px 17px)}
    
    /* YAKIT ALIMLARI Tablo Stilleri */
    .entry{ position:relative; }
    .entry .alis-fiyati-btn{
      position:absolute;
      top:5px;
      left:5px;
      z-index:100;
      padding:6px 12px;
      background:#1e3a8a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:11px;
      font-weight:700;
      cursor:pointer;
    }
    .entry .alis-fiyati-btn:hover{
      background:#1e5a9a;
    }
    .entry-title-container{
      display:flex;
      justify-content:space-between;
      align-items:center;
      position:relative;
    }
    .entry-title-container .title{
      flex:1;
      margin:0;
    }
    .entry .otomatik-yakit-al-btn{
      padding:6px 12px;
      background:#1fa34a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:11px;
      font-weight:700;
      cursor:pointer;
      margin-right:5px;
    }
    .entry .otomatik-yakit-al-btn:hover{
      background:#1d8f3f;
    }
    .entry .yakit-temizle-btn{
      padding:6px 12px;
      background:#dc2626;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:11px;
      font-weight:700;
      cursor:pointer;
      margin-right:5px;
    }
    .entry .yakit-temizle-btn:hover{
      background:#b91c1c;
    }
    .entry .sheet{ background:none !important; padding:0 !important; height:410px; }
    .entry .yakit-table-container{
      height:100%;
      overflow-y:auto;
      overflow-x:auto;
    }
    .yakit-table{ 
      width:100%; 
      border-collapse:separate; 
      border-spacing:0; 
      table-layout:fixed; 
      border:1px solid rgba(0,0,0,.15); 
    }
    .yakit-table th,.yakit-table td{ 
      text-align:center; 
      font-size:11px; 
      border-right:1px solid rgba(0,0,0,.08); 
      border-bottom:1px solid rgba(0,0,0,.08); 
    }
    .yakit-table thead th{ 
      height:28px; 
      background:#1e3a8a; 
      color:#fff; 
      font-weight:800; 
      position:sticky; 
      top:0; 
      z-index:10; 
      border-bottom:1px solid rgba(0,0,0,.15); 
      border-right:1px solid rgba(0,0,0,.15); 
    }
    .yakit-table thead th:last-child{ border-right:none; }
    .yakit-table tbody tr{ }
    .yakit-table tbody td{ 
      height:24px; 
      background:#fff; 
    }
    .yakit-table tbody td:last-child{ border-right:none; }
    .yakit-table .odemetur-header{
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      height:100%;
      line-height:1.2;
    }
    .yakit-table .odemetur-header span:first-child{
      margin-bottom:2px;
    }
    
    /* FİRMA dropdown stilleri */
    .yakit-table tbody td.firma-cell{
      position:relative;
      cursor:pointer;
      padding:0;
    }
    .yakit-table tbody td.firma-cell:hover{
      background-color:#f0f0f0;
    }
    .yakit-table .firma-dropdown{
      position:absolute;
      top:100%;
      left:0;
      right:0;
      background:#fff;
      border:1px solid rgba(0,0,0,.2);
      border-top:none;
      box-shadow:0 2px 4px rgba(0,0,0,.1);
      z-index:1000;
      max-height:200px;
      overflow-y:auto;
      display:none;
    }
    .yakit-table .firma-dropdown.show{
      display:block;
    }
    .yakit-table .firma-option{
      padding:6px 8px;
      cursor:pointer;
      font-size:11px;
      border-bottom:1px solid rgba(0,0,0,.05);
    }
    .yakit-table .firma-option:hover{
      background-color:#1e3a8a;
      color:#fff;
    }
    .yakit-table .firma-option:last-child{
      border-bottom:none;
    }
    .yakit-table .firma-value{
      display:block;
      width:100%;
      height:100%;
      padding:2px 4px;
      text-align:center;
    }
    
    /* ÜRÜN dropdown stilleri */
    .yakit-table tbody td.urun-cell{
      position:relative;
      cursor:pointer;
      padding:0;
    }
    .yakit-table tbody td.urun-cell:hover{
      background-color:#f0f0f0;
    }
    .yakit-table .urun-dropdown{
      position:absolute;
      top:100%;
      left:0;
      right:0;
      background:#fff;
      border:1px solid rgba(0,0,0,.2);
      border-top:none;
      box-shadow:0 2px 4px rgba(0,0,0,.1);
      z-index:1000;
      display:none;
    }
    .yakit-table .urun-dropdown.show{
      display:block;
    }
    .yakit-table .urun-option{
      padding:6px 8px;
      cursor:pointer;
      font-size:11px;
      border-bottom:1px solid rgba(0,0,0,.05);
    }
    .yakit-table .urun-option:hover{
      background-color:#1e3a8a;
      color:#fff;
    }
    .yakit-table .urun-option:last-child{
      border-bottom:none;
    }
    .yakit-table .urun-value{
      display:block;
      width:100%;
      height:100%;
      padding:2px 4px;
      text-align:center;
    }
    
    /* ÖDEME TÜR dropdown stilleri */
    .yakit-table tbody td.odeme-tur-cell{
      position:relative;
      cursor:pointer;
      padding:0;
    }
    .yakit-table tbody td.odeme-tur-cell:hover{
      background-color:#f0f0f0;
    }
    .yakit-table .odeme-tur-dropdown{
      position:absolute;
      top:100%;
      left:0;
      right:0;
      background:#fff;
      border:1px solid rgba(0,0,0,.2);
      border-top:none;
      box-shadow:0 2px 4px rgba(0,0,0,.1);
      z-index:1000;
      max-height:200px;
      overflow-y:auto;
      display:none;
    }
    .yakit-table .odeme-tur-dropdown.show{
      display:block;
    }
    .yakit-table .odeme-tur-option{
      padding:6px 8px;
      cursor:pointer;
      font-size:11px;
      border-bottom:1px solid rgba(0,0,0,.05);
    }
    .yakit-table .odeme-tur-option:hover{
      background-color:#1e3a8a;
      color:#fff;
    }
    .yakit-table .odeme-tur-option:last-child{
      border-bottom:none;
    }
    .yakit-table .odeme-tur-value{
      display:block;
      width:100%;
      height:100%;
      padding:2px 4px;
      text-align:center;
    }
    /* YAKIT ALIMLARI ONAY butonu */
    .yakit-table tbody td.onay-cell{
      position:relative;
      padding:0 !important;
      text-align:center;
    }
    /* Yakıt onay butonları kaldırıldı */
    /* YAKIT ALIMLARI - ONAYLI satır stilleri */
    .yakit-table tbody tr.aktif{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif:hover{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif td{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif td input{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif td span{
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif:hover td{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif:hover td input{
      background:#1fa34a !important;
      color:#fff !important;
    }
    .yakit-table tbody tr.aktif:hover td span{
      color:#fff !important;
    }
    
    /* LİTRE input stilleri */
    .yakit-table tbody td.litre-cell{
      padding:0;
    }
    .yakit-table .litre-input{
      width:100%;
      height:100%;
      border:none;
      padding:2px 4px;
      text-align:center;
      font-size:11px;
      background:transparent;
      box-sizing:border-box;
    }
    .yakit-table .litre-input:focus{
      outline:none;
      background-color:#f0f8ff;
    }
    
    /* TL input stilleri */
    .yakit-table tbody td.tl-cell{
      padding:0;
    }
    .yakit-table .tl-input{
      width:100%;
      height:100%;
      border:none;
      padding:2px 4px;
      text-align:center;
      font-size:11px;
      background:#f5f5f5;
      box-sizing:border-box;
      cursor:not-allowed;
    }

    /* ALIŞ FİYATLARI Modal Stilleri */
    .alis-fiyati-modal{
      display:none;
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.5);
      z-index:10000;
      justify-content:center;
      align-items:center;
    }
    .alis-fiyati-modal.show{
      display:flex;
    }
    .alis-fiyati-modal-content{
      background:#fff;
      border-radius:8px;
      padding:20px;
      max-width:600px;
      width:90%;
      max-height:80vh;
      overflow-y:auto;
      box-shadow:0 4px 20px rgba(0,0,0,0.3);
    }
    .alis-fiyati-modal-header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:20px;
      padding-bottom:10px;
      border-bottom:2px solid #1e3a8a;
    }
    .alis-fiyati-modal-header h2{
      margin:0;
      color:#1e3a8a;
      font-size:18px;
      font-weight:800;
    }
    .alis-fiyati-modal-close{
      background:none;
      border:none;
      font-size:24px;
      cursor:pointer;
      color:#666;
      padding:0;
      width:30px;
      height:30px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .alis-fiyati-modal-close:hover{
      color:#000;
    }
    .alis-fiyati-table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }
    .alis-fiyati-table th{
      background:#1e3a8a;
      color:#fff;
      padding:10px;
      text-align:center;
      font-weight:800;
      font-size:12px;
      border:1px solid rgba(255,255,255,0.2);
    }
    .alis-fiyati-table td{
      padding:8px;
      text-align:center;
      border:1px solid rgba(0,0,0,0.1);
      background:#fff;
    }
    .alis-fiyati-table tbody tr:nth-child(even){
      background:#f9f9f9;
    }
    .alis-fiyati-table tbody tr:hover{
      background:#f0f0f0;
    }
    .alis-fiyati-input{
      width:100%;
      padding:6px;
      border:1px solid #ddd;
      border-radius:4px;
      text-align:center;
      font-size:12px;
    }
    .alis-fiyati-input:focus{
      outline:none;
      border-color:#1e3a8a;
      box-shadow:0 0 0 2px rgba(30,58,138,0.1);
    }
    .alis-fiyati-save-btn{
      margin-top:20px;
      padding:10px 20px;
      background:#1e3a8a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      width:100%;
    }
    .alis-fiyati-save-btn:hover{
      background:#1e5a9a;
    }

    /* MTR SOL Tablo Stilleri */
    .mtr1{ position:relative; }
    .mtr1 .stok-giris-btn{
      position:absolute;
      top:5px;
      left:5px;
      z-index:100;
      padding:6px 12px;
      background:#1e3a8a;
      color:#fff;
      border:none;
      border-radius:4px;
      font-size:11px;
      font-weight:700;
      cursor:pointer;
    }
    .mtr1 .stok-giris-btn:hover{
      background:#1e5a9a;
    }
    .mtr1 .sheet{ background:none !important; padding:0 !important; height:420px; }
    .mtr1 .mtr-vertical-scroll{
      height:100%;
      overflow-y:auto;
      overflow-x:hidden;
    }
    .mtr1 .mtr-table{ width:100%; }
    .mtr-table{ border-collapse:separate; border-spacing:0; table-layout:fixed; border:1px solid rgba(0,0,0,.15); }
    .mtr-table th,.mtr-table td{ text-align:center; font-size:11px; border-right:1px solid rgba(0,0,0,.08); border-bottom:1px solid rgba(0,0,0,.08); }
    .mtr-table thead th{ height:28px; background:#1e3a8a; color:#fff; font-weight:800; position:sticky; top:0; z-index:10; border-bottom:1px solid rgba(0,0,0,.15); border-right:none; }
    .mtr-table thead th:last-child{ border-right:none; }
    .mtr-table tbody tr{ }
    .mtr-table tbody td{ height:24px; background:#fff; }
    .mtr-table tbody td:last-child{ border-right:none; }
    .mtr-table .rowhdr{ border-right:1px solid rgba(0,0,0,.15) !important; background:#1e3a8a !important; color:#fff; font-weight:800; text-align:left; padding-left:8px; min-width:110px; width:110px; }
    /* Tarih hücreleri buton gibi (3. tarih satırından itibaren - 7. satırdan itibaren) */
    .mtr-table tbody tr:nth-child(n+7) td.rowhdr {
      cursor: pointer;
      transition: background-color 0.2s ease, opacity 0.2s ease;
    }
    .mtr-table tbody tr:nth-child(n+7) td.rowhdr:hover {
      background-color: #2e5aaa !important;
      opacity: 0.9;
    }
    .mtr-table tbody tr:nth-child(n+7) td.rowhdr:active {
      background-color: #3e6aba !important;
      opacity: 0.8;
    }
    /* Seçili tarih hücresi */
    .mtr-table tbody tr td.rowhdr.selected {
      background-color: #4a90e2 !important;
      box-shadow: inset 0 0 0 2px rgba(255,255,255,0.3);
    }
    /* TARİH satırındaki şube adları (alt başlık gibi) */
    .mtr-table tbody tr.sticky-row td:not(.rowhdr){ background:#1e3a8a; color:#fff; font-weight:800; }
    /* İlk 4 satırı sabit yap (KAPASİTE, ANLIK, SATIŞ, TARİH) - İlk tarih satırı sabit değil */
    .mtr-table tbody tr:nth-child(1){ position:sticky; top:28px; z-index:9; }
    .mtr-table tbody tr:nth-child(1) td{ background:#fff; }
    .mtr-table tbody tr:nth-child(1) td.rowhdr{ background:#1e3a8a !important; border-right:1px solid rgba(0,0,0,.15) !important; }
    .mtr-table tbody tr:nth-child(2){ position:sticky; top:52px; z-index:9; }
    .mtr-table tbody tr:nth-child(2) td{ background:#fff; }
    .mtr-table tbody tr:nth-child(2) td.rowhdr{ background:#1e3a8a !important; border-right:1px solid rgba(0,0,0,.15) !important; }
    .mtr-table tbody tr:nth-child(3){ position:sticky; top:76px; z-index:9; }
    .mtr-table tbody tr:nth-child(3) td{ background:#fff; }
    .mtr-table tbody tr:nth-child(3) td.rowhdr{ background:#1e3a8a !important; border-right:1px solid rgba(0,0,0,.15) !important; }
    .mtr-table tbody tr:nth-child(4){ position:sticky; top:100px; z-index:9; }
    .mtr-table tbody tr:nth-child(4) td{ background:#fff; }
    .mtr-table tbody tr:nth-child(4) td.rowhdr{ background:#1e3a8a !important; border-right:1px solid rgba(0,0,0,.15) !important; }
    .mtr-table .mtr-head{ padding-left:13px; padding-right:13px; letter-spacing:.3px; }  /* %30 daha geniş hissi */
    .mtr-table tbody td:not(.rowhdr){ padding-left:10px; padding-right:10px; }
    .mtr1 .cell-inp, .mtr2 .cell-inp{
      width:100%;
      height:100%;
      border:none;
      outline:0;
      background:transparent;
      text-align:center;
      font:inherit;
      padding:2px;
      box-sizing:border-box;
    }
    .mtr1 .cell-inp:focus, .mtr2 .cell-inp:focus{
      background:#f0f4ff;
    }
    /* Tarih satırlarındaki veri giriş hücreleri - 6000'den küçükse koyu kırmızı */
    .mtr-table tbody tr td:not(.rowhdr) input.cell-inp.warning {
      background-color: #dc3545 !important;
      color: #fff !important;
      font-weight: 700;
    }
    .mtr-table tbody tr td:not(.rowhdr) input.cell-inp.warning:focus {
      background-color: #dc3545 !important;
      color: #fff !important;
    }
    /* Tarih satırlarındaki veri giriş hücreleri - 6000 ve üzeri yeşil */
    .mtr-table tbody tr td:not(.rowhdr) input.cell-inp.success {
      background-color: #1fa34a !important;
      color: #fff !important;
      font-weight: 700;
    }
    .mtr-table tbody tr td:not(.rowhdr) input.cell-inp.success:focus {
      background-color: #1fa34a !important;
      color: #fff !important;
    }
    /* YAĞCILAR sütunu aktif buton stili */
    .mtr-table tbody tr td:not(.rowhdr) input.cell-inp.cell-button-active {
      background-color: #3b82f6 !important;
      color: #fff !important;
      font-weight: 700;
      cursor: pointer;
    }
    /* MTR SAĞ (BENZİN) Tablo Stilleri */
    .mtr2 .sheet{ background:none !important; padding:0 !important; height:420px; }
    .mtr2 .mtr-vertical-scroll{
      height:100%;
      overflow-y:auto;
      overflow-x:hidden;
    }
    .mtr2 .mtr-table{ width:100%; }
  </style>
  
  <!-- Telerik Kendo UI CSS -->
  <link rel="stylesheet" href="{% static 'dashboard/kendo/styles/default-main.css' %}" />
  
  <!-- jQuery (Telerik için gerekli) -->
  <script src="{% static 'dashboard/js/jquery-3.6.0.min.js' %}"></script>
  
  <!-- Telerik Kendo UI JavaScript (Tüm bileşenler) -->
  <script src="{% static 'dashboard/js/kendo.all.min.js' %}"></script>
  
  <!-- Telerik Lisans -->
  {% if kendo_license %}
  <script src="{% static 'dashboard/kendo/telerik-license.js' %}"></script>
  <script>
    if (typeof KendoLicensing !== 'undefined' && KendoLicensing.setScriptKey) {
      KendoLicensing.setScriptKey("{{ kendo_license|escapejs }}");
    }
  </script>
  {% endif %}
</head>

<body>
  <div id="scale-root">
    <div class="wrap">

      <!-- MTR SOL -->
      <div class="panel mtr1">
        <div style="display:flex; gap:5px; margin-bottom:5px;">
          <a href="/" style="padding:6px 12px; background:#1e3a8a; color:#fff; text-decoration:none; border-radius:4px; font-size:11px; font-weight:700;">← Ana Sayfaya Dön</a>
        </div>
        <div class="title">MOTORİN - Telerik Grid (Sıralama, Filtreleme, Sayfalama Aktif)</div>
        <div class="sheet">
          <div class="mtr-vertical-scroll" id="motorin-telerik-grid-container" style="height:420px;">
            <!-- Telerik Grid buraya eklenecek -->
          </div>
          <!-- Eski tablo kaldırıldı, Telerik Grid kullanılıyor -->
          </div>
        </div>
      </div>

      <!-- MTR SAĞ -->
      <div class="panel mtr2">
        <div class="title">BENZİN</div>
        <div class="sheet">
          <div class="mtr-vertical-scroll">
            <table class="mtr-table">
              <thead>
                <tr>
                  <th class="rowhdr">MTR</th>
                  <th class="mtr-head">YAĞCILAR</th>
                  <th class="mtr-head">TEPEKUM</th>
                  <th class="mtr-head">NAMDAR</th>
                  <th class="mtr-head">ŞEKER</th>
                  <th class="mtr-head">AKOVA</th>
                  <th class="mtr-head">KOOP.</th>
                  <th class="mtr-head">NAZİLLİ</th>
                </tr>
              </thead>
              <tbody>
                <tr class="fixed-row"><td class="rowhdr">KAPASİTE</td><td>20.000</td><td>10.000</td><td>9.000</td><td>20.000</td><td>10.000</td><td>20.000</td><td>15.000</td></tr>
                <tr><td class="rowhdr">ANLIK</td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr">SATIŞ</td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="YAGCILAR" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="TEPEKUM" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="NAMDAR" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="SEKER" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="AKOVA" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="KOOP" data-table="benzin" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" data-sube="NAZILLI" data-table="benzin" /></td></tr>
                <tr class="sticky-row sticky-row-4"><td class="rowhdr">TARİH</td><td>YAĞCILAR</td><td>TEPEKUM</td><td>NAMDAR</td><td>ŞEKER</td><td>AKOVA</td><td>KOOP.</td><td>NAZİLLİ</td></tr>
                <tr><td class="rowhdr">Perşembe</td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr">Cuma</td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr">Cumartesi</td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
                <tr><td class="rowhdr"></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td><td data-persist="1"><input class="cell-inp" type="text" inputmode="numeric" /></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- SAĞ BLOK -->
      <div class="right">
        <div class="rightColumn">

          <div class="panel" id="p-tahsilat">
            <div style="display:flex;justify-content:space-between;align-items:center;position:relative;">
              <div class="title" style="flex:1;">TAHSİLAT</div>
            </div>
            <div class="sheet lines-white">
              <div class="tahsilat-table-container">
                <table class="tahsilat-table">
                  <thead>
                    <tr>
                      <th>AÇIKLAMA</th>
                      <th>TL</th>
                      <th>ONAY</th>
                    </tr>
                  </thead>
                  <tbody id="tahsilat-tbody">
                    <!-- 35 satır JavaScript ile eklenecek -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="panel" id="p-odeme">
            <div style="display:flex;justify-content:space-between;align-items:center;position:relative;">
              <div class="title" style="flex:1;">ÖDEME</div>
            </div>
            <div class="sheet lines-white">
              <div class="odeme-table-container">
                <table class="odeme-table">
                  <thead>
                    <tr>
                      <th>AÇIKLAMA</th>
                      <th>TL</th>
                      <th>ONAY</th>
                    </tr>
                  </thead>
                  <tbody id="odeme-tbody">
                    <!-- 35 satır JavaScript ile eklenecek -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="totalBar" id="tahTotal">₺2.472.000</div>
          <div class="totalBar" id="odemeTotal">₺1.091.000</div>
          <div class="totalBar" id="genelTotal">₺1.381.000</div>

          <div class="limitsRow">
            <div class="panel" id="p-hypco">
              <div class="title">HYPCO</div>
              <div class="sheet lines-white">
                <div class="hypco-table-container">
                  <table class="hypco-table">
                    <thead>
                      <tr>
                        <th>Firma</th>
                        <th>Nakit Limit</th>
                        <th>DBS Limit</th>
                        <th>Top. Borç</th>
                      </tr>
                    </thead>
                    <tbody id="hypco-tbody">
                      <!-- 3 satır JavaScript ile eklenecek -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="panel" id="p-aygaz">
              <div class="title">AYGAZ</div>
              <div class="sheet lines-white">
                <div class="aygaz-table-container">
                  <table class="aygaz-table">
                    <thead>
                      <tr>
                        <th>Firma</th>
                        <th>Nakit Limit</th>
                        <th>DBS Limit</th>
                        <th>Top. Borç</th>
                      </tr>
                    </thead>
                    <tbody id="aygaz-tbody">
                      <!-- 3 satır JavaScript ile eklenecek -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- ENTRY -->
      <div class="panel entry">
        <div class="entry-title-container">
          <div class="title">YAKIT ALIMLARI</div>
        </div>
        <div class="sheet">
          <div class="yakit-table-container">
            <table class="yakit-table">
              <thead>
                <tr>
                  <th>FİRMA</th>
                  <th>ÜRÜN</th>
                  <th>LİTRE</th>
                  <th>TL</th>
                  <th>
                    <div class="odemetur-header">
                      <span>ÖDEME</span>
                      <span>TÜR</span>
                    </div>
                  </th>
                  <th>ONAY</th>
                </tr>
              </thead>
              <tbody>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
                <tr><td></td><td></td><td></td><td></td><td></td><td></td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- CARS -->
      <div class="cars">
        <div class="panel">
          <div class="title-container">
            <div class="title">NAKLİYE</div>
          </div>
          <div class="carsGrid">
          <div class="panel carCard"><div class="title">1 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">2 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">3 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">4 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">5 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">6 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">7 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">8 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">9 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">10 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">11 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">12 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">13 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">14 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">15 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">16 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">17 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">18 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">19 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          <div class="panel carCard"><div class="title">20 ARAÇ</div><div class="sheet" style="overflow:auto;background:#fff;">
            <table style="width:100%;border-collapse:collapse;table-layout:fixed;font-size:10px;">
              <thead style="position:sticky;top:0;z-index:10;background:#1e3a8a;">
                <tr>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">A</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">B</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">C</th>
                  <th style="width:25%;background:#1e3a8a;color:#fff;padding:2px;border:1px solid rgba(0,0,0,.1);">D</th>
                </tr>
              </thead>
              <tbody>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#fff;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
                <tr style="background:#f5f5f5;"><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td><td contenteditable="true" style="padding:2px;border:1px solid rgba(0,0,0,.1);"></td></tr>
              </tbody>
            </table>
          </div></div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- Arac Bilgi Modal -->
  <div class="arac-bilgi-modal" id="arac-bilgi-modal">
    <div class="arac-bilgi-modal-content">
      <div class="arac-bilgi-modal-header">
        <h2>Araç Kart Bilgi</h2>
      </div>
      <form id="arac-bilgi-form">
        <div class="arac-bilgi-table-container">
          <table class="arac-bilgi-table">
            <thead>
              <tr>
                <th style="width:50px;">Sıra</th>
                <th style="width:120px;">Firma</th>
                <th style="width:120px;">Şoför</th>
                <th style="width:100px;">T.C</th>
                <th style="width:100px;">Dorse</th>
                <th style="width:100px;">Çekici</th>
                <th style="width:80px;">1. Göz</th>
                <th style="width:80px;">2. Göz</th>
                <th style="width:80px;">3. Göz</th>
                <th style="width:80px;">4. Göz</th>
                <th style="width:80px;">5. Göz</th>
                <th style="width:80px;">6. Göz</th>
                <th style="width:100px;">Toplam Litre</th>
                <th style="width:120px;">Taşıma Sınırı Lt</th>
              </tr>
            </thead>
            <tbody id="arac-bilgi-tbody">
              <!-- 20 satır JavaScript ile eklenecek -->
            </tbody>
          </table>
        </div>
        <div class="arac-bilgi-modal-actions">
        </div>
      </form>
    </div>
  </div>

  <!-- Tahsilat Açıklama Modal -->
  <div class="tahsilat-aciklama-modal" id="tahsilat-aciklama-modal">
    <div class="tahsilat-aciklama-modal-content">
      <div class="tahsilat-aciklama-modal-header">
        <h2>Açıklama Seçenekleri</h2>
      </div>
      <div class="tahsilat-aciklama-modal-body">
        <div style="margin-bottom:15px;font-size:12px;color:#666;">Aşağıdaki 15 satıra yazdığınız değerler, Tahsilat tablosundaki AÇIKLAMA hücrelerinde seçim olarak görünecektir.</div>
        <div id="tahsilat-aciklama-inputs">
          <!-- 20 satır JavaScript ile eklenecek -->
        </div>
      </div>
      <div class="tahsilat-aciklama-modal-actions">
      </div>
    </div>
  </div>

  <div class="odeme-aciklama-modal" id="odeme-aciklama-modal">
    <div class="odeme-aciklama-modal-content">
      <div class="odeme-aciklama-modal-header">
        <h2>Açıklama Seçenekleri</h2>
      </div>
      <div class="odeme-aciklama-modal-body">
        <div style="margin-bottom:15px;font-size:12px;color:#666;">Aşağıdaki 15 satıra yazdığınız değerler, Ödeme tablosundaki AÇIKLAMA hücrelerinde seçim olarak görünecektir.</div>
        <div id="odeme-aciklama-inputs">
          <!-- 20 satır JavaScript ile eklenecek -->
        </div>
      </div>
      <div class="odeme-aciklama-modal-actions">
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function() {
      
      const table = document.querySelector(".mtr1 .mtr-table");
      if (!table) return;
      const rows = Array.from(table.querySelectorAll("tbody tr"));
      const theadRow = table.querySelector("thead tr");
      const headers = Array.from(theadRow.querySelectorAll("th"));
      
      // Şube sütunlarının listesi
      const subeListesi = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
      
      // Her şube için indeks bul
      const subeIndeksleri = {};
      subeListesi.forEach(sube => {
        const idx = headers.findIndex(h => (h.textContent || "").trim() === sube);
        if (idx >= 0) {
          subeIndeksleri[sube] = idx;
        }
      });
      
      if (Object.keys(subeIndeksleri).length === 0) return;
      
      // Satırları bul
      const idxKapasite = rows.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "KAPASİTE");
      const idxAnlik = rows.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "ANLIK");
      const idxTarih = rows.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "TARİH");
      
      if (idxKapasite < 0 || idxAnlik < 0 || idxTarih < 0) return;
      
      // Sayıya çevir (nokta binlik ayırıcı)
      const parseNum = (str) => {
        if (!str || str.trim() === "") return null;
        return parseFloat(str.replace(/\./g, "").replace(",", ".")) || null;
      };
      
      // Tarih satırlarındaki input'ları kontrol et (6000'den küçükse kırmızı)
      const kontrolTarihSatirlariUyari = () => {
        // Tarih satırlarından itibaren tüm satırları kontrol et
        for (let i = idxTarih + 1; i < rows.length; i++) {
          if (rows[i].classList.contains("fixed-row")) continue;
          
          const cells = Array.from(rows[i].querySelectorAll("td"));
          cells.forEach((cell, colIdx) => {
            // Tarih hücresini (rowhdr) atla, sadece veri girişi hücrelerini kontrol et
            if (cell.classList.contains("rowhdr")) return;
            
            const input = cell.querySelector("input.cell-inp");
            if (input) {
              const deger = parseNum(input.value);
              // Tüm class'ları temizle
              input.classList.remove("warning", "success");
              // Boş hücreler normal renkte olmalı
              if (deger === null || input.value.trim() === "") {
                // Normal, class yok
              } else if (deger < 6000) {
                input.classList.add("warning");  // Koyu kırmızı
              } else if (deger >= 6000) {
                input.classList.add("success");  // Yeşil
              }
            }
          });
        }
      };
      
      // Sayıyı formatla (binlik ayırıcı ile)
      const formatNum = (num) => {
        if (num === null || isNaN(num)) return "";
        const parts = num.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        return parts.join(".");
      };
      
      // Belirli bir sütun için ANLIK hesapla
      const hesaplaAnlikSutun = (sutunIdx) => {
        const kapasiteRow = rows[idxKapasite];
        const anlikRow = rows[idxAnlik];
        const ilkGunRow = rows[idxTarih + 1];
        
        if (!kapasiteRow || !anlikRow || !ilkGunRow) return;
        
        const kapasiteCell = kapasiteRow.querySelectorAll("td")[sutunIdx];
        const anlikCell = anlikRow.querySelectorAll("td")[sutunIdx];
        const ilkGunCell = ilkGunRow.querySelectorAll("td")[sutunIdx];
        
        if (!kapasiteCell || !anlikCell || !ilkGunCell) return;
        
        const kapasite = parseNum(kapasiteCell.textContent);
        const ilkGunInput = ilkGunCell.querySelector("input.cell-inp");
        const ilkGunSatis = ilkGunInput ? parseNum(ilkGunInput.value) : null;
        
        if (kapasite === null || ilkGunSatis === null) {
          anlikCell.textContent = "";
          return;
        }
        
        const anlik = kapasite - ilkGunSatis;
        anlikCell.textContent = formatNum(anlik);
      };
      
      // Belirli bir sütun için tüm tarih satırlarını hesapla (SATIŞ satırı değiştiğinde)
      const hesaplaTarihSatirlari = (sutunIdx) => {
        // SATIŞ satırını bul
        const satisRow = rows[idxSatis];
        if (!satisRow) return;
        
        const satisCell = satisRow.querySelectorAll("td")[sutunIdx];
        if (!satisCell) return;
        
        const satisInput = satisCell.querySelector("input.cell-inp");
        if (!satisInput) return;
        
        const satisDegeri = parseNum(satisInput.value);
        if (satisDegeri === null) {
          // SATIŞ değeri yoksa, tüm tarih satırlarını temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const tarihCell = rows[i].querySelectorAll("td")[sutunIdx];
            if (tarihCell && !tarihCell.classList.contains("rowhdr")) {
              const tarihInput = tarihCell.querySelector("input.cell-inp");
              if (tarihInput && i > idxTarih + 1) { // İlk tarih satırını koru
                tarihInput.value = "";
                saveCell(i, sutunIdx, "");
              }
            }
          }
          return;
        }
        
        // İlk tarih satırındaki değeri al (Excel'den gelen veya manuel girilen)
        const ilkGunRow = rows[idxTarih + 1];
        if (!ilkGunRow) return;
        
        const ilkGunCell = ilkGunRow.querySelectorAll("td")[sutunIdx];
        if (!ilkGunCell) return;
        
        const ilkGunInput = ilkGunCell.querySelector("input.cell-inp");
        if (!ilkGunInput) return;
        
        let oncekiDeger = parseNum(ilkGunInput.value);
        if (oncekiDeger === null) {
          // İlk gün değeri yoksa, hesaplama yapma
          return;
        }
        
        // Tüm tarih satırlarını hesapla (ikinci satırdan itibaren)
        for (let i = idxTarih + 2; i < rows.length; i++) {
          if (rows[i].classList.contains("fixed-row")) continue;
          
          const tarihCell = rows[i].querySelectorAll("td")[sutunIdx];
          if (!tarihCell || tarihCell.classList.contains("rowhdr")) continue;
          
          const tarihInput = tarihCell.querySelector("input.cell-inp");
          if (!tarihInput) continue;
          
          // Hesapla: Önceki satır - SATIŞ değeri
          const yeniDeger = oncekiDeger - satisDegeri;
          
          // Eksi değerleri de göster
          const formatted = formatNum(yeniDeger);
          tarihInput.value = formatted;
          
          // Renk kontrolü (6000'den küçükse kırmızı, 6000 ve üzeri yeşil)
          tarihInput.classList.remove("warning", "success");
          if (yeniDeger < 6000) {
            tarihInput.classList.add("warning");  // Koyu kırmızı
          } else if (yeniDeger >= 6000) {
            tarihInput.classList.add("success");  // Yeşil
          }
          
          // Kaydet
          saveCell(i, sutunIdx, formatted);
          
          // Bir sonraki satır için önceki değer olarak kullan
          oncekiDeger = yeniDeger;
        }
      };
      
      // Tüm sütunlar için ANLIK hesapla
      const hesaplaAnlikTum = () => {
        Object.values(subeIndeksleri).forEach(idx => {
          hesaplaAnlikSutun(idx);
        });
      };
      
      // SATIŞ satırı indeksini bul
      const idxSatis = rows.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "SATIŞ");
      
      // Bugünün tarihini formatla (YYYY-MM-DD)
      const getTodayDate = () => {
        const today = new Date();
        const yy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, "0");
        const dd = String(today.getDate()).padStart(2, "0");
        return `${yy}-${mm}-${dd}`;
      };
      
      // API: MOTORİN satış değerini kaydet
      const saveMotorinSatis = async (sube, deger) => {
        try {
          const numValue = parseNum(deger) || 0;
          const response = await fetch('/api/motorin-satis/', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              tarih: getTodayDate(),
              sube: sube,
              deger: numValue
            })
          });
          const data = await response.json();
          if (data.success) {
            console.log('MOTORİN satış kaydedildi:', sube, numValue);
          }
        } catch (error) {
          console.error('MOTORİN satış kaydetme hatası:', error);
        }
      };
      
      // API: MOTORİN satış değerlerini yükle
      const loadMotorinSatis = async () => {
        try {
          const response = await fetch('/api/motorin-satis/');
          const data = await response.json();
          
          // SATIŞ satırındaki input alanlarına değerleri doldur
          if (idxSatis >= 0) {
            const satisRow = rows[idxSatis];
            const inputs = satisRow.querySelectorAll('input.cell-inp[data-sube]');
            inputs.forEach(input => {
              const sube = input.getAttribute('data-sube');
              const deger = data[sube];
              if (deger !== undefined && deger !== null) {
                input.value = formatNum(deger);
              }
            });
          }
        } catch (error) {
          console.error('MOTORİN satış yükleme hatası:', error);
        }
      };
      
      // Hücre değerini kaydet (SATIŞ satırı için API, diğerleri için localStorage)
      const saveCell = (rowIdx, colIdx, value) => {
        // SATIŞ satırı ise API'ye kaydet
        if (rowIdx === idxSatis) {
          const input = rows[rowIdx].querySelectorAll('input.cell-inp')[colIdx - 1];
          if (input) {
            const sube = input.getAttribute('data-sube');
            if (sube) {
              saveMotorinSatis(sube, value);
              return;
            }
          }
        }
        
        // Diğer satırlar için localStorage (geçici)
        const key = `mtr1_sales_${rowIdx}_${colIdx}`;
        if (value && value.trim() !== "") {
          localStorage.setItem(key, value);
        } else {
          localStorage.removeItem(key);
        }
      };
      
      // Hücre değerini geri yükle
      const restoreCell = (rowIdx, colIdx, input) => {
        // SATIŞ satırı için API'den yükle (sayfa yüklendiğinde)
        if (rowIdx === idxSatis) {
          // loadMotorinSatis() çağrılacak
          return;
        }
        
        // Diğer satırlar için localStorage
        const key = `mtr1_sales_${rowIdx}_${colIdx}`;
        const saved = localStorage.getItem(key);
        if (saved !== null) {
          input.value = saved;
        }
      };
      
      // Tarih doldur (ÖNCE)
      let d = new Date();
      const gunAdlari = ["pazar", "pazartesi", "salı", "çarşamba", "perşembe", "cuma", "cumartesi"];
      const fmt = (x) => {
        const dd = String(x.getDate()).padStart(2,"0");
        const mm = String(x.getMonth()+1).padStart(2,"0");
        const gunAdi = gunAdlari[x.getDay()];
        return `${dd}.${mm}.${gunAdi}`;
      };

      for (let i = idxTarih + 1; i < rows.length; i++) {
        if (rows[i].classList.contains("fixed-row")) continue;
        const first = rows[i].querySelector("td");
        if (!first) continue;
        first.textContent = fmt(d);
        d.setDate(d.getDate() + 1);
      }
      
      // localStorage: Tüm satış hücrelerini geri yükle (TARİH'ten SONRA)
      for (let i = idxTarih + 1; i < rows.length; i++) {
        if (rows[i].classList.contains("fixed-row")) continue;
        const cells = Array.from(rows[i].querySelectorAll("td"));
        cells.forEach((cell, colIdx) => {
          if (cell.classList.contains("rowhdr")) return;
          const input = cell.querySelector("input.cell-inp");
          if (input) {
            restoreCell(i, colIdx, input);
          }
        });
      }
      
      // MOTORİN satış değerlerini yükle (API'den)
      loadMotorinSatis().then(() => {
        // ANLIK hesapla (RESTORE'den SONRA)
        hesaplaAnlikTum();
        // Tarih satırları uyarı kontrolü
        kontrolTarihSatirlariUyari();
        
        // Son seçilen tarihi geri yükle
        const lastSelectedRow = localStorage.getItem('mtr1_selected_date_row');
        if (lastSelectedRow) {
          const selectedRowIdx = parseInt(lastSelectedRow);
          // İlk iki tarih satırını atla kontrolü
          if (selectedRowIdx > idxTarih + 1) {
            const selectedRow = rows[selectedRowIdx];
            if (selectedRow) {
              const selectedCell = selectedRow.querySelector("td.rowhdr");
              if (selectedCell) {
                // Tüm tarih hücrelerinden selected class'ını kaldır
                rows.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) {
                    firstCell.classList.remove("selected");
                  }
                });
                
                // Son seçilen tarihi seçili yap
                selectedCell.classList.add("selected");
                
                // Son seçilen tarih ve üstündeki tüm satırlar için localStorage'dan verileri geri yükle
                for (let i = idxTarih + 1; i <= selectedRowIdx; i++) {
                  if (rows[i].classList.contains("fixed-row")) continue;
                  
                  const cells = Array.from(rows[i].querySelectorAll("td"));
                  cells.forEach((cell, colIdx) => {
                    if (cell.classList.contains("rowhdr")) return;
                    
                    const input = cell.querySelector("input.cell-inp");
                    if (input) {
                      const key = `mtr1_sales_${i}_${colIdx}`;
                      const saved = localStorage.getItem(key);
                      if (saved !== null) {
                        input.value = saved;
                        // Uyarı kontrolü
                        const deger = parseNum(saved);
                        input.classList.remove("warning", "success");
                        if (deger !== null) {
                          if (deger < 6000) {
                            input.classList.add("warning");  // Koyu kırmızı
                          } else if (deger >= 6000) {
                            input.classList.add("success");  // Yeşil
                          }
                        }
                      } else {
                        input.value = "";
                        input.classList.remove("warning", "success");
                      }
                    }
                  });
                }
                
                // Son seçilen tarihten sonraki tüm satırlardaki verileri sil
                for (let i = selectedRowIdx + 1; i < rows.length; i++) {
                  if (rows[i].classList.contains("fixed-row")) continue;
                  
                  const cells = Array.from(rows[i].querySelectorAll("td"));
                  cells.forEach((cell, colIdx) => {
                    if (cell.classList.contains("rowhdr")) return;
                    
                    const input = cell.querySelector("input.cell-inp");
                    if (input) {
                      input.value = "";
                      input.classList.remove("warning");
                    }
                  });
                }
                
                // Uyarı kontrolü
                kontrolTarihSatirlariUyari();
                
                console.log("Son seçilen tarih geri yüklendi:", selectedCell.textContent, "Satır:", selectedRowIdx);
              }
            }
          }
        }
        
        // YAĞCILAR sütunu için aktif buton durumunu geri yükle
        const yagcilarColIdx = subeIndeksleri["YAĞCILAR"];
        if (yagcilarColIdx !== undefined) {
          const activeYagcilarRow = localStorage.getItem('mtr1_yagcilar_active_row');
          if (activeYagcilarRow) {
            const activeRowIdx = parseInt(activeYagcilarRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[yagcilarColIdx]) {
                  const activeInput = cells[yagcilarColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // YAĞCILAR sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[yagcilarColIdx]) {
                        const yagcilarInput = rowCells[yagcilarColIdx].querySelector("input.cell-inp");
                        if (yagcilarInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${yagcilarColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              yagcilarInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              yagcilarInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  yagcilarInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  yagcilarInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              yagcilarInput.value = "";
                              yagcilarInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            yagcilarInput.value = "";
                            yagcilarInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("YAĞCILAR aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // TEPEKUM sütunu için aktif buton durumunu geri yükle
        const tepekumColIdx = subeIndeksleri["TEPEKUM"];
        if (tepekumColIdx !== undefined) {
          const activeTepekumRow = localStorage.getItem('mtr1_tepekum_active_row');
          if (activeTepekumRow) {
            const activeRowIdx = parseInt(activeTepekumRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[tepekumColIdx]) {
                  const activeInput = cells[tepekumColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // TEPEKUM sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[tepekumColIdx]) {
                        const tepekumInput = rowCells[tepekumColIdx].querySelector("input.cell-inp");
                        if (tepekumInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${tepekumColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              tepekumInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              tepekumInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  tepekumInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  tepekumInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              tepekumInput.value = "";
                              tepekumInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            tepekumInput.value = "";
                            tepekumInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("TEPEKUM aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR sütunu için aktif buton durumunu geri yükle
        const namdarColIdx = subeIndeksleri["NAMDAR"];
        if (namdarColIdx !== undefined) {
          const activeNamdarRow = localStorage.getItem('mtr1_namdar_active_row');
          if (activeNamdarRow) {
            const activeRowIdx = parseInt(activeNamdarRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[namdarColIdx]) {
                  const activeInput = cells[namdarColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // NAMDAR sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[namdarColIdx]) {
                        const namdarInput = rowCells[namdarColIdx].querySelector("input.cell-inp");
                        if (namdarInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${namdarColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              namdarInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              namdarInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  namdarInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  namdarInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              namdarInput.value = "";
                              namdarInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            namdarInput.value = "";
                            namdarInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("NAMDAR aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // ŞEKER sütunu için aktif buton durumunu geri yükle
        const sekerColIdx = subeIndeksleri["ŞEKER"];
        if (sekerColIdx !== undefined) {
          const activeSekerRow = localStorage.getItem('mtr1_seker_active_row');
          if (activeSekerRow) {
            const activeRowIdx = parseInt(activeSekerRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[sekerColIdx]) {
                  const activeInput = cells[sekerColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // ŞEKER sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[sekerColIdx]) {
                        const sekerInput = rowCells[sekerColIdx].querySelector("input.cell-inp");
                        if (sekerInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${sekerColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              sekerInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              sekerInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  sekerInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  sekerInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              sekerInput.value = "";
                              sekerInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            sekerInput.value = "";
                            sekerInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("ŞEKER aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // AKOVA sütunu için aktif buton durumunu geri yükle
        const akovaColIdx = subeIndeksleri["AKOVA"];
        if (akovaColIdx !== undefined) {
          const activeAkovaRow = localStorage.getItem('mtr1_akova_active_row');
          if (activeAkovaRow) {
            const activeRowIdx = parseInt(activeAkovaRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[akovaColIdx]) {
                  const activeInput = cells[akovaColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // AKOVA sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[akovaColIdx]) {
                        const akovaInput = rowCells[akovaColIdx].querySelector("input.cell-inp");
                        if (akovaInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${akovaColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              akovaInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              akovaInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  akovaInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  akovaInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              akovaInput.value = "";
                              akovaInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            akovaInput.value = "";
                            akovaInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("AKOVA aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // KOOP. sütunu için aktif buton durumunu geri yükle
        const koopColIdx = subeIndeksleri["KOOP."];
        if (koopColIdx !== undefined) {
          const activeKoopRow = localStorage.getItem('mtr1_koop_active_row');
          if (activeKoopRow) {
            const activeRowIdx = parseInt(activeKoopRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[koopColIdx]) {
                  const activeInput = cells[koopColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // KOOP. sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[koopColIdx]) {
                        const koopInput = rowCells[koopColIdx].querySelector("input.cell-inp");
                        if (koopInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${koopColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              koopInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              koopInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  koopInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  koopInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              koopInput.value = "";
                              koopInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            koopInput.value = "";
                            koopInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("KOOP. aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
        
        // NAZİLLİ sütunu için aktif buton durumunu geri yükle
        const nazilliColIdx = subeIndeksleri["NAZİLLİ"];
        if (nazilliColIdx !== undefined) {
          const activeNazilliRow = localStorage.getItem('mtr1_nazilli_active_row');
          if (activeNazilliRow) {
            const activeRowIdx = parseInt(activeNazilliRow);
            if (activeRowIdx > idxTarih + 2) {
              const activeRow = rows[activeRowIdx];
              if (activeRow) {
                const cells = Array.from(activeRow.querySelectorAll("td"));
                if (cells[nazilliColIdx]) {
                  const activeInput = cells[nazilliColIdx].querySelector("input.cell-inp");
                  if (activeInput) {
                    activeInput.classList.add("cell-button-active");
                    
                    // NAZİLLİ sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                    for (let i = idxTarih + 1; i < rows.length; i++) {
                      if (rows[i].classList.contains("fixed-row")) continue;
                      const rowCells = Array.from(rows[i].querySelectorAll("td"));
                      if (rowCells[nazilliColIdx]) {
                        const nazilliInput = rowCells[nazilliColIdx].querySelector("input.cell-inp");
                        if (nazilliInput) {
                          if (i <= activeRowIdx) {
                            // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                            const key = `mtr1_sales_${i}_${nazilliColIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              nazilliInput.value = saved;
                              // Uyarı ve başarı kontrolü
                              const deger = parseNum(saved);
                              nazilliInput.classList.remove("warning", "success");
                              if (deger !== null) {
                                if (deger < 6000) {
                                  nazilliInput.classList.add("warning");  // Koyu kırmızı
                                } else if (deger >= 6000) {
                                  nazilliInput.classList.add("success");  // Yeşil
                                }
                              }
                            } else {
                              nazilliInput.value = "";
                              nazilliInput.classList.remove("warning", "success");
                            }
                          } else {
                            // Aktif hücrenin altındaki hücreler: temizle
                            nazilliInput.value = "";
                            nazilliInput.classList.remove("warning", "success");
                          }
                        }
                      }
                    }
                    
                    console.log("NAZİLLİ aktif buton geri yüklendi - Satır:", activeRowIdx);
                  }
                }
              }
            }
          }
        }
      });
      
      // Tarih hücrelerine tıklama eventi (3. tarih satırından itibaren)
      table.addEventListener("click", (e) => {
        const target = e.target;
        // Tarih hücresi mi kontrol et (rowhdr ve 3. tarih satırından itibaren)
        if (target.matches("td.rowhdr")) {
          const row = target.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // İlk iki tarih satırını atla (5. ve 6. satırlar)
          // TARİH satırı 4. satır (index 3), ilk tarih satırı 5. satır (index 4)
          // 3. tarih satırı 7. satır (index 6)
          if (rowIdx <= idxTarih + 1) return; // İlk iki tarih satırını atla
          
          // Tüm tarih hücrelerinden selected class'ını kaldır
          rows.forEach(r => {
            if (r === row) return; // Mevcut satırı atla
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          
          // Tıklanan hücreyi seçili yap
          target.classList.add("selected");
          
          // Son seçilen tarihi localStorage'a kaydet
          localStorage.setItem('mtr1_selected_date_row', rowIdx.toString());
          
          // Tıklanan tarih satırı ve üstündeki tüm satırlar için localStorage'dan verileri geri yükle
          for (let i = idxTarih + 1; i <= rowIdx; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            
            const cells = Array.from(rows[i].querySelectorAll("td"));
            cells.forEach((cell, colIdx) => {
              // Tarih hücresini (rowhdr) atla, sadece veri girişi hücrelerini geri yükle
              if (cell.classList.contains("rowhdr")) return;
              
              const input = cell.querySelector("input.cell-inp");
              if (input) {
                // localStorage'dan veriyi geri yükle
                const key = `mtr1_sales_${i}_${colIdx}`;
                const saved = localStorage.getItem(key);
                if (saved !== null) {
                  input.value = saved;
                  // Uyarı kontrolü
                  const deger = parseNum(saved);
                  if (deger !== null && deger < 6000) {
                    input.classList.add("warning");
                  } else {
                    input.classList.remove("warning");
                  }
                } else {
                  // Eğer localStorage'da veri yoksa, boş bırak (ama görünür)
                  input.value = "";
                  input.classList.remove("warning", "success");
                }
              }
            });
          }
          
          // Geri yükleme sonrası tüm tarih satırları için uyarı kontrolü
          kontrolTarihSatirlariUyari();
          
          // Tıklanan tarih satırından sonraki tüm satırlardaki verileri sil
          // NOT: localStorage'dan silmiyoruz, sadece input'ları temizliyoruz
          // Böylece geri yüklerken localStorage'dan verileri bulabiliriz
          for (let i = rowIdx + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            
            const cells = Array.from(rows[i].querySelectorAll("td"));
            cells.forEach((cell, colIdx) => {
              // Tarih hücresini (rowhdr) atla, sadece veri girişi hücrelerini temizle
              if (cell.classList.contains("rowhdr")) return;
              
              const input = cell.querySelector("input.cell-inp");
              if (input) {
                // Input değerini temizle (localStorage'dan silme, geri yüklemek için saklıyoruz)
                input.value = "";
                // Boş hücreler için tüm renk class'larını kaldır (normal renk olmalı)
                input.classList.remove("warning", "success");
              }
            });
          }
          
          console.log("Tarih seçildi:", target.textContent, "Satır:", rowIdx, "- Üstündeki satırlar geri yüklendi, sonraki satırlar temizlendi");
          
          // YAĞCILAR sütunundaki tüm butonları pasif yap
          const yagcilarColIdx = subeIndeksleri["YAĞCILAR"];
          if (yagcilarColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[yagcilarColIdx]) {
                const input = cells[yagcilarColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_yagcilar_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_yagcilar_active_row');
          }
          
          // TEPEKUM sütunundaki tüm butonları pasif yap
          const tepekumColIdx = subeIndeksleri["TEPEKUM"];
          if (tepekumColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[tepekumColIdx]) {
                const input = cells[tepekumColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_tepekum_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_tepekum_active_row');
          }
          
          // NAMDAR sütunundaki tüm butonları pasif yap
          const namdarColIdx = subeIndeksleri["NAMDAR"];
          if (namdarColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[namdarColIdx]) {
                const input = cells[namdarColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_namdar_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_namdar_active_row');
          }
          
          // ŞEKER sütunundaki tüm butonları pasif yap
          const sekerColIdx = subeIndeksleri["ŞEKER"];
          if (sekerColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[sekerColIdx]) {
                const input = cells[sekerColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_seker_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_seker_active_row');
          }
          
          // AKOVA sütunundaki tüm butonları pasif yap
          const akovaColIdx = subeIndeksleri["AKOVA"];
          if (akovaColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[akovaColIdx]) {
                const input = cells[akovaColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_akova_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_akova_active_row');
          }
          
          // KOOP. sütunundaki tüm butonları pasif yap
          const koopColIdx = subeIndeksleri["KOOP."];
          if (koopColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[koopColIdx]) {
                const input = cells[koopColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_koop_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_koop_active_row');
          }
          
          // NAZİLLİ sütunundaki tüm butonları pasif yap
          const nazilliColIdx = subeIndeksleri["NAZİLLİ"];
          if (nazilliColIdx !== undefined) {
            for (let i = idxTarih + 3; i < rows.length; i++) {
              if (rows[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows[i].querySelectorAll("td"));
              if (cells[nazilliColIdx]) {
                const input = cells[nazilliColIdx].querySelector("input.cell-inp");
                if (input) {
                  input.classList.remove("cell-button-active");
                  localStorage.removeItem(`mtr1_nazilli_active_${i}`);
                }
              }
            }
            localStorage.removeItem('mtr1_nazilli_active_row');
          }
        }
      });
      
      // YAĞCILAR sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const yagcilarColIdx = subeIndeksleri["YAĞCILAR"];
      if (yagcilarColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // YAĞCILAR sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece YAĞCILAR sütunu için çalış
          if (colIdx !== yagcilarColIdx) return;
          
          // YAĞCILAR sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[yagcilarColIdx]) {
              const otherInput = rowCells[yagcilarColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_yagcilar_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_yagcilar_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_yagcilar_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // YAĞCILAR sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[yagcilarColIdx]) {
              const yagcilarInput = rowCells[yagcilarColIdx].querySelector("input.cell-inp");
              if (yagcilarInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${yagcilarColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    yagcilarInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    yagcilarInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        yagcilarInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        yagcilarInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    yagcilarInput.value = "";
                    yagcilarInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  yagcilarInput.value = "";
                  yagcilarInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("YAĞCILAR buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // TEPEKUM sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const tepekumColIdx = subeIndeksleri["TEPEKUM"];
      if (tepekumColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // TEPEKUM sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece TEPEKUM sütunu için çalış
          if (colIdx !== tepekumColIdx) return;
          
          // TEPEKUM sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[tepekumColIdx]) {
              const otherInput = rowCells[tepekumColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_tepekum_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_tepekum_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_tepekum_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // TEPEKUM sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[tepekumColIdx]) {
              const tepekumInput = rowCells[tepekumColIdx].querySelector("input.cell-inp");
              if (tepekumInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${tepekumColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    tepekumInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    tepekumInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        tepekumInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        tepekumInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    tepekumInput.value = "";
                    tepekumInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  tepekumInput.value = "";
                  tepekumInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("TEPEKUM buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // NAMDAR sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const namdarColIdx = subeIndeksleri["NAMDAR"];
      if (namdarColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // NAMDAR sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece NAMDAR sütunu için çalış
          if (colIdx !== namdarColIdx) return;
          
          // NAMDAR sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[namdarColIdx]) {
              const otherInput = rowCells[namdarColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_namdar_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_namdar_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_namdar_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // NAMDAR sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[namdarColIdx]) {
              const namdarInput = rowCells[namdarColIdx].querySelector("input.cell-inp");
              if (namdarInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${namdarColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    namdarInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    namdarInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        namdarInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        namdarInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    namdarInput.value = "";
                    namdarInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  namdarInput.value = "";
                  namdarInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("NAMDAR buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // ŞEKER sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const sekerColIdx = subeIndeksleri["ŞEKER"];
      if (sekerColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // ŞEKER sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece ŞEKER sütunu için çalış
          if (colIdx !== sekerColIdx) return;
          
          // ŞEKER sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[sekerColIdx]) {
              const otherInput = rowCells[sekerColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_seker_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_seker_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_seker_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // ŞEKER sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[sekerColIdx]) {
              const sekerInput = rowCells[sekerColIdx].querySelector("input.cell-inp");
              if (sekerInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${sekerColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    sekerInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    sekerInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        sekerInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        sekerInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    sekerInput.value = "";
                    sekerInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  sekerInput.value = "";
                  sekerInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("ŞEKER buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // AKOVA sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const akovaColIdx = subeIndeksleri["AKOVA"];
      if (akovaColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // AKOVA sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece AKOVA sütunu için çalış
          if (colIdx !== akovaColIdx) return;
          
          // AKOVA sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[akovaColIdx]) {
              const otherInput = rowCells[akovaColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_akova_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_akova_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_akova_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // AKOVA sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[akovaColIdx]) {
              const akovaInput = rowCells[akovaColIdx].querySelector("input.cell-inp");
              if (akovaInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${akovaColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    akovaInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    akovaInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        akovaInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        akovaInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    akovaInput.value = "";
                    akovaInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  akovaInput.value = "";
                  akovaInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("AKOVA buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // KOOP. sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const koopColIdx = subeIndeksleri["KOOP."];
      if (koopColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // KOOP. sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece KOOP. sütunu için çalış
          if (colIdx !== koopColIdx) return;
          
          // KOOP. sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[koopColIdx]) {
              const otherInput = rowCells[koopColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_koop_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_koop_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_koop_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // KOOP. sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[koopColIdx]) {
              const koopInput = rowCells[koopColIdx].querySelector("input.cell-inp");
              if (koopInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${koopColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    koopInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    koopInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        koopInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        koopInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    koopInput.value = "";
                    koopInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  koopInput.value = "";
                  koopInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("KOOP. buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // NAZİLLİ sütunu için hücre buton event'i (sadece MOTORİN tablosu)
      const nazilliColIdx = subeIndeksleri["NAZİLLİ"];
      if (nazilliColIdx !== undefined) {
        table.addEventListener("click", (e) => {
          const target = e.target;
          // NAZİLLİ sütunundaki input hücresi mi kontrol et
          if (!target.matches("input.cell-inp")) return;
          
          const td = target.closest('td[data-persist="1"]');
          if (!td) return;
          
          const row = td.closest("tr");
          if (!row) return;
          
          const rowIdx = rows.indexOf(row);
          if (rowIdx < 0) return;
          
          // Tarih satırından önceki satırlarda tıklama yapılamaz
          if (rowIdx <= idxTarih) return;
          
          // İlk iki tarih satırını atla (idxTarih + 1 ve idxTarih + 2)
          if (rowIdx <= idxTarih + 2) return;
          
          const cells = Array.from(row.querySelectorAll("td"));
          const colIdx = cells.indexOf(td);
          
          // Sadece NAZİLLİ sütunu için çalış
          if (colIdx !== nazilliColIdx) return;
          
          // NAZİLLİ sütunundaki diğer tüm butonları pasif yap
          for (let i = idxTarih + 3; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[nazilliColIdx]) {
              const otherInput = rowCells[nazilliColIdx].querySelector("input.cell-inp");
              if (otherInput && i !== rowIdx) {
                otherInput.classList.remove("cell-button-active");
                localStorage.removeItem(`mtr1_nazilli_active_${i}`);
              }
            }
          }
          
          // Tıklanan butonu aktif yap
          target.classList.add("cell-button-active");
          localStorage.setItem('mtr1_nazilli_active_row', rowIdx.toString());
          localStorage.setItem(`mtr1_nazilli_active_${rowIdx}`, "true");
          
          // Tarih satırı seçimini iptal et
          rows.forEach(r => {
            const firstCell = r.querySelector("td.rowhdr");
            if (firstCell) {
              firstCell.classList.remove("selected");
            }
          });
          localStorage.removeItem('mtr1_selected_date_row');
          
          // NAZİLLİ sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
          for (let i = idxTarih + 1; i < rows.length; i++) {
            if (rows[i].classList.contains("fixed-row")) continue;
            const rowCells = Array.from(rows[i].querySelectorAll("td"));
            if (rowCells[nazilliColIdx]) {
              const nazilliInput = rowCells[nazilliColIdx].querySelector("input.cell-inp");
              if (nazilliInput) {
                if (i <= rowIdx) {
                  // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                  const key = `mtr1_sales_${i}_${nazilliColIdx}`;
                  const saved = localStorage.getItem(key);
                  if (saved !== null) {
                    nazilliInput.value = saved;
                    // Uyarı ve başarı kontrolü
                    const deger = parseNum(saved);
                    nazilliInput.classList.remove("warning", "success");
                    if (deger !== null) {
                      if (deger < 6000) {
                        nazilliInput.classList.add("warning");  // Koyu kırmızı
                      } else if (deger >= 6000) {
                        nazilliInput.classList.add("success");  // Yeşil
                      }
                    }
                  } else {
                    nazilliInput.value = "";
                    nazilliInput.classList.remove("warning", "success");
                  }
                } else {
                  // Tıklanan hücrenin altındaki hücreler: temizle
                  nazilliInput.value = "";
                  nazilliInput.classList.remove("warning", "success");
                }
              }
            }
          }
          
          console.log("NAZİLLİ buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
        });
      }
      
      // Event delegation: table üzerinde input event yakala
      table.addEventListener("input", (e) => {
        if (!e.target.matches("input.cell-inp")) return;
        
        const input = e.target;
        const td = input.closest('td[data-persist="1"]');
        if (!td) return;
        
        const row = td.closest("tr");
        if (!row) return;
        
        const rowIdx = rows.indexOf(row);
        if (rowIdx < 0) return;
        
        const cells = Array.from(row.querySelectorAll("td"));
        const colIdx = cells.indexOf(td);
        if (colIdx < 0) return;
        
        // Kaydet
        const value = input.value;
        saveCell(rowIdx, colIdx, value);
        console.log("SAVED mtr1", rowIdx, colIdx, value);
        
        // Tarih satırlarındaysa uyarı kontrolü yap
        if (rowIdx > idxTarih) {
          const deger = parseNum(value);
          input.classList.remove("warning", "success");
          if (deger !== null) {
            if (deger < 6000) {
              input.classList.add("warning");  // Koyu kırmızı
            } else if (deger >= 6000) {
              input.classList.add("success");  // Yeşil
            }
          }
        }
        
        // Eğer SATIŞ satırındaysa, tüm tarih satırlarını hesapla
        if (rowIdx === idxSatis && Object.values(subeIndeksleri).includes(colIdx)) {
          hesaplaTarihSatirlari(colIdx);
          // Hesaplama sonrası uyarı kontrolü
          kontrolTarihSatirlariUyari();
        }
        
        // Eğer ilk gün satırındaysa ANLIK hesapla
        if (rowIdx === idxTarih + 1 && Object.values(subeIndeksleri).includes(colIdx)) {
          hesaplaAnlikSutun(colIdx);
          // İlk gün değiştiğinde de tarih satırlarını yeniden hesapla
          hesaplaTarihSatirlari(colIdx);
          // Hesaplama sonrası uyarı kontrolü
          kontrolTarihSatirlariUyari();
        }
      }, true);
      
      // Temizlik fonksiyonu (çağırma)
      window.clearMotorinSalesStorage = () => {
        for (let i = localStorage.length - 1; i >= 0; i--) {
          const key = localStorage.key(i);
          if (key && key.startsWith("mtr1_sales_")) {
            localStorage.removeItem(key);
          }
        }
      };
      
      // BENZİN TABLOSU İÇİN AYNI KODLAR
      const table2 = document.querySelector(".mtr2 .mtr-table");
      if (table2) {
        const rows2 = Array.from(table2.querySelectorAll("tbody tr"));
        const theadRow2 = table2.querySelector("thead tr");
        const headers2 = Array.from(theadRow2.querySelectorAll("th"));
        
        const subeListesi2 = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
        const subeIndeksleri2 = {};
        subeListesi2.forEach(sube => {
          const idx = headers2.findIndex(h => (h.textContent || "").trim() === sube);
          if (idx >= 0) {
            subeIndeksleri2[sube] = idx;
          }
        });
        
        if (Object.keys(subeIndeksleri2).length > 0) {
          const idxKapasite2 = rows2.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "KAPASİTE");
          const idxAnlik2 = rows2.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "ANLIK");
          const idxTarih2 = rows2.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "TARİH");
          const idxSatis2 = rows2.findIndex(r => (r.querySelector("td")?.textContent || "").trim().toUpperCase() === "SATIŞ");
          
          if (idxKapasite2 >= 0 && idxAnlik2 >= 0 && idxTarih2 >= 0) {
            const hesaplaAnlikSutun2 = (sutunIdx) => {
              const kapasiteRow = rows2[idxKapasite2];
              const anlikRow = rows2[idxAnlik2];
              const ilkGunRow = rows2[idxTarih2 + 1];
              if (!kapasiteRow || !anlikRow || !ilkGunRow) return;
              const kapasiteCell = kapasiteRow.querySelectorAll("td")[sutunIdx];
              const anlikCell = anlikRow.querySelectorAll("td")[sutunIdx];
              const ilkGunCell = ilkGunRow.querySelectorAll("td")[sutunIdx];
              if (!kapasiteCell || !anlikCell || !ilkGunCell) return;
              const kapasite = parseNum(kapasiteCell.textContent);
              const ilkGunInput = ilkGunCell.querySelector("input.cell-inp");
              const ilkGunSatis = ilkGunInput ? parseNum(ilkGunInput.value) : null;
              if (kapasite === null || ilkGunSatis === null) {
                anlikCell.textContent = "";
                return;
              }
              const anlik = kapasite - ilkGunSatis;
              anlikCell.textContent = formatNum(anlik);
            };
            
            // BENZİN tablosu için: Belirli bir sütun için tüm tarih satırlarını hesapla
            const hesaplaTarihSatirlari2 = (sutunIdx) => {
              const satisRow = rows2[idxSatis2];
              if (!satisRow) return;
              
              const satisCell = satisRow.querySelectorAll("td")[sutunIdx];
              if (!satisCell) return;
              
              const satisInput = satisCell.querySelector("input.cell-inp");
              if (!satisInput) return;
              
              const satisDegeri = parseNum(satisInput.value);
              if (satisDegeri === null) {
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const tarihCell = rows2[i].querySelectorAll("td")[sutunIdx];
                  if (tarihCell && !tarihCell.classList.contains("rowhdr")) {
                    const tarihInput = tarihCell.querySelector("input.cell-inp");
                    if (tarihInput && i > idxTarih2 + 1) {
                      tarihInput.value = "";
                      saveCell2(i, sutunIdx, "");
                    }
                  }
                }
                return;
              }
              
              const ilkGunRow = rows2[idxTarih2 + 1];
              if (!ilkGunRow) return;
              
              const ilkGunCell = ilkGunRow.querySelectorAll("td")[sutunIdx];
              if (!ilkGunCell) return;
              
              const ilkGunInput = ilkGunCell.querySelector("input.cell-inp");
              if (!ilkGunInput) return;
              
              let oncekiDeger = parseNum(ilkGunInput.value);
              if (oncekiDeger === null) {
                return;
              }
              
              for (let i = idxTarih2 + 2; i < rows2.length; i++) {
                if (rows2[i].classList.contains("fixed-row")) continue;
                
                const tarihCell = rows2[i].querySelectorAll("td")[sutunIdx];
                if (!tarihCell || tarihCell.classList.contains("rowhdr")) continue;
                
                const tarihInput = tarihCell.querySelector("input.cell-inp");
                if (!tarihInput) continue;
                
                const yeniDeger = oncekiDeger - satisDegeri;
                const formatted = formatNum(yeniDeger);
                tarihInput.value = formatted;
                
                // Renk kontrolü (2500'den küçükse kırmızı, 2500 ve üzeri yeşil)
                tarihInput.classList.remove("warning", "success");
                if (yeniDeger < 2500) {
                  tarihInput.classList.add("warning");  // Koyu kırmızı
                } else if (yeniDeger >= 2500) {
                  tarihInput.classList.add("success");  // Yeşil
                }
                
                saveCell2(i, sutunIdx, formatted);
                oncekiDeger = yeniDeger;
              }
            };
            
            const hesaplaAnlikTum2 = () => {
              Object.values(subeIndeksleri2).forEach(idx => {
                hesaplaAnlikSutun2(idx);
              });
            };
            
            const saveBenzinSatis = async (sube, deger) => {
              try {
                const numValue = parseNum(deger) || 0;
                const response = await fetch('/api/benzin-satis/', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({
                    tarih: getTodayDate(),
                    sube: sube,
                    deger: numValue
                  })
                });
                const data = await response.json();
                if (data.success) {
                  console.log('BENZİN satış kaydedildi:', sube, numValue);
                }
              } catch (error) {
                console.error('BENZİN satış kaydetme hatası:', error);
              }
            };
            
            const loadBenzinSatis = async () => {
              try {
                const response = await fetch('/api/benzin-satis/');
                const data = await response.json();
                if (idxSatis2 >= 0) {
                  const satisRow = rows2[idxSatis2];
                  const inputs = satisRow.querySelectorAll('input.cell-inp[data-sube]');
                  inputs.forEach(input => {
                    const sube = input.getAttribute('data-sube');
                    const deger = data[sube];
                    if (deger !== undefined && deger !== null) {
                      input.value = formatNum(deger);
                    }
                  });
                }
              } catch (error) {
                console.error('BENZİN satış yükleme hatası:', error);
              }
            };
            
            const saveCell2 = (rowIdx, colIdx, value) => {
              if (rowIdx === idxSatis2) {
                const input = rows2[rowIdx].querySelectorAll('input.cell-inp')[colIdx - 1];
                if (input) {
                  const sube = input.getAttribute('data-sube');
                  if (sube) {
                    saveBenzinSatis(sube, value);
                    return;
                  }
                }
              }
              const key = `mtr2_sales_${rowIdx}_${colIdx}`;
              if (value && value.trim() !== "") {
                localStorage.setItem(key, value);
              } else {
                localStorage.removeItem(key);
              }
            };
            
            const restoreCell2 = (rowIdx, colIdx, input) => {
              if (rowIdx === idxSatis2) return;
              const key = `mtr2_sales_${rowIdx}_${colIdx}`;
              const saved = localStorage.getItem(key);
              if (saved !== null) {
                input.value = saved;
              }
            };
            
            let d2 = new Date();
            for (let i = idxTarih2 + 1; i < rows2.length; i++) {
              if (rows2[i].classList.contains("fixed-row")) continue;
              const first = rows2[i].querySelector("td");
              if (!first) continue;
              first.textContent = fmt(d2);
              d2.setDate(d2.getDate() + 1);
            }
            
            for (let i = idxTarih2 + 1; i < rows2.length; i++) {
              if (rows2[i].classList.contains("fixed-row")) continue;
              const cells = Array.from(rows2[i].querySelectorAll("td"));
              cells.forEach((cell, colIdx) => {
                if (cell.classList.contains("rowhdr")) return;
                const input = cell.querySelector("input.cell-inp");
                if (input) {
                  restoreCell2(i, colIdx, input);
                }
              });
            }
            
            // BENZİN tablosu için tarih satırları renk kontrolü
            const kontrolTarihSatirlariUyari2 = () => {
              for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                if (rows2[i].classList.contains("fixed-row")) continue;
                
                const cells = Array.from(rows2[i].querySelectorAll("td"));
                cells.forEach((cell, colIdx) => {
                  if (cell.classList.contains("rowhdr")) return;
                  
                  const input = cell.querySelector("input.cell-inp");
                  if (input) {
                    const deger = parseNum(input.value);
                    // Tüm class'ları temizle
                    input.classList.remove("warning", "success");
                    // Boş hücreler normal renkte olmalı
                    if (deger === null || input.value.trim() === "") {
                      // Normal, class yok
                    } else if (deger < 2500) {
                      input.classList.add("warning");  // Koyu kırmızı
                    } else if (deger >= 2500) {
                      input.classList.add("success");  // Yeşil
                    }
                  }
                });
              }
            };
            
            loadBenzinSatis().then(() => {
              hesaplaAnlikTum2();
              // Tarih satırları uyarı kontrolü
              kontrolTarihSatirlariUyari2();
              
              // Son seçilen tarihi geri yükle
              const lastSelectedRow2 = localStorage.getItem('mtr2_selected_date_row');
              if (lastSelectedRow2) {
                const selectedRowIdx2 = parseInt(lastSelectedRow2);
                // İlk iki tarih satırını atla kontrolü
                if (selectedRowIdx2 > idxTarih2 + 1) {
                  const selectedRow2 = rows2[selectedRowIdx2];
                  if (selectedRow2) {
                    const selectedCell2 = selectedRow2.querySelector("td.rowhdr");
                    if (selectedCell2) {
                      // Tüm tarih hücrelerinden selected class'ını kaldır
                      rows2.forEach(r => {
                        const firstCell = r.querySelector("td.rowhdr");
                        if (firstCell) {
                          firstCell.classList.remove("selected");
                        }
                      });
                      
                      // Son seçilen tarihi seçili yap
                      selectedCell2.classList.add("selected");
                      
                      // Son seçilen tarih ve üstündeki tüm satırlar için localStorage'dan verileri geri yükle
                      for (let i = idxTarih2 + 1; i <= selectedRowIdx2; i++) {
                        if (rows2[i].classList.contains("fixed-row")) continue;
                        
                        const cells = Array.from(rows2[i].querySelectorAll("td"));
                        cells.forEach((cell, colIdx) => {
                          if (cell.classList.contains("rowhdr")) return;
                          
                          const input = cell.querySelector("input.cell-inp");
                          if (input) {
                            const key = `mtr2_sales_${i}_${colIdx}`;
                            const saved = localStorage.getItem(key);
                            if (saved !== null) {
                              input.value = saved;
                              // Uyarı kontrolü
                              const deger = parseNum(saved);
                              if (deger !== null && deger < 2500) {
                                input.classList.add("warning");
                              } else {
                                input.classList.remove("warning");
                              }
                            } else {
                              input.value = "";
                              input.classList.remove("warning");
                            }
                          }
                        });
                      }
                      
                      // Son seçilen tarihten sonraki tüm satırlardaki verileri sil
                      for (let i = selectedRowIdx2 + 1; i < rows2.length; i++) {
                        if (rows2[i].classList.contains("fixed-row")) continue;
                        
                        const cells = Array.from(rows2[i].querySelectorAll("td"));
                        cells.forEach((cell, colIdx) => {
                          if (cell.classList.contains("rowhdr")) return;
                          
                          const input = cell.querySelector("input.cell-inp");
                          if (input) {
                            input.value = "";
                            input.classList.remove("warning", "success");
                          }
                        });
                      }
                      
                      // Uyarı kontrolü
                      kontrolTarihSatirlariUyari2();
                      
                      console.log("BENZİN - Son seçilen tarih geri yüklendi:", selectedCell2.textContent, "Satır:", selectedRowIdx2);
                    }
                  }
                }
              }
              
              // BENZİN tablosu - YAĞCILAR sütunu için aktif buton durumunu geri yükle
              const yagcilarColIdx2 = subeIndeksleri2["YAĞCILAR"];
              if (yagcilarColIdx2 !== undefined) {
                const activeYagcilarRow2 = localStorage.getItem('mtr2_yagcilar_active_row');
                if (activeYagcilarRow2) {
                  const activeRowIdx2 = parseInt(activeYagcilarRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[yagcilarColIdx2]) {
                        const activeInput2 = cells[yagcilarColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          
                          // YAĞCILAR sütunu için: Aktif hücre ve üstündeki hücreleri göster, altındakileri temizle
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[yagcilarColIdx2]) {
                              const yagcilarInput2 = rowCells[yagcilarColIdx2].querySelector("input.cell-inp");
                              if (yagcilarInput2) {
                                if (i <= activeRowIdx2) {
                                  // Aktif hücre ve üstündeki hücreler: localStorage'dan geri yükle
                                  const key = `mtr2_sales_${i}_${yagcilarColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    yagcilarInput2.value = saved;
                                    // Uyarı ve başarı kontrolü (BENZİN için 2500)
                                    const deger = parseNum(saved);
                                    yagcilarInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        yagcilarInput2.classList.add("warning");  // Koyu kırmızı
                                      } else if (deger >= 2500) {
                                        yagcilarInput2.classList.add("success");  // Yeşil
                                      }
                                    }
                                  } else {
                                    yagcilarInput2.value = "";
                                    yagcilarInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  // Aktif hücrenin altındaki hücreler: temizle
                                  yagcilarInput2.value = "";
                                  yagcilarInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          
                          console.log("BENZİN - YAĞCILAR aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - TEPEKUM sütunu için aktif buton durumunu geri yükle
              const tepekumColIdx2 = subeIndeksleri2["TEPEKUM"];
              if (tepekumColIdx2 !== undefined) {
                const activeTepekumRow2 = localStorage.getItem('mtr2_tepekum_active_row');
                if (activeTepekumRow2) {
                  const activeRowIdx2 = parseInt(activeTepekumRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[tepekumColIdx2]) {
                        const activeInput2 = cells[tepekumColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[tepekumColIdx2]) {
                              const tepekumInput2 = rowCells[tepekumColIdx2].querySelector("input.cell-inp");
                              if (tepekumInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${tepekumColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    tepekumInput2.value = saved;
                                    const deger = parseNum(saved);
                                    tepekumInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        tepekumInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        tepekumInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    tepekumInput2.value = "";
                                    tepekumInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  tepekumInput2.value = "";
                                  tepekumInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - TEPEKUM aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - NAMDAR sütunu için aktif buton durumunu geri yükle
              const namdarColIdx2 = subeIndeksleri2["NAMDAR"];
              if (namdarColIdx2 !== undefined) {
                const activeNamdarRow2 = localStorage.getItem('mtr2_namdar_active_row');
                if (activeNamdarRow2) {
                  const activeRowIdx2 = parseInt(activeNamdarRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[namdarColIdx2]) {
                        const activeInput2 = cells[namdarColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[namdarColIdx2]) {
                              const namdarInput2 = rowCells[namdarColIdx2].querySelector("input.cell-inp");
                              if (namdarInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${namdarColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    namdarInput2.value = saved;
                                    const deger = parseNum(saved);
                                    namdarInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        namdarInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        namdarInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    namdarInput2.value = "";
                                    namdarInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  namdarInput2.value = "";
                                  namdarInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - NAMDAR aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - ŞEKER sütunu için aktif buton durumunu geri yükle
              const sekerColIdx2 = subeIndeksleri2["ŞEKER"];
              if (sekerColIdx2 !== undefined) {
                const activeSekerRow2 = localStorage.getItem('mtr2_seker_active_row');
                if (activeSekerRow2) {
                  const activeRowIdx2 = parseInt(activeSekerRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[sekerColIdx2]) {
                        const activeInput2 = cells[sekerColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[sekerColIdx2]) {
                              const sekerInput2 = rowCells[sekerColIdx2].querySelector("input.cell-inp");
                              if (sekerInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${sekerColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    sekerInput2.value = saved;
                                    const deger = parseNum(saved);
                                    sekerInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        sekerInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        sekerInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    sekerInput2.value = "";
                                    sekerInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  sekerInput2.value = "";
                                  sekerInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - ŞEKER aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - AKOVA sütunu için aktif buton durumunu geri yükle
              const akovaColIdx2 = subeIndeksleri2["AKOVA"];
              if (akovaColIdx2 !== undefined) {
                const activeAkovaRow2 = localStorage.getItem('mtr2_akova_active_row');
                if (activeAkovaRow2) {
                  const activeRowIdx2 = parseInt(activeAkovaRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[akovaColIdx2]) {
                        const activeInput2 = cells[akovaColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[akovaColIdx2]) {
                              const akovaInput2 = rowCells[akovaColIdx2].querySelector("input.cell-inp");
                              if (akovaInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${akovaColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    akovaInput2.value = saved;
                                    const deger = parseNum(saved);
                                    akovaInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        akovaInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        akovaInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    akovaInput2.value = "";
                                    akovaInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  akovaInput2.value = "";
                                  akovaInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - AKOVA aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - KOOP. sütunu için aktif buton durumunu geri yükle
              const koopColIdx2 = subeIndeksleri2["KOOP."];
              if (koopColIdx2 !== undefined) {
                const activeKoopRow2 = localStorage.getItem('mtr2_koop_active_row');
                if (activeKoopRow2) {
                  const activeRowIdx2 = parseInt(activeKoopRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[koopColIdx2]) {
                        const activeInput2 = cells[koopColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[koopColIdx2]) {
                              const koopInput2 = rowCells[koopColIdx2].querySelector("input.cell-inp");
                              if (koopInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${koopColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    koopInput2.value = saved;
                                    const deger = parseNum(saved);
                                    koopInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        koopInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        koopInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    koopInput2.value = "";
                                    koopInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  koopInput2.value = "";
                                  koopInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - KOOP. aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
              
              // BENZİN tablosu - NAZİLLİ sütunu için aktif buton durumunu geri yükle
              const nazilliColIdx2 = subeIndeksleri2["NAZİLLİ"];
              if (nazilliColIdx2 !== undefined) {
                const activeNazilliRow2 = localStorage.getItem('mtr2_nazilli_active_row');
                if (activeNazilliRow2) {
                  const activeRowIdx2 = parseInt(activeNazilliRow2);
                  if (activeRowIdx2 > idxTarih2 + 2) {
                    const activeRow2 = rows2[activeRowIdx2];
                    if (activeRow2) {
                      const cells = Array.from(activeRow2.querySelectorAll("td"));
                      if (cells[nazilliColIdx2]) {
                        const activeInput2 = cells[nazilliColIdx2].querySelector("input.cell-inp");
                        if (activeInput2) {
                          activeInput2.classList.add("cell-button-active");
                          for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                            if (rows2[i].classList.contains("fixed-row")) continue;
                            const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                            if (rowCells[nazilliColIdx2]) {
                              const nazilliInput2 = rowCells[nazilliColIdx2].querySelector("input.cell-inp");
                              if (nazilliInput2) {
                                if (i <= activeRowIdx2) {
                                  const key = `mtr2_sales_${i}_${nazilliColIdx2}`;
                                  const saved = localStorage.getItem(key);
                                  if (saved !== null) {
                                    nazilliInput2.value = saved;
                                    const deger = parseNum(saved);
                                    nazilliInput2.classList.remove("warning", "success");
                                    if (deger !== null) {
                                      if (deger < 2500) {
                                        nazilliInput2.classList.add("warning");
                                      } else if (deger >= 2500) {
                                        nazilliInput2.classList.add("success");
                                      }
                                    }
                                  } else {
                                    nazilliInput2.value = "";
                                    nazilliInput2.classList.remove("warning", "success");
                                  }
                                } else {
                                  nazilliInput2.value = "";
                                  nazilliInput2.classList.remove("warning", "success");
                                }
                              }
                            }
                          }
                          console.log("BENZİN - NAZİLLİ aktif buton geri yüklendi - Satır:", activeRowIdx2);
                        }
                      }
                    }
                  }
                }
              }
            });
            
            // BENZİN tablosu için tarih hücrelerine tıklama eventi (3. tarih satırından itibaren)
            table2.addEventListener("click", (e) => {
              const target = e.target;
              if (target.matches("td.rowhdr")) {
                const row = target.closest("tr");
                if (!row) return;
                
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0) return;
                
                // İlk iki tarih satırını atla
                if (rowIdx <= idxTarih2 + 1) return;
                
                // Tüm tarih hücrelerinden selected class'ını kaldır
                rows2.forEach(r => {
                  if (r === row) return;
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) {
                    firstCell.classList.remove("selected");
                  }
                });
                
                // Tıklanan hücreyi seçili yap
                target.classList.add("selected");
                
                // Son seçilen tarihi localStorage'a kaydet
                localStorage.setItem('mtr2_selected_date_row', rowIdx.toString());
                
                // Tıklanan tarih satırı ve üstündeki tüm satırlar için localStorage'dan verileri geri yükle
                for (let i = idxTarih2 + 1; i <= rowIdx; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  
                  const cells = Array.from(rows2[i].querySelectorAll("td"));
                  cells.forEach((cell, colIdx) => {
                    // Tarih hücresini (rowhdr) atla, sadece veri girişi hücrelerini geri yükle
                    if (cell.classList.contains("rowhdr")) return;
                    
                    const input = cell.querySelector("input.cell-inp");
                    if (input) {
                      // localStorage'dan veriyi geri yükle
                      const key = `mtr2_sales_${i}_${colIdx}`;
                      const saved = localStorage.getItem(key);
                      if (saved !== null) {
                        input.value = saved;
                        // Uyarı kontrolü
                        const deger = parseNum(saved);
                        input.classList.remove("warning", "success");
                        if (deger !== null) {
                          if (deger < 2500) {
                            input.classList.add("warning");  // Koyu kırmızı
                          } else if (deger >= 2500) {
                            input.classList.add("success");  // Yeşil
                          }
                        }
                      } else {
                        // Eğer localStorage'da veri yoksa, boş bırak (ama görünür)
                        input.value = "";
                        input.classList.remove("warning", "success");
                      }
                    }
                  });
                }
                
                // Geri yükleme sonrası tüm tarih satırları için uyarı kontrolü
                kontrolTarihSatirlariUyari2();
                
                // Tıklanan tarih satırından sonraki tüm satırlardaki verileri sil
                // NOT: localStorage'dan silmiyoruz, sadece input'ları temizliyoruz
                // Böylece geri yüklerken localStorage'dan verileri bulabiliriz
                for (let i = rowIdx + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  
                  const cells = Array.from(rows2[i].querySelectorAll("td"));
                  cells.forEach((cell, colIdx) => {
                    // Tarih hücresini (rowhdr) atla, sadece veri girişi hücrelerini temizle
                    if (cell.classList.contains("rowhdr")) return;
                    
                    const input = cell.querySelector("input.cell-inp");
                    if (input) {
                      // Input değerini temizle (localStorage'dan silme, geri yüklemek için saklıyoruz)
                      input.value = "";
                      // Boş hücreler için tüm renk class'larını kaldır (normal renk olmalı)
                      input.classList.remove("warning", "success");
                    }
                  });
                }
                
                console.log("BENZİN - Tarih seçildi:", target.textContent, "Satır:", rowIdx, "- Üstündeki satırlar geri yüklendi, sonraki satırlar temizlendi");
                
                // YAĞCILAR sütunundaki tüm butonları pasif yap
                const yagcilarColIdx2 = subeIndeksleri2["YAĞCILAR"];
                if (yagcilarColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[yagcilarColIdx2]) {
                      const input = cells[yagcilarColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_yagcilar_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_yagcilar_active_row');
                }
                
                // TEPEKUM sütunundaki tüm butonları pasif yap
                const tepekumColIdx2 = subeIndeksleri2["TEPEKUM"];
                if (tepekumColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[tepekumColIdx2]) {
                      const input = cells[tepekumColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_tepekum_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_tepekum_active_row');
                }
                
                // NAMDAR sütunundaki tüm butonları pasif yap
                const namdarColIdx2 = subeIndeksleri2["NAMDAR"];
                if (namdarColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[namdarColIdx2]) {
                      const input = cells[namdarColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_namdar_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_namdar_active_row');
                }
                
                // ŞEKER sütunundaki tüm butonları pasif yap
                const sekerColIdx2 = subeIndeksleri2["ŞEKER"];
                if (sekerColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[sekerColIdx2]) {
                      const input = cells[sekerColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_seker_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_seker_active_row');
                }
                
                // AKOVA sütunundaki tüm butonları pasif yap
                const akovaColIdx2 = subeIndeksleri2["AKOVA"];
                if (akovaColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[akovaColIdx2]) {
                      const input = cells[akovaColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_akova_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_akova_active_row');
                }
                
                // KOOP. sütunundaki tüm butonları pasif yap
                const koopColIdx2 = subeIndeksleri2["KOOP."];
                if (koopColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[koopColIdx2]) {
                      const input = cells[koopColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_koop_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_koop_active_row');
                }
                
                // NAZİLLİ sütunundaki tüm butonları pasif yap
                const nazilliColIdx2 = subeIndeksleri2["NAZİLLİ"];
                if (nazilliColIdx2 !== undefined) {
                  for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                    if (rows2[i].classList.contains("fixed-row")) continue;
                    const cells = Array.from(rows2[i].querySelectorAll("td"));
                    if (cells[nazilliColIdx2]) {
                      const input = cells[nazilliColIdx2].querySelector("input.cell-inp");
                      if (input) {
                        input.classList.remove("cell-button-active");
                        localStorage.removeItem(`mtr2_nazilli_active_${i}`);
                      }
                    }
                  }
                  localStorage.removeItem('mtr2_nazilli_active_row');
                }
              }
            });
            
            // BENZİN tablosu - YAĞCILAR sütunu için hücre buton event'i
            const yagcilarColIdx2 = subeIndeksleri2["YAĞCILAR"];
            if (yagcilarColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                // YAĞCILAR sütunundaki input hücresi mi kontrol et
                if (!target.matches("input.cell-inp")) return;
                
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                
                const row = td.closest("tr");
                if (!row) return;
                
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0) return;
                
                // Tarih satırından önceki satırlarda tıklama yapılamaz
                if (rowIdx <= idxTarih2) return;
                
                // İlk iki tarih satırını atla (idxTarih2 + 1 ve idxTarih2 + 2)
                if (rowIdx <= idxTarih2 + 2) return;
                
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                
                // Sadece YAĞCILAR sütunu için çalış
                if (colIdx !== yagcilarColIdx2) return;
                
                // YAĞCILAR sütunundaki diğer tüm butonları pasif yap
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[yagcilarColIdx2]) {
                    const otherInput = rowCells[yagcilarColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_yagcilar_active_${i}`);
                    }
                  }
                }
                
                // Tıklanan butonu aktif yap
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_yagcilar_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_yagcilar_active_${rowIdx}`, "true");
                
                // Tarih satırı seçimini iptal et
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) {
                    firstCell.classList.remove("selected");
                  }
                });
                localStorage.removeItem('mtr2_selected_date_row');
                
                // YAĞCILAR sütunu için: Tıklanan hücre ve üstündeki hücreleri göster, altındakileri temizle
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[yagcilarColIdx2]) {
                    const yagcilarInput = rowCells[yagcilarColIdx2].querySelector("input.cell-inp");
                    if (yagcilarInput) {
                      if (i <= rowIdx) {
                        // Tıklanan hücre ve üstündeki hücreler: localStorage'dan geri yükle
                        const key = `mtr2_sales_${i}_${yagcilarColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          yagcilarInput.value = saved;
                          // Uyarı ve başarı kontrolü (BENZİN için 2500)
                          const deger = parseNum(saved);
                          yagcilarInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              yagcilarInput.classList.add("warning");  // Koyu kırmızı
                            } else if (deger >= 2500) {
                              yagcilarInput.classList.add("success");  // Yeşil
                            }
                          }
                        } else {
                          yagcilarInput.value = "";
                          yagcilarInput.classList.remove("warning", "success");
                        }
                      } else {
                        // Tıklanan hücrenin altındaki hücreler: temizle
                        yagcilarInput.value = "";
                        yagcilarInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                
                console.log("BENZİN - YAĞCILAR buton tıklandı - Satır:", rowIdx, "- Bu hücre ve üstündeki hücreler gösterildi");
              });
            }
            
            // BENZİN tablosu - TEPEKUM sütunu için hücre buton event'i
            const tepekumColIdx2 = subeIndeksleri2["TEPEKUM"];
            if (tepekumColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== tepekumColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[tepekumColIdx2]) {
                    const otherInput = rowCells[tepekumColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_tepekum_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_tepekum_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_tepekum_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[tepekumColIdx2]) {
                    const tepekumInput = rowCells[tepekumColIdx2].querySelector("input.cell-inp");
                    if (tepekumInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${tepekumColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          tepekumInput.value = saved;
                          const deger = parseNum(saved);
                          tepekumInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              tepekumInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              tepekumInput.classList.add("success");
                            }
                          }
                        } else {
                          tepekumInput.value = "";
                          tepekumInput.classList.remove("warning", "success");
                        }
                      } else {
                        tepekumInput.value = "";
                        tepekumInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - TEPEKUM buton tıklandı - Satır:", rowIdx);
              });
            }
            
            // BENZİN tablosu - NAMDAR sütunu için hücre buton event'i
            const namdarColIdx2 = subeIndeksleri2["NAMDAR"];
            if (namdarColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== namdarColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[namdarColIdx2]) {
                    const otherInput = rowCells[namdarColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_namdar_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_namdar_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_namdar_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[namdarColIdx2]) {
                    const namdarInput = rowCells[namdarColIdx2].querySelector("input.cell-inp");
                    if (namdarInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${namdarColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          namdarInput.value = saved;
                          const deger = parseNum(saved);
                          namdarInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              namdarInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              namdarInput.classList.add("success");
                            }
                          }
                        } else {
                          namdarInput.value = "";
                          namdarInput.classList.remove("warning", "success");
                        }
                      } else {
                        namdarInput.value = "";
                        namdarInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - NAMDAR buton tıklandı - Satır:", rowIdx);
              });
            }
            
            // BENZİN tablosu - ŞEKER sütunu için hücre buton event'i
            const sekerColIdx2 = subeIndeksleri2["ŞEKER"];
            if (sekerColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== sekerColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[sekerColIdx2]) {
                    const otherInput = rowCells[sekerColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_seker_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_seker_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_seker_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[sekerColIdx2]) {
                    const sekerInput = rowCells[sekerColIdx2].querySelector("input.cell-inp");
                    if (sekerInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${sekerColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          sekerInput.value = saved;
                          const deger = parseNum(saved);
                          sekerInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              sekerInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              sekerInput.classList.add("success");
                            }
                          }
                        } else {
                          sekerInput.value = "";
                          sekerInput.classList.remove("warning", "success");
                        }
                      } else {
                        sekerInput.value = "";
                        sekerInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - ŞEKER buton tıklandı - Satır:", rowIdx);
              });
            }
            
            // BENZİN tablosu - AKOVA sütunu için hücre buton event'i
            const akovaColIdx2 = subeIndeksleri2["AKOVA"];
            if (akovaColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== akovaColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[akovaColIdx2]) {
                    const otherInput = rowCells[akovaColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_akova_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_akova_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_akova_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[akovaColIdx2]) {
                    const akovaInput = rowCells[akovaColIdx2].querySelector("input.cell-inp");
                    if (akovaInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${akovaColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          akovaInput.value = saved;
                          const deger = parseNum(saved);
                          akovaInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              akovaInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              akovaInput.classList.add("success");
                            }
                          }
                        } else {
                          akovaInput.value = "";
                          akovaInput.classList.remove("warning", "success");
                        }
                      } else {
                        akovaInput.value = "";
                        akovaInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - AKOVA buton tıklandı - Satır:", rowIdx);
              });
            }
            
            // BENZİN tablosu - KOOP. sütunu için hücre buton event'i
            const koopColIdx2 = subeIndeksleri2["KOOP."];
            if (koopColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== koopColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[koopColIdx2]) {
                    const otherInput = rowCells[koopColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_koop_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_koop_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_koop_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[koopColIdx2]) {
                    const koopInput = rowCells[koopColIdx2].querySelector("input.cell-inp");
                    if (koopInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${koopColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          koopInput.value = saved;
                          const deger = parseNum(saved);
                          koopInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              koopInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              koopInput.classList.add("success");
                            }
                          }
                        } else {
                          koopInput.value = "";
                          koopInput.classList.remove("warning", "success");
                        }
                      } else {
                        koopInput.value = "";
                        koopInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - KOOP. buton tıklandı - Satır:", rowIdx);
              });
            }
            
            // BENZİN tablosu - NAZİLLİ sütunu için hücre buton event'i
            const nazilliColIdx2 = subeIndeksleri2["NAZİLLİ"];
            if (nazilliColIdx2 !== undefined) {
              table2.addEventListener("click", (e) => {
                const target = e.target;
                if (!target.matches("input.cell-inp")) return;
                const td = target.closest('td[data-persist="1"]');
                if (!td) return;
                const row = td.closest("tr");
                if (!row) return;
                const rowIdx = rows2.indexOf(row);
                if (rowIdx < 0 || rowIdx <= idxTarih2 || rowIdx <= idxTarih2 + 2) return;
                const cells = Array.from(row.querySelectorAll("td"));
                const colIdx = cells.indexOf(td);
                if (colIdx !== nazilliColIdx2) return;
                for (let i = idxTarih2 + 3; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[nazilliColIdx2]) {
                    const otherInput = rowCells[nazilliColIdx2].querySelector("input.cell-inp");
                    if (otherInput && i !== rowIdx) {
                      otherInput.classList.remove("cell-button-active");
                      localStorage.removeItem(`mtr2_nazilli_active_${i}`);
                    }
                  }
                }
                target.classList.add("cell-button-active");
                localStorage.setItem('mtr2_nazilli_active_row', rowIdx.toString());
                localStorage.setItem(`mtr2_nazilli_active_${rowIdx}`, "true");
                rows2.forEach(r => {
                  const firstCell = r.querySelector("td.rowhdr");
                  if (firstCell) firstCell.classList.remove("selected");
                });
                localStorage.removeItem('mtr2_selected_date_row');
                for (let i = idxTarih2 + 1; i < rows2.length; i++) {
                  if (rows2[i].classList.contains("fixed-row")) continue;
                  const rowCells = Array.from(rows2[i].querySelectorAll("td"));
                  if (rowCells[nazilliColIdx2]) {
                    const nazilliInput = rowCells[nazilliColIdx2].querySelector("input.cell-inp");
                    if (nazilliInput) {
                      if (i <= rowIdx) {
                        const key = `mtr2_sales_${i}_${nazilliColIdx2}`;
                        const saved = localStorage.getItem(key);
                        if (saved !== null) {
                          nazilliInput.value = saved;
                          const deger = parseNum(saved);
                          nazilliInput.classList.remove("warning", "success");
                          if (deger !== null) {
                            if (deger < 2500) {
                              nazilliInput.classList.add("warning");
                            } else if (deger >= 2500) {
                              nazilliInput.classList.add("success");
                            }
                          }
                        } else {
                          nazilliInput.value = "";
                          nazilliInput.classList.remove("warning", "success");
                        }
                      } else {
                        nazilliInput.value = "";
                        nazilliInput.classList.remove("warning", "success");
                      }
                    }
                  }
                }
                console.log("BENZİN - NAZİLLİ buton tıklandı - Satır:", rowIdx);
              });
            }
            
            table2.addEventListener("input", (e) => {
              if (!e.target.matches("input.cell-inp")) return;
              const input = e.target;
              const td = input.closest('td[data-persist="1"]');
              if (!td) return;
              const row = td.closest("tr");
              if (!row) return;
              const rowIdx = rows2.indexOf(row);
              if (rowIdx < 0) return;
              const cells = Array.from(row.querySelectorAll("td"));
              const colIdx = cells.indexOf(td);
              if (colIdx < 0) return;
              const value = input.value;
              saveCell2(rowIdx, colIdx, value);
              
              // Tarih satırlarındaysa uyarı kontrolü yap
              if (rowIdx > idxTarih2) {
                const deger = parseNum(value);
                input.classList.remove("warning", "success");
                if (deger !== null) {
                  if (deger < 2500) {
                    input.classList.add("warning");  // Koyu kırmızı
                  } else if (deger >= 2500) {
                    input.classList.add("success");  // Yeşil
                  }
                }
              }
              
              // Eğer SATIŞ satırındaysa, tüm tarih satırlarını hesapla
              if (rowIdx === idxSatis2 && Object.values(subeIndeksleri2).includes(colIdx)) {
                hesaplaTarihSatirlari2(colIdx);
                // Hesaplama sonrası uyarı kontrolü
                kontrolTarihSatirlariUyari2();
              }
              
              // Eğer ilk gün satırındaysa ANLIK hesapla
              if (rowIdx === idxTarih2 + 1 && Object.values(subeIndeksleri2).includes(colIdx)) {
                hesaplaAnlikSutun2(colIdx);
                // İlk gün değiştiğinde de tarih satırlarını yeniden hesapla
                hesaplaTarihSatirlari2(colIdx);
                // Hesaplama sonrası uyarı kontrolü
                kontrolTarihSatirlariUyari2();
              }
            }, true);
          }
        }
      }
      
      // YAKIT ALIMLARI Tablosu - FİRMA Dropdown
      const yakitTable = document.querySelector(".yakit-table");
      if (yakitTable) {
        const firmaListesi = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
        const rows = Array.from(yakitTable.querySelectorAll("tbody tr"));
        
        // FİRMA sütunundaki hücreleri işaretle ve event ekle
        rows.forEach((row, rowIdx) => {
          const firmaCell = row.querySelector("td:first-child");
          if (firmaCell) {
            firmaCell.classList.add("firma-cell");
            
            // localStorage'dan değeri yükle
            const key = `yakit_firma_${rowIdx}`;
            const saved = localStorage.getItem(key);
            if (saved) {
              firmaCell.innerHTML = `<span class="firma-value">${saved}</span>`;
            } else {
              firmaCell.innerHTML = `<span class="firma-value"></span>`;
            }
            
            // FİRMA yüklendikten sonra TL hesapla (kısa gecikme ile)
            if (saved) {
              setTimeout(() => {
                hesaplaTL(rowIdx);
              }, 50);
            }
            
            // Dropdown oluştur
            const dropdown = document.createElement("div");
            dropdown.className = "firma-dropdown";
            firmaListesi.forEach(firma => {
              const option = document.createElement("div");
              option.className = "firma-option";
              option.textContent = firma;
              option.addEventListener("click", (e) => {
                e.stopPropagation();
                const valueSpan = firmaCell.querySelector(".firma-value");
                if (valueSpan) {
                  valueSpan.textContent = firma;
                }
                // localStorage'a kaydet
                localStorage.setItem(key, firma);
                // Dropdown'u kapat
                dropdown.classList.remove("show");
                // TL hesapla
                hesaplaTL(rowIdx);
                // ONAY butonunu kontrol et
                kontrolOnayButonu(rowIdx);
              });
              dropdown.appendChild(option);
            });
            firmaCell.appendChild(dropdown);
            
            // Tıklama eventi
            firmaCell.addEventListener("click", (e) => {
              e.stopPropagation();
              // Diğer dropdown'ları kapat
              document.querySelectorAll(".firma-dropdown").forEach(dd => {
                if (dd !== dropdown) {
                  dd.classList.remove("show");
                }
              });
              // Bu dropdown'u aç/kapat
              dropdown.classList.toggle("show");
            });
            
            // Çift tıklama ile temizle
            firmaCell.addEventListener("dblclick", (e) => {
              e.stopPropagation();
              const valueSpan = firmaCell.querySelector(".firma-value");
              if (valueSpan) {
                valueSpan.textContent = "";
              }
              // localStorage'dan sil
              localStorage.removeItem(key);
              // Dropdown'u kapat
              dropdown.classList.remove("show");
              // TL hesapla (boş olduğu için temizlenecek)
              hesaplaTL(rowIdx);
            });
          }
        });
        
        // ONAY butonunu kontrol et ve göster/gizle
        function kontrolOnayButonu(rowIdx) {
          const row = rows[rowIdx];
          if (!row) return;
          
          const firmaCell = row.querySelector("td:first-child");
          const urunCell = row.querySelector("td:nth-child(2)");
          const litreCell = row.querySelector("td:nth-child(3)");
          const odemeTurCell = row.querySelector("td:nth-child(5)");
          const onayCell = row.querySelector("td:nth-child(6)");
          
          if (!firmaCell || !urunCell || !litreCell || !odemeTurCell || !onayCell) return;
          
          // Değerleri kontrol et
          const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
          const urunValue = urunCell.querySelector(".urun-value")?.textContent?.trim();
          const litreInput = litreCell.querySelector(".litre-input");
          const litreValue = litreInput?.value?.trim();
          const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
          
          // Tüm değerler dolu mu kontrol et
          const tumDolu = firmaValue && urunValue && litreValue && odemeTurValue;
          
          // ONAY hücresini hazırla
          onayCell.classList.add("onay-cell");
          
          // Onay butonları kaldırıldı
          if (tumDolu) {
            // Onay butonu kaldırıldı - aktif durumu satır class'ından kontrol ediliyor
            if (row.classList.contains("aktif")) {
              // ONAYLI → ONAYSIZ: Ödeme tablosundan çıkar
              row.classList.remove("aktif");
              localStorage.removeItem(`yakit_onay_aktif_${rowIdx}`);
                  
                  // NAMDAR DBS ise Ödeme tablosundan çıkar
                  const firmaCell = row.querySelector("td:first-child");
                  const odemeTurCell = row.querySelector("td:nth-child(5)");
                  const tlCell = row.querySelector("td:nth-child(4)");
                  
                  if (firmaCell && odemeTurCell && tlCell) {
                    const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
                    const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
                    const tlInput = tlCell.querySelector(".tl-input");
                    
                    if (firmaValue === "NAMDAR" && odemeTurValue === "DBS" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "NAMDAR DBS" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO DBS") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeNamdarDBSSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // NAMDAR HARİCİ TÜM FİRMALAR DBS ise Ödeme tablosundan çıkar
                    if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "DBS" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "ARIA HYPCO DBS" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO DBS") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeAriaDBSSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              aciklamaInput.readOnly = false;
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // NAMDAR HARİCİ TÜM FİRMALAR K.K ise Ödeme tablosundan çıkar
                    if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "K.K" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "ARIA HYPCO K.K" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO K.K") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeAriaKKSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              aciklamaInput.readOnly = false;
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // NAMDAR K.K ise Ödeme tablosundan çıkar
                    if (firmaValue === "NAMDAR" && odemeTurValue === "K.K" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "NAMDAR HYPCO K.K" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO K.K") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeNamdarDBSSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              aciklamaInput.readOnly = false;
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // NAMDAR HARİCİ TÜM FİRMALAR NAKİT ise Ödeme tablosundan çıkar
                    if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "NAKİT" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "ARIA HYPCO NAKİT" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO NAKİT") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeAriaNakitSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              aciklamaInput.readOnly = false;
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // NAMDAR NAKİT ise Ödeme tablosundan çıkar
                    if (firmaValue === "NAMDAR" && odemeTurValue === "NAKİT" && tlInput && tlInput.value.trim()) {
                      // TL değerini parse et
                      const cikarilacakTL = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                      
                      // Ödeme tablosunda "NAMDAR HYPCO NAKİT" satırını bul
                      const odemeRows = document.querySelectorAll("#odeme-tbody tr");
                      for (let i = 0; i < odemeRows.length; i++) {
                        const odemeRow = odemeRows[i];
                        const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
                        
                        if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO NAKİT") {
                          const odemeTLInput = odemeRow.querySelector("input[data-field='tl']");
                          const odemeSira = odemeRow.getAttribute("data-sira");
                          
                          if (odemeTLInput) {
                            // Mevcut TL değerini al
                            const mevcutTL = parseFloat(odemeTLInput.value.replace(/\./g, "").replace(",", ".")) || 0;
                            // Yeni toplam = Mevcut - Çıkarılacak
                            const yeniToplam = Math.max(0, mevcutTL - cikarilacakTL);
                            
                            if (yeniToplam > 0) {
                              // TL: Yeni toplam değer (formatlanmış)
                              const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0
                              });
                              odemeTLInput.value = formattedTL;
                              localStorage.setItem(`odeme_tl_${odemeSira}`, formattedTL);
                              
                              // TL input event'ini manuel tetikle
                              const inputEvent = new Event("input", { bubbles: true });
                              odemeTLInput.dispatchEvent(inputEvent);
                              
                              // Toplam hesaplama için
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            } else {
                              // Toplam 0 veya negatifse satırı temizle
                              // NOT: Input event'ini tetikleme, çünkü kontrolOdemeNamdarDBSSilindi() tüm ONAYLI satırları ONAYSIZ yapar
                              odemeTLInput.value = "";
                              localStorage.removeItem(`odeme_tl_${odemeSira}`);
                              aciklamaInput.value = "";
                              aciklamaInput.readOnly = false;
                              localStorage.removeItem(`odeme_aciklama_${odemeSira}`);
                              // Onay butonu kaldırıldı
                              odemeRow.classList.remove("aktif");
                              localStorage.removeItem(`odeme_aktif_${odemeSira}`);
                              
                              // Toplam hesaplama için (input event tetiklemeden)
                              if (typeof hesaplaOdemeToplam === "function") {
                                hesaplaOdemeToplam();
                              }
                            }
                          }
                          break;
                        }
                      }
                    }
                    
                    // ONAYLI → ONAYSIZ yapıldığında kısıtlamaları kaldır (FİRMA, ÜRÜN, ÖDEME TÜRÜ, LİTRE, TL değiştirilebilir olsun)
                    const firmaCellForUnlock = row.querySelector("td:first-child");
                    const urunCellForUnlock = row.querySelector("td:nth-child(2)");
                    const litreCellForUnlock = row.querySelector("td:nth-child(3)");
                    const tlCellForUnlock = row.querySelector("td:nth-child(4)");
                    const odemeTurCellForUnlock = row.querySelector("td:nth-child(5)");
                    
                    // FİRMA dropdown'ını aktif yap
                    if (firmaCellForUnlock) {
                      const firmaDropdown = firmaCellForUnlock.querySelector(".firma-dropdown");
                      if (firmaDropdown) {
                        firmaDropdown.style.pointerEvents = "auto";
                        firmaDropdown.style.opacity = "1";
                      }
                      firmaCellForUnlock.style.pointerEvents = "auto";
                    }
                    
                    // ÜRÜN dropdown'ını aktif yap
                    if (urunCellForUnlock) {
                      const urunDropdown = urunCellForUnlock.querySelector(".urun-dropdown");
                      if (urunDropdown) {
                        urunDropdown.style.pointerEvents = "auto";
                        urunDropdown.style.opacity = "1";
                      }
                      urunCellForUnlock.style.pointerEvents = "auto";
                    }
                    
                    // LİTRE input'unu aktif yap
                    if (litreCellForUnlock) {
                      const litreInput = litreCellForUnlock.querySelector(".litre-input");
                      if (litreInput) {
                        litreInput.readOnly = false;
                      }
                    }
                    
                    // TL input'unu aktif yap
                    if (tlCellForUnlock) {
                      const tlInput = tlCellForUnlock.querySelector(".tl-input");
                      if (tlInput) {
                        tlInput.readOnly = false;
                      }
                    }
                    
                    // ÖDEME TÜRÜ dropdown'ını aktif yap
                    if (odemeTurCellForUnlock) {
                      const odemeTurDropdown = odemeTurCellForUnlock.querySelector(".odeme-tur-dropdown");
                      if (odemeTurDropdown) {
                        odemeTurDropdown.style.pointerEvents = "auto";
                        odemeTurDropdown.style.opacity = "1";
                      }
                      odemeTurCellForUnlock.style.pointerEvents = "auto";
                    }
                  }
                } else {
                  // ONAYSIZ → ONAYLI: Ödeme tablosuna ekle
                  onayBtn.classList.add("aktif");
                  onayBtn.textContent = "ONAYLI";
                  row.classList.add("aktif");
                  localStorage.setItem(`yakit_onay_aktif_${rowIdx}`, "true");
                  
                  // ONAYLI olduğunda FİRMA, ÜRÜN, LİTRE, ÖDEME TÜRÜ alanlarını değiştirilemez yap
                  const firmaCell = row.querySelector("td:first-child");
                  const urunCell = row.querySelector("td:nth-child(2)");
                  const litreCell = row.querySelector("td:nth-child(3)");
                  const odemeTurCell = row.querySelector("td:nth-child(5)");
                  
                  // FİRMA dropdown'ını devre dışı bırak
                  if (firmaCell) {
                    const firmaDropdown = firmaCell.querySelector(".firma-dropdown");
                    if (firmaDropdown) {
                      firmaDropdown.style.pointerEvents = "none";
                      firmaDropdown.style.opacity = "0.5";
                    }
                    firmaCell.style.pointerEvents = "none";
                  }
                  
                  // ÜRÜN dropdown'ını devre dışı bırak
                  if (urunCell) {
                    const urunDropdown = urunCell.querySelector(".urun-dropdown");
                    if (urunDropdown) {
                      urunDropdown.style.pointerEvents = "none";
                      urunDropdown.style.opacity = "0.5";
                    }
                    urunCell.style.pointerEvents = "none";
                  }
                  
                  // LİTRE input'unu readonly yap
                  if (litreCell) {
                    const litreInput = litreCell.querySelector(".litre-input");
                    if (litreInput) {
                      litreInput.readOnly = true;
                    }
                  }
                  
                  // ÖDEME TÜRÜ dropdown'ını devre dışı bırak
                  if (odemeTurCell) {
                    const odemeTurDropdown = odemeTurCell.querySelector(".odeme-tur-dropdown");
                    if (odemeTurDropdown) {
                      odemeTurDropdown.style.pointerEvents = "none";
                      odemeTurDropdown.style.opacity = "0.5";
                    }
                    odemeTurCell.style.pointerEvents = "none";
                  }
                  
                  // NAMDAR DBS kontrolü ve Ödeme tablosuna yazma
                  kontrolNamdarDBSVeOdemeTablosunaYaz();
                  // NAMDAR HARİCİ TÜM FİRMALAR DBS kontrolü ve Ödeme tablosuna yazma
                  kontrolAriaDBSVeOdemeTablosunaYaz();
                  // NAMDAR HARİCİ FİRMALAR NAKİT kontrolü ve Ödeme tablosuna yazma
                  kontrolAriaNakitVeOdemeTablosunaYaz();
                  // NAMDAR HARİCİ FİRMALAR K.K kontrolü ve Ödeme tablosuna yazma
                  kontrolAriaKKVeOdemeTablosunaYaz();
                  // NAMDAR NAKİT kontrolü ve Ödeme tablosuna yazma
                  kontrolNamdarNakitVeOdemeTablosunaYaz();
                  // NAMDAR K.K kontrolü ve Ödeme tablosuna yazma
                  kontrolNamdarKKVeOdemeTablosunaYaz();
                }
              }); */
            } else {
              // Buton kaldırıldı
            }
          } else {
            // Tüm değerler dolu değil, buton kaldırıldı
            onayCell.innerHTML = "";
            // Aktif class'ını kaldır
            row.classList.remove("aktif");
          }
        }
        
        // NAMDAR DBS ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolNamdarDBSVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let namdarDBSOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // SADECE NAMDAR, SADECE DBS ve ONAYLI kontrolü (NAKİT ve K.K hariç)
            if (firmaValue === "NAMDAR" && odemeTurValue === "DBS" && isOnayli && tlInput && tlInput.value.trim()) {
              namdarDBSOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR DBS ONAYLI satır varsa, Ödeme tablosuna yaz
          if (namdarDBSOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "NAMDAR DBS" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutNamdarDBSSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO DBS") {
                mevcutNamdarDBSSatir = row;
                break;
              }
            }
            
            // Eğer "NAMDAR DBS" satırı varsa, TL değerini güncelle
            if (mevcutNamdarDBSSatir) {
              const tlInput = mevcutNamdarDBSSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutNamdarDBSSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutNamdarDBSSatir.getAttribute("data-sira");
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz (mevcut değere ekleme, çünkü toplamTL zaten tüm ONAYLI satırların toplamı)
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  // Onay butonu kaldırıldı
                  mevcutNamdarDBSSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "NAMDAR DBS" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "NAMDAR HYPCO DBS"
                  aciklamaInput.value = "NAMDAR HYPCO DBS";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "NAMDAR HYPCO DBS");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR HARİCİ TÜM FİRMALAR DBS ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolAriaDBSVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let ariaDBSOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // NAMDAR HARİCİ TÜM FİRMALAR, SADECE DBS ve ONAYLI kontrolü
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "DBS" && isOnayli && tlInput && tlInput.value.trim()) {
              ariaDBSOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR HARİCİ FİRMALAR DBS ONAYLI satır varsa, Ödeme tablosuna yaz
          if (ariaDBSOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "ARIA HYPCO DBS" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutAriaDBSSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO DBS") {
                mevcutAriaDBSSatir = row;
                break;
              }
            }
            
            // Eğer "ARIA HYPCO DBS" satırı varsa, TL değerini güncelle
            if (mevcutAriaDBSSatir) {
              const tlInput = mevcutAriaDBSSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutAriaDBSSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutAriaDBSSatir.getAttribute("data-sira");
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  onayBtn.style.display = "flex";
                  onayBtn.textContent = "ONAYLI";
                  onayBtn.classList.add("aktif");
                  mevcutAriaDBSSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "ARIA HYPCO DBS" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "ARIA HYPCO DBS"
                  aciklamaInput.value = "ARIA HYPCO DBS";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "ARIA HYPCO DBS");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR HARİCİ TÜM FİRMALAR NAKİT ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolAriaNakitVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let ariaNakitOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // NAMDAR HARİCİ TÜM FİRMALAR, SADECE NAKİT ve ONAYLI kontrolü
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "NAKİT" && isOnayli && tlInput && tlInput.value.trim()) {
              ariaNakitOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR HARİCİ FİRMALAR NAKİT ONAYLI satır varsa, Ödeme tablosuna yaz
          if (ariaNakitOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "ARIA HYPCO NAKİT" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutAriaNakitSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO NAKİT") {
                mevcutAriaNakitSatir = row;
                break;
              }
            }
            
            // Eğer "ARIA HYPCO NAKİT" satırı varsa, TL değerini güncelle
            if (mevcutAriaNakitSatir) {
              const aciklamaInputMevcut = mevcutAriaNakitSatir.querySelector("input[data-field='aciklama']");
              const tlInput = mevcutAriaNakitSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutAriaNakitSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutAriaNakitSatir.getAttribute("data-sira");
              
              // AÇIKLAMA ve TL input'larını readonly yap
              if (aciklamaInputMevcut) {
                aciklamaInputMevcut.readOnly = true;
              }
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  onayBtn.style.display = "flex";
                  onayBtn.textContent = "ONAYLI";
                  onayBtn.classList.add("aktif");
                  mevcutAriaNakitSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "ARIA HYPCO NAKİT" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "ARIA HYPCO NAKİT"
                  aciklamaInput.value = "ARIA HYPCO NAKİT";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "ARIA HYPCO NAKİT");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR NAKİT ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolNamdarNakitVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let namdarNakitOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // SADECE NAMDAR, SADECE NAKİT ve ONAYLI kontrolü
            if (firmaValue === "NAMDAR" && odemeTurValue === "NAKİT" && isOnayli && tlInput && tlInput.value.trim()) {
              namdarNakitOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR NAKİT ONAYLI satır varsa, Ödeme tablosuna yaz
          if (namdarNakitOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "NAMDAR HYPCO NAKİT" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutNamdarNakitSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO NAKİT") {
                mevcutNamdarNakitSatir = row;
                break;
              }
            }
            
            // Eğer "NAMDAR HYPCO NAKİT" satırı varsa, TL değerini güncelle
            if (mevcutNamdarNakitSatir) {
              const aciklamaInputMevcut = mevcutNamdarNakitSatir.querySelector("input[data-field='aciklama']");
              const tlInput = mevcutNamdarNakitSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutNamdarNakitSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutNamdarNakitSatir.getAttribute("data-sira");
              
              // AÇIKLAMA ve TL input'larını readonly yap
              if (aciklamaInputMevcut) {
                aciklamaInputMevcut.readOnly = true;
              }
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  onayBtn.style.display = "flex";
                  onayBtn.textContent = "ONAYLI";
                  onayBtn.classList.add("aktif");
                  mevcutNamdarNakitSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "NAMDAR HYPCO NAKİT" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "NAMDAR HYPCO NAKİT"
                  aciklamaInput.value = "NAMDAR HYPCO NAKİT";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "NAMDAR HYPCO NAKİT");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR HARİCİ TÜM FİRMALAR K.K ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolAriaKKVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let ariaKKOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // NAMDAR HARİCİ TÜM FİRMALAR, SADECE K.K ve ONAYLI kontrolü
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "K.K" && isOnayli && tlInput && tlInput.value.trim()) {
              ariaKKOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR HARİCİ FİRMALAR K.K ONAYLI satır varsa, Ödeme tablosuna yaz
          if (ariaKKOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "ARIA HYPCO K.K" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutAriaKKSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "ARIA HYPCO K.K") {
                mevcutAriaKKSatir = row;
                break;
              }
            }
            
            // Eğer "ARIA HYPCO K.K" satırı varsa, TL değerini güncelle
            if (mevcutAriaKKSatir) {
              const aciklamaInputMevcut = mevcutAriaKKSatir.querySelector("input[data-field='aciklama']");
              const tlInput = mevcutAriaKKSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutAriaKKSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutAriaKKSatir.getAttribute("data-sira");
              
              // AÇIKLAMA ve TL input'larını readonly yap
              if (aciklamaInputMevcut) {
                aciklamaInputMevcut.readOnly = true;
              }
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  onayBtn.style.display = "flex";
                  onayBtn.textContent = "ONAYLI";
                  onayBtn.classList.add("aktif");
                  mevcutAriaKKSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "ARIA HYPCO K.K" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "ARIA HYPCO K.K"
                  aciklamaInput.value = "ARIA HYPCO K.K";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "ARIA HYPCO K.K");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // NAMDAR K.K ONAYLI satırların TL toplamını hesapla ve Ödeme tablosuna yaz
        function kontrolNamdarKKVeOdemeTablosunaYaz() {
          // Yakıt Alımları tablosundaki tüm satırları kontrol et
          const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
          let toplamTL = 0;
          let namdarKKOnayliVar = false;
          
          yakitRows.forEach((yakitRow, idx) => {
            const firmaCell = yakitRow.querySelector("td:first-child");
            const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
            const tlCell = yakitRow.querySelector("td:nth-child(4)");
            // const onayBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
            
            if (!firmaCell || !odemeTurCell || !tlCell) return;
            
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const tlInput = tlCell.querySelector(".tl-input");
            const isOnayli = yakitRow.classList.contains("aktif"); // Buton kaldırıldı, satır class'ından kontrol ediliyor
            
            // SADECE NAMDAR, SADECE K.K ve ONAYLI kontrolü
            if (firmaValue === "NAMDAR" && odemeTurValue === "K.K" && isOnayli && tlInput && tlInput.value.trim()) {
              namdarKKOnayliVar = true;
              // TL değerini parse et (formatlanmış olabilir)
              const tlValue = parseFloat(tlInput.value.replace(/\./g, "").replace(",", ".")) || 0;
              if (tlValue > 0) {
                toplamTL += tlValue;
              }
            }
          });
          
          // Eğer NAMDAR K.K ONAYLI satır varsa, Ödeme tablosuna yaz
          if (namdarKKOnayliVar && toplamTL > 0) {
            // Önce Ödeme tablosunda "NAMDAR HYPCO K.K" satırını ara
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            let mevcutNamdarKKSatir = null;
            
            for (let i = 0; i < odemeRows.length; i++) {
              const row = odemeRows[i];
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              if (aciklamaInput && aciklamaInput.value.trim() === "NAMDAR HYPCO K.K") {
                mevcutNamdarKKSatir = row;
                break;
              }
            }
            
            // Eğer "NAMDAR HYPCO K.K" satırı varsa, TL değerini güncelle
            if (mevcutNamdarKKSatir) {
              const aciklamaInputMevcut = mevcutNamdarKKSatir.querySelector("input[data-field='aciklama']");
              const tlInput = mevcutNamdarKKSatir.querySelector("input[data-field='tl']");
              // const onayBtn = mevcutNamdarKKSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
              const sira = mevcutNamdarKKSatir.getAttribute("data-sira");
              
              // AÇIKLAMA ve TL input'larını readonly yap
              if (aciklamaInputMevcut) {
                aciklamaInputMevcut.readOnly = true;
              }
              
              if (tlInput) {
                // Tüm ONAYLI satırların toplamını direkt yaz
                const yeniToplam = toplamTL;

                // TL: Yeni toplam değer (formatlanmış)
                const formattedTL = yeniToplam.toLocaleString("tr-TR", {
                  minimumFractionDigits: 0,
                  maximumFractionDigits: 0
                });
                tlInput.value = formattedTL;
                tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                
                // ONAY butonunu göster (yeşil ONAYLI)
                if (onayBtn) {
                  onayBtn.style.display = "flex";
                  onayBtn.textContent = "ONAYLI";
                  onayBtn.classList.add("aktif");
                  mevcutNamdarKKSatir.classList.add("aktif");
                  localStorage.setItem(`odeme_aktif_${sira}`, "true");
                }
                
                // TL input event'ini manuel tetikle
                const inputEvent = new Event("input", { bubbles: true });
                tlInput.dispatchEvent(inputEvent);
                
                // Toplam hesaplama için
                if (typeof hesaplaOdemeToplam === "function") {
                  hesaplaOdemeToplam();
                }
              }
            } else {
              // "NAMDAR HYPCO K.K" satırı yoksa, ilk boş satıra yaz
              let ilkBosSatir = null;
              
              for (let i = 0; i < odemeRows.length; i++) {
                const row = odemeRows[i];
                const aciklamaInput = row.querySelector("input[data-field='aciklama']");
                const tlInput = row.querySelector("input[data-field='tl']");
                
                // Eğer AÇIKLAMA ve TL boşsa, bu boş satır
                if (aciklamaInput && tlInput && !aciklamaInput.value.trim() && !tlInput.value.trim()) {
                  ilkBosSatir = row;
                  break;
                }
              }
              
              // İlk boş satır bulunduysa yaz
              if (ilkBosSatir) {
                const aciklamaInput = ilkBosSatir.querySelector("input[data-field='aciklama']");
                const tlInput = ilkBosSatir.querySelector("input[data-field='tl']");
                // const onayBtn = ilkBosSatir.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                const sira = ilkBosSatir.getAttribute("data-sira");
                
                if (aciklamaInput && tlInput) {
                  // AÇIKLAMA: "NAMDAR HYPCO K.K"
                  aciklamaInput.value = "NAMDAR HYPCO K.K";
                  aciklamaInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_aciklama_${sira}`, "NAMDAR HYPCO K.K");
                  
                  // TL: Toplam değer (formatlanmış)
                  const formattedTL = toplamTL.toLocaleString("tr-TR", {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                  });
                  tlInput.value = formattedTL;
                  tlInput.readOnly = true; // Manuel değişiklik yapılamaz
                  localStorage.setItem(`odeme_tl_${sira}`, formattedTL);
                  
                  // ONAY butonunu göster (yeşil ONAYLI)
                  if (onayBtn) {
                    // Onay butonu kaldırıldı
                    ilkBosSatir.classList.add("aktif");
                    localStorage.setItem(`odeme_aktif_${sira}`, "true");
                  }
                  
                  // TL input event'ini manuel tetikle (ONAY butonunun görünmesi için)
                  const inputEvent = new Event("input", { bubbles: true });
                  tlInput.dispatchEvent(inputEvent);
                  
                  // Toplam hesaplama için
                  if (typeof hesaplaOdemeToplam === "function") {
                    hesaplaOdemeToplam();
                  }
                }
              }
            }
          }
        }
        
        // Dışarı tıklanınca dropdown'ları kapat
        document.addEventListener("click", (e) => {
          if (!e.target.closest(".firma-cell")) {
            document.querySelectorAll(".firma-dropdown").forEach(dd => {
              dd.classList.remove("show");
            });
          }
        });
        
        // ÜRÜN sütunundaki hücreleri işaretle ve event ekle
        rows.forEach((row, rowIdx) => {
          const urunCell = row.querySelector("td:nth-child(2)");
          if (urunCell) {
            urunCell.classList.add("urun-cell");
            
            // localStorage'dan değeri yükle
            const key = `yakit_urun_${rowIdx}`;
            const saved = localStorage.getItem(key);
            if (saved) {
              urunCell.innerHTML = `<span class="urun-value">${saved}</span>`;
            } else {
              urunCell.innerHTML = `<span class="urun-value"></span>`;
            }
            
            // ÜRÜN yüklendikten sonra TL hesapla (kısa gecikme ile)
            if (saved) {
              setTimeout(() => {
                hesaplaTL(rowIdx);
              }, 50);
            }
            
            // Dropdown oluştur
            const dropdown = document.createElement("div");
            dropdown.className = "urun-dropdown";
            const urunListesi = ["MOTORİN", "BENZİN"];
            urunListesi.forEach(urun => {
              const option = document.createElement("div");
              option.className = "urun-option";
              option.textContent = urun;
              option.addEventListener("click", (e) => {
                e.stopPropagation();
                const valueSpan = urunCell.querySelector(".urun-value");
                if (valueSpan) {
                  valueSpan.textContent = urun;
                }
                // localStorage'a kaydet
                localStorage.setItem(key, urun);
                // Dropdown'u kapat
                dropdown.classList.remove("show");
                // TL hesapla
                hesaplaTL(rowIdx);
                // ONAY butonunu kontrol et
                kontrolOnayButonu(rowIdx);
              });
              dropdown.appendChild(option);
            });
            urunCell.appendChild(dropdown);
            
            // Tıklama eventi
            urunCell.addEventListener("click", (e) => {
              e.stopPropagation();
              // Diğer dropdown'ları kapat
              document.querySelectorAll(".urun-dropdown").forEach(dd => {
                if (dd !== dropdown) {
                  dd.classList.remove("show");
                }
              });
              // Bu dropdown'u aç/kapat
              dropdown.classList.toggle("show");
            });
            
            // Çift tıklama ile temizle
            urunCell.addEventListener("dblclick", (e) => {
              e.stopPropagation();
              const valueSpan = urunCell.querySelector(".urun-value");
              if (valueSpan) {
                valueSpan.textContent = "";
              }
              // localStorage'dan sil
              localStorage.removeItem(key);
              // Dropdown'u kapat
              dropdown.classList.remove("show");
              // TL hesapla (boş olduğu için temizlenecek)
              hesaplaTL(rowIdx);
              // ONAY butonunu kontrol et
              kontrolOnayButonu(rowIdx);
            });
          }
        });
        
        // Dışarı tıklanınca ÜRÜN dropdown'larını kapat
        document.addEventListener("click", (e) => {
          if (!e.target.closest(".urun-cell")) {
            document.querySelectorAll(".urun-dropdown").forEach(dd => {
              dd.classList.remove("show");
            });
          }
          if (!e.target.closest(".odeme-tur-cell")) {
            document.querySelectorAll(".odeme-tur-dropdown").forEach(dd => {
              dd.classList.remove("show");
            });
          }
        });
        
        // LİTRE sütunundaki hücrelere input alanları ekle
        rows.forEach((row, rowIdx) => {
          const litreCell = row.querySelector("td:nth-child(3)");
          if (litreCell) {
            litreCell.classList.add("litre-cell");
            
            // Input oluştur
            const input = document.createElement("input");
            input.type = "text";
            input.className = "litre-input";
            input.inputMode = "numeric";
            input.placeholder = "";
            
            // localStorage'dan değeri yükle
            const key = `yakit_litre_${rowIdx}`;
            const saved = localStorage.getItem(key);
            if (saved) {
              input.value = saved;
              // LİTRE yüklendikten sonra TL hesapla (kısa gecikme ile)
              setTimeout(() => {
                hesaplaTL(rowIdx);
              }, 50);
            }
            
            // Değer değiştiğinde localStorage'a kaydet ve TL hesapla
            input.addEventListener("input", (e) => {
              const value = e.target.value;
              localStorage.setItem(key, value);
              // TL hesapla
              hesaplaTL(rowIdx);
              // ONAY butonunu kontrol et
              kontrolOnayButonu(rowIdx);
            });
            
            // Çift tıklama ile temizle (ONAYLI ise silme yapılamaz)
            input.addEventListener("dblclick", (e) => {
              e.stopPropagation();
              
              // ONAYLI ise silme yapılamaz (buton kaldırıldı, satır class'ından kontrol ediliyor)
              if (row.classList.contains("aktif")) {
                return; // Aktif ise çift tıklama ile silme yapılmaz
              }
              
              input.value = "";
              // localStorage'dan sil
              localStorage.removeItem(key);
              // TL hesapla (boş olduğu için temizlenecek)
              hesaplaTL(rowIdx);
              // ONAY butonunu kontrol et
              kontrolOnayButonu(rowIdx);
            });
            
            // Hücreyi temizle ve input ekle
            litreCell.innerHTML = "";
            litreCell.appendChild(input);
          }
          
          // ÖDEME TÜR sütunundaki hücreleri işaretle ve event ekle
          const odemeTurCell = row.querySelector("td:nth-child(5)");
          if (odemeTurCell) {
            odemeTurCell.classList.add("odeme-tur-cell");
            
            // localStorage'dan değeri yükle
            const key = `yakit_odeme_tur_${rowIdx}`;
            const saved = localStorage.getItem(key);
            if (saved) {
              odemeTurCell.innerHTML = `<span class="odeme-tur-value">${saved}</span>`;
            } else {
              odemeTurCell.innerHTML = `<span class="odeme-tur-value"></span>`;
            }
            
            // Dropdown oluştur
            const dropdown = document.createElement("div");
            dropdown.className = "odeme-tur-dropdown";
            const odemeTurListesi = ["DBS", "NAKİT", "K.K"];
            odemeTurListesi.forEach(odemeTur => {
              const option = document.createElement("div");
              option.className = "odeme-tur-option";
              option.textContent = odemeTur;
              option.addEventListener("click", (e) => {
                e.stopPropagation();
                const valueSpan = odemeTurCell.querySelector(".odeme-tur-value");
                if (valueSpan) {
                  valueSpan.textContent = odemeTur;
                }
                // localStorage'a kaydet
                localStorage.setItem(key, odemeTur);
                // Dropdown'u kapat
                dropdown.classList.remove("show");
                // ONAY butonunu kontrol et
                kontrolOnayButonu(rowIdx);
              });
              dropdown.appendChild(option);
            });
            odemeTurCell.appendChild(dropdown);
            
            // Tıklama eventi
            odemeTurCell.addEventListener("click", (e) => {
              e.stopPropagation();
              // Diğer dropdown'ları kapat
              document.querySelectorAll(".odeme-tur-dropdown").forEach(dd => {
                if (dd !== dropdown) {
                  dd.classList.remove("show");
                }
              });
              // Bu dropdown'u aç/kapat
              dropdown.classList.toggle("show");
            });
            
            // Çift tıklama ile temizle
            odemeTurCell.addEventListener("dblclick", (e) => {
              e.stopPropagation();
              const valueSpan = odemeTurCell.querySelector(".odeme-tur-value");
              if (valueSpan) {
                valueSpan.textContent = "";
              }
              // localStorage'dan sil
              localStorage.removeItem(key);
              // Dropdown'u kapat
              dropdown.classList.remove("show");
              // ONAY butonunu kontrol et
              kontrolOnayButonu(rowIdx);
            });
          }
          
          // TL sütununa input alanı ekle
          const tlCell = row.querySelector("td:nth-child(4)");
          if (tlCell) {
            tlCell.classList.add("tl-cell");
            
            // Input oluştur
            const input = document.createElement("input");
            input.type = "text";
            input.className = "tl-input";
            input.inputMode = "numeric";
            input.placeholder = "";
            input.readOnly = true; // Otomatik hesaplanacak, manuel değiştirilemez
            
            // localStorage'dan değeri yükle
            const key = `yakit_tl_${rowIdx}`;
            const saved = localStorage.getItem(key);
            if (saved) {
              input.value = saved;
            }
            
            // Hücreyi temizle ve input ekle
            tlCell.innerHTML = "";
            tlCell.appendChild(input);
          }
        });
        
        // TL Hesaplama Fonksiyonu
        async function hesaplaTL(rowIdx) {
          const row = rows[rowIdx];
          if (!row) return;
          
          // FİRMA, ÜRÜN ve LİTRE değerlerini al
          const firmaCell = row.querySelector("td:first-child");
          const urunCell = row.querySelector("td:nth-child(2)");
          const litreCell = row.querySelector("td:nth-child(3)");
          const tlCell = row.querySelector("td:nth-child(4)");
          
          if (!firmaCell || !urunCell || !litreCell || !tlCell) return;
          
          const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
          const urunValue = urunCell.querySelector(".urun-value")?.textContent?.trim();
          const litreInput = litreCell.querySelector(".litre-input");
          const tlInput = tlCell.querySelector(".tl-input");
          
          // TL input yoksa işlem yapma
          if (!tlInput) return;
          
          // FIRMA, URUN veya LITRE eksikse TL'yi boş yap
          if (!firmaValue || !urunValue || !litreInput) {
            tlInput.value = "";
            localStorage.setItem(`yakit_tl_${rowIdx}`, "");
            return;
          }
          
          // LITRE değerini kontrol et
          const litre = parseFloat(litreInput.value.replace(/\./g, "").replace(",", ".")) || 0;
          
          // LITRE boş veya 0 ise TL'yi boş yap
          if (litre <= 0) {
            tlInput.value = "";
            localStorage.setItem(`yakit_tl_${rowIdx}`, "");
            return;
          }
          
          // API'den alış fiyatını çek
          try {
            const response = await fetch('/api/alis-fiyati/');
            const data = await response.json();
            
            // FİRMA ve ÜRÜN'e göre fiyatı bul
            // Türkçe karakterleri güvenli şekilde normalize et
            function normalizeFirmaName(name) {
              if (!name) return "";
              const trimmed = name.trim();
              // Türkçe karakterleri manuel olarak çevir
              return trimmed
                .replace(/Ğ/g, "G")
                .replace(/ğ/g, "G")
                .replace(/İ/g, "I")
                .replace(/ı/g, "I")
                .replace(/Ş/g, "S")
                .replace(/ş/g, "S")
                .replace(/Ü/g, "U")
                .replace(/ü/g, "U")
                .replace(/Ö/g, "O")
                .replace(/ö/g, "O")
                .replace(/Ç/g, "C")
                .replace(/ç/g, "C")
                .replace(/\./g, "") // Noktayı kaldır (KOOP. -> KOOP)
                .toUpperCase();
            }
            
            // FİRMA isimlerini API formatına çevir (YAĞCILAR -> YAGCILAR)
            const firmaMapToAPI = {
              "YAGCILAR": "YAGCILAR",
              "TEPEKUM": "TEPEKUM",
              "NAMDAR": "NAMDAR",
              "SEKER": "SEKER",
              "AKOVA": "AKOVA",
              "KOOP": "KOOP",
              "NAZILLI": "NAZILLI"
            };
            const urunMap = {
              "MOTORIN": "MOTORIN",
              "BENZIN": "BENZIN"
            };
            
            // Firma ve ürün değerlerini normalize et
            const normalizedFirma = normalizeFirmaName(firmaValue);
            const normalizedUrun = normalizeFirmaName(urunValue);
            
            // Map'te ara, bulamazsan normalize edilmiş değeri kullan
            let firmaKey = firmaMapToAPI[normalizedFirma] || normalizedFirma;
            let urunKey = urunMap[normalizedUrun] || normalizedUrun;
            
            // API'den gelen key formatı: "YAGCILAR_MOTORIN" veya "YAĞCILAR_MOTORIN" gibi olabilir
            // Önce normalize edilmiş key'i dene
            const apiKey = `${firmaKey}_${urunKey}`;
            let fiyat = data[apiKey];
            
            // Eğer bulunamazsa, API'deki tüm key'leri normalize edip ara
            if (!fiyat || fiyat === 0) {
              for (const [key, value] of Object.entries(data)) {
                // Key'i normalize et ve karşılaştır
                const normalizedKey = normalizeFirmaName(key);
                if (normalizedKey === apiKey) {
                  fiyat = value;
                  console.log(`[TL Hesaplama] Satır ${rowIdx}: Fiyat bulundu (normalize edilmiş key): ${key} -> ${apiKey}`);
                  break;
                }
              }
            }
            
            // Debug: Console'a yazdır (detaylı)
            console.log(`[TL Hesaplama] Satır ${rowIdx}:`);
            console.log(`  - FİRMA (ham): "${firmaValue}"`);
            console.log(`  - FİRMA (normalize): "${normalizedFirma}"`);
            console.log(`  - FİRMA (API key): "${firmaKey}"`);
            console.log(`  - ÜRÜN (ham): "${urunValue}"`);
            console.log(`  - ÜRÜN (normalize): "${normalizedUrun}"`);
            console.log(`  - ÜRÜN (API key): "${urunKey}"`);
            console.log(`  - LİTRE: ${litre}`);
            console.log(`  - API Key (aradığımız): "${apiKey}"`);
            console.log(`  - Fiyat: ${fiyat}`);
            console.log(`  - API'den gelen tüm keys:`, Object.keys(data));
            
            if (fiyat && fiyat > 0) {
              // TL = LİTRE × ALIŞ FİYATI
              const tl = litre * fiyat;
              // Türkçe format: binlik ayırıcı nokta, ondalık ayırıcı virgül
              const formattedTL = tl.toLocaleString('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
              });
              tlInput.value = formattedTL;
              
              // localStorage'a kaydet
              localStorage.setItem(`yakit_tl_${rowIdx}`, formattedTL);
              console.log(`[TL Hesaplama] Satır ${rowIdx}: TL=${formattedTL} hesaplandı`);
            } else {
              tlInput.value = "";
              localStorage.setItem(`yakit_tl_${rowIdx}`, "");
              console.warn(`[TL Hesaplama] Satır ${rowIdx}: Fiyat bulunamadı veya 0 (API Key: ${apiKey})`);
            }
          } catch (error) {
            console.error("Alış fiyatı çekilirken hata:", error);
            tlInput.value = "";
            localStorage.setItem(`yakit_tl_${rowIdx}`, "");
          }
        }
        
        // Sayfa yüklendiğinde tüm satırlar için TL hesapla ve ONAY butonunu kontrol et
        // Tüm hücreler yüklendikten sonra hesapla
        setTimeout(() => {
          rows.forEach((row, rowIdx) => {
            // Her satır için ayrı gecikme ile hesapla (DOM tam hazır olsun)
            setTimeout(() => {
              hesaplaTL(rowIdx);
              kontrolOnayButonu(rowIdx);
            }, 200 + (rowIdx * 50));
          });
          // Sayfa yüklendiğinde NAMDAR DBS, NAKİT ve K.K kontrolü yap
          setTimeout(() => {
            kontrolNamdarDBSVeOdemeTablosunaYaz();
            kontrolAriaDBSVeOdemeTablosunaYaz();
            kontrolAriaNakitVeOdemeTablosunaYaz();
            kontrolAriaKKVeOdemeTablosunaYaz();
            kontrolNamdarNakitVeOdemeTablosunaYaz();
            kontrolNamdarKKVeOdemeTablosunaYaz();
          }, 1000);
        }, 300);
        
        // TEMİZLE butonu kaldırıldı
            // Tüm satırları temizle
            rows.forEach((row, rowIdx) => {
              // FIRMA hücresini temizle
              const firmaCell = row.querySelector("td:first-child");
              if (firmaCell) {
                const valueSpan = firmaCell.querySelector(".firma-value");
                if (valueSpan) {
                  valueSpan.textContent = "";
                }
                localStorage.removeItem(`yakit_firma_${rowIdx}`);
              }
              
              // URUN hücresini temizle
              const urunCell = row.querySelector("td:nth-child(2)");
              if (urunCell) {
                const valueSpan = urunCell.querySelector(".urun-value");
                if (valueSpan) {
                  valueSpan.textContent = "";
                }
                localStorage.removeItem(`yakit_urun_${rowIdx}`);
              }
              
              // LITRE input'unu temizle
              const litreCell = row.querySelector("td:nth-child(3)");
              if (litreCell) {
                const litreInput = litreCell.querySelector(".litre-input");
                if (litreInput) {
                  litreInput.value = "";
                }
                localStorage.removeItem(`yakit_litre_${rowIdx}`);
              }
              
              // TL input'unu temizle
              const tlCell = row.querySelector("td:nth-child(4)");
              if (tlCell) {
                const tlInput = tlCell.querySelector(".tl-input");
                if (tlInput) {
                  tlInput.value = "";
                }
                localStorage.removeItem(`yakit_tl_${rowIdx}`);
              }
              
              // ÖDEME TÜR hücresini temizle
              const odemeTurCell = row.querySelector("td:nth-child(5)");
              if (odemeTurCell) {
                const valueSpan = odemeTurCell.querySelector(".odeme-tur-value");
                if (valueSpan) {
                  valueSpan.textContent = "";
                }
                localStorage.removeItem(`yakit_odeme_tur_${rowIdx}`);
              }

              // ONAY hücresini temizle (buton kaldırıldı)
              const onayCell = row.querySelector("td:nth-child(6)");
              if (onayCell) {
                // Satırdan aktif class'ını kaldır
                row.classList.remove("aktif");
                localStorage.removeItem(`yakit_onay_aktif_${rowIdx}`);
              }
              
              // ONAYLI yapıldığında eklenen kısıtlamaları kaldır (readOnly, pointerEvents)
              // FIRMA hücresini aktif yap
              if (firmaCell) {
                const firmaDropdown = firmaCell.querySelector(".firma-dropdown");
                if (firmaDropdown) {
                  firmaDropdown.style.pointerEvents = "auto";
                  firmaDropdown.style.opacity = "1";
                }
                firmaCell.style.pointerEvents = "auto";
              }
              
              // URUN hücresini aktif yap
              if (urunCell) {
                const urunDropdown = urunCell.querySelector(".urun-dropdown");
                if (urunDropdown) {
                  urunDropdown.style.pointerEvents = "auto";
                  urunDropdown.style.opacity = "1";
                }
                urunCell.style.pointerEvents = "auto";
              }
              
              // LİTRE input'unu aktif yap
              if (litreCell) {
                const litreInput = litreCell.querySelector(".litre-input");
                if (litreInput) {
                  litreInput.readOnly = false;
                }
              }
              
              // ÖDEME TÜRÜ hücresini aktif yap
              if (odemeTurCell) {
                const odemeTurDropdown = odemeTurCell.querySelector(".odeme-tur-dropdown");
                if (odemeTurDropdown) {
                  odemeTurDropdown.style.pointerEvents = "auto";
                  odemeTurDropdown.style.opacity = "1";
                }
                odemeTurCell.style.pointerEvents = "auto";
              }
              
              // TL input'unu aktif yap
              if (tlCell) {
                const tlInput = tlCell.querySelector(".tl-input");
                if (tlInput) {
                  tlInput.readOnly = false;
                }
              }
            });
            
            // ÖDEME tablosunda formül satırlarını bul ve temizle
            const odemeRows = document.querySelectorAll("#odeme-tbody tr");
            const temizlenecekAciklamalar = [
              "NAMDAR HYPCO DBS",
              "NAMDAR HYPCO NAKİT",
              "NAMDAR HYPCO K.K",
              "ARIA HYPCO DBS",
              "ARIA HYPCO NAKİT",
              "ARIA HYPCO K.K"
            ];
            
            for (let i = 0; i < odemeRows.length; i++) {
              const odemeRow = odemeRows[i];
              const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
              
              if (aciklamaInput) {
                const aciklamaDegeri = aciklamaInput.value.trim();
                
                // Eğer bu satır temizlenecek açıklamalardan biri ise
                if (temizlenecekAciklamalar.includes(aciklamaDegeri)) {
                  const sira = odemeRow.getAttribute("data-sira");
                  const tlInput = odemeRow.querySelector("input[data-field='tl']");
                  // const onayBtn = odemeRow.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
                  
                  // AÇIKLAMA hücresini temizle
                  aciklamaInput.value = "";
                  aciklamaInput.readOnly = false;
                  localStorage.removeItem(`odeme_aciklama_${sira}`);
                  
                  // TL hücresini temizle
                  if (tlInput) {
                    tlInput.value = "";
                    tlInput.readOnly = false;
                    localStorage.removeItem(`odeme_tl_${sira}`);
                  }
                  
                  // ONAY butonunu gizle
                  if (onayBtn) {
                    onayBtn.style.display = "none";
                    onayBtn.classList.remove("aktif");
                    onayBtn.textContent = "ONAYSIZ";
                  }
                  
                  // Satırdan aktif class'ını kaldır
                  odemeRow.classList.remove("aktif");
                  localStorage.removeItem(`odeme_aktif_${sira}`);
                }
              }
            }
            
            // Toplam hesaplama için (tüm temizlemelerden sonra)
            if (typeof hesaplaOdemeToplam === "function") {
              hesaplaOdemeToplam();
            }
          });
        }
      }
      
      // ALIŞ FİYATLARI Modal - Buton kaldırıldı
      const alisFiyatiModal = document.createElement("div");
      alisFiyatiModal.className = "alis-fiyati-modal";
      alisFiyatiModal.id = "alis-fiyati-modal";
      
      // Türkçe karakterleri güvenli şekilde normalize et (TL hesaplama ile aynı)
      function normalizeFirmaNameForModal(name) {
        if (!name) return "";
        const trimmed = name.trim();
        // Türkçe karakterleri manuel olarak çevir
        return trimmed
          .replace(/Ğ/g, "G")
          .replace(/ğ/g, "G")
          .replace(/İ/g, "I")
          .replace(/ı/g, "I")
          .replace(/Ş/g, "S")
          .replace(/ş/g, "S")
          .replace(/Ü/g, "U")
          .replace(/ü/g, "U")
          .replace(/Ö/g, "O")
          .replace(/ö/g, "O")
          .replace(/Ç/g, "C")
          .replace(/ç/g, "C")
          .replace(/\./g, "") // Noktayı kaldır (KOOP. -> KOOP)
          .toUpperCase();
      }
      
      // FİRMA isimlerini API formatına çeviren map (normalize edilmiş isimler)
      const firmaMapToAPI = {
        "YAGCILAR": "YAGCILAR",
        "TEPEKUM": "TEPEKUM",
        "NAMDAR": "NAMDAR",
        "SEKER": "SEKER",
        "AKOVA": "AKOVA",
        "KOOP": "KOOP",
        "NAZILLI": "NAZILLI"
      };
      
      // Modal içeriği
      const firmaListesi = ["YAĞCILAR", "TEPEKUM", "NAMDAR", "ŞEKER", "AKOVA", "KOOP.", "NAZİLLİ"];
      let modalContent = `
        <div class="alis-fiyati-modal-content">
          <div class="alis-fiyati-modal-header">
            <h2>ALIŞ FİYATLARI</h2>
          </div>
          <table class="alis-fiyati-table">
            <thead>
              <tr>
                <th>FİRMA</th>
                <th>MOTORİN</th>
                <th>BENZİN</th>
              </tr>
            </thead>
            <tbody>
      `;
      
      firmaListesi.forEach((firma, idx) => {
        modalContent += `
          <tr>
            <td style="font-weight:700; background:#e8f0fe;">${firma}</td>
            <td>
              <input type="text" class="alis-fiyati-input" 
                     data-firma="${firma}" 
                     data-urun="MOTORIN" 
                     data-idx="${idx}"
                     inputmode="decimal" 
                     placeholder="0.00" />
            </td>
            <td>
              <input type="text" class="alis-fiyati-input" 
                     data-firma="${firma}" 
                     data-urun="BENZIN" 
                     data-idx="${idx}"
                     inputmode="decimal" 
                     placeholder="0.00" />
            </td>
          </tr>
        `;
      });
      
      modalContent += `
            </tbody>
          </table>
        </div>
      `;
      
      alisFiyatiModal.innerHTML = modalContent;
      document.body.appendChild(alisFiyatiModal);
      
      // Butonlar kaldırıldı
      // Modal kapat ve kaydet butonları kaldırıldı
          // Kaydet butonu kaldırıldı
            
            // FİRMA ismini normalize et ve API formatına çevir
            const normalizedFirma = normalizeFirmaNameForModal(firma);
            const firmaAPI = firmaMapToAPI[normalizedFirma] || normalizedFirma;
            
            updates.push({
              sube: firmaAPI,
              urun: urun,
              fiyat: value
            });
          });
          
          // Her bir fiyatı kaydet
          try {
            let successCount = 0;
            for (const update of updates) {
              const response = await fetch('/api/alis-fiyati/', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(update)
              });
              
              if (response.ok) {
                successCount++;
              }
            }
            
            if (successCount === updates.length) {
              alert('✅ Alış fiyatları başarıyla kaydedildi!');
              alisFiyatiModal.classList.remove("show");
            } else {
              alert('⚠️ Bazı fiyatlar kaydedilemedi. Lütfen tekrar deneyin.');
            }
          } catch (error) {
            console.error("Fiyatlar kaydedilirken hata:", error);
            alert('❌ Hata: Fiyatlar kaydedilemedi. Lütfen tekrar deneyin.');
          }
        });
      }
  });

  // Arac Bilgi Modal - Butonlar kaldırıldı
  const aracBilgiModal = document.getElementById("arac-bilgi-modal");
  const aracBilgiForm = document.getElementById("arac-bilgi-form");
  const aracBilgiTbody = document.getElementById("arac-bilgi-tbody");

  // 20 satır tablo oluştur
  function createAracBilgiTable() {
    if (!aracBilgiTbody) return;
    aracBilgiTbody.innerHTML = "";
    for (let i = 1; i <= 20; i++) {
      const row = document.createElement("tr");
      row.setAttribute("data-sira-row", i);
      row.innerHTML = `
        <td>
          <span>${i}</span>
        </td>
        <td><input type="text" name="firma_${i}" data-sira="${i}" data-field="firma" value=""></td>
        <td><input type="text" name="sofor_${i}" data-sira="${i}" data-field="sofor" value=""></td>
        <td><input type="text" name="tc_${i}" data-sira="${i}" data-field="tc" value=""></td>
        <td><input type="text" name="dorse_${i}" data-sira="${i}" data-field="dorse" value=""></td>
        <td><input type="text" name="cekici_${i}" data-sira="${i}" data-field="cekici" value=""></td>
        <td><input type="text" name="goz_1_${i}" data-sira="${i}" data-field="goz_1" value=""></td>
        <td><input type="text" name="goz_2_${i}" data-sira="${i}" data-field="goz_2" value=""></td>
        <td><input type="text" name="goz_3_${i}" data-sira="${i}" data-field="goz_3" value=""></td>
        <td><input type="text" name="goz_4_${i}" data-sira="${i}" data-field="goz_4" value=""></td>
        <td><input type="text" name="goz_5_${i}" data-sira="${i}" data-field="goz_5" value=""></td>
        <td><input type="text" name="goz_6_${i}" data-sira="${i}" data-field="goz_6" value=""></td>
        <td><input type="text" name="toplam_litre_${i}" data-sira="${i}" data-field="toplam_litre" value=""></td>
        <td><input type="text" name="tasima_siniri_lt_${i}" data-sira="${i}" data-field="tasima_siniri_lt" value=""></td>
      `;
      aracBilgiTbody.appendChild(row);
      
      // Sıra butonuna tıklama event'i kaldırıldı
      // const siraBtn = row.querySelector(`.arac-bilgi-sira-btn[data-sira="${i}"]`);
      // if (siraBtn) {
      //   siraBtn.addEventListener("click", async () => {
          // Satırı aktif/pasif yap (toggle)
          const isAktif = row.classList.contains("aktif");
          if (isAktif) {
            row.classList.remove("aktif");
            siraBtn.classList.remove("aktif");
          } else {
            row.classList.add("aktif");
            siraBtn.classList.add("aktif");
          }
          
          // SQL'e hemen kaydet
          try {
            const aracData = {
              sira_no: i,
              firma: row.querySelector(`input[data-field="firma"]`)?.value.trim() || '',
              sofor: row.querySelector(`input[data-field="sofor"]`)?.value.trim() || '',
              tc: row.querySelector(`input[data-field="tc"]`)?.value.trim() || '',
              dorse: row.querySelector(`input[data-field="dorse"]`)?.value.trim() || '',
              cekici: row.querySelector(`input[data-field="cekici"]`)?.value.trim() || '',
              goz_1: row.querySelector(`input[data-field="goz_1"]`)?.value.trim() || '',
              goz_2: row.querySelector(`input[data-field="goz_2"]`)?.value.trim() || '',
              goz_3: row.querySelector(`input[data-field="goz_3"]`)?.value.trim() || '',
              goz_4: row.querySelector(`input[data-field="goz_4"]`)?.value.trim() || '',
              goz_5: row.querySelector(`input[data-field="goz_5"]`)?.value.trim() || '',
              goz_6: row.querySelector(`input[data-field="goz_6"]`)?.value.trim() || '',
              toplam_litre: row.querySelector(`input[data-field="toplam_litre"]`)?.value.trim() || '',
              tasima_siniri_lt: row.querySelector(`input[data-field="tasima_siniri_lt"]`)?.value.trim() || '',
              aktif: !isAktif,
            };
            
            await fetch("/api/arac-bilgi/", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(aracData),
            });
          } catch (error) {
            console.error(`Araç ${i} aktif durum kayıt hatası:`, error);
          }
        }); */
      // }
    // }
  }

  // Tüm araç verilerini yükle
  async function loadAllAracBilgi() {
    try {
      const response = await fetch("/api/arac-bilgi/");
      if (response.ok) {
        const araclar = await response.json();
        araclar.forEach(arac => {
          const sira = arac.sira_no;
          const row = aracBilgiTbody.querySelector(`tr[data-sira-row="${sira}"]`);
          if (!row) return;
          
          // Input değerlerini yükle
          const inputs = row.querySelectorAll(`input[data-sira="${sira}"]`);
          inputs.forEach(input => {
            const field = input.getAttribute("data-field");
            input.value = arac[field] || "";
          });
          
          // Aktif durumunu yükle
          if (arac.aktif) {
            row.classList.add("aktif");
            // Sıra butonu kaldırıldı
          }
        });
      }
    } catch (error) {
      console.error("Veri yükleme hatası:", error);
    }
  }

  // Modal aç/kapat butonları kaldırıldı
  function closeAracBilgiModal() {
    aracBilgiModal.classList.remove("show");
  }

  // Modal dışına tıklayınca kapat
  aracBilgiModal.addEventListener("click", (e) => {
    if (e.target === aracBilgiModal) {
      closeAracBilgiModal();
    }
  });

  // Form submit - 20 aracın tümünü kaydet
  if (aracBilgiForm) {
    aracBilgiForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      
      const araclar = [];
      for (let i = 1; i <= 20; i++) {
        const row = aracBilgiTbody.querySelector(`tr[data-sira-row="${i}"]`);
        if (!row) continue;
        
        const inputs = row.querySelectorAll(`input[data-sira="${i}"]`);
        const aracData = { sira_no: i };
        inputs.forEach(input => {
          const field = input.getAttribute("data-field");
          aracData[field] = input.value.trim();
        });
        
        // Aktif durumunu ekle
        aracData.aktif = row.classList.contains("aktif");
        
        araclar.push(aracData);
      }

      try {
        let successCount = 0;
        let errorCount = 0;
        
        // Her aracı tek tek kaydet
        for (const aracData of araclar) {
          try {
            const response = await fetch("/api/arac-bilgi/", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(aracData),
            });
            
            if (response.ok) {
              successCount++;
            } else {
              errorCount++;
            }
          } catch (error) {
            errorCount++;
            console.error(`Araç ${aracData.sira_no} kayıt hatası:`, error);
          }
        }
        
        if (errorCount === 0) {
          alert(`Tüm araç bilgileri kaydedildi! (${successCount} araç)`);
          closeAracBilgiModal();
        } else {
          alert(`${successCount} araç kaydedildi, ${errorCount} araçta hata oluştu.`);
        }
      } catch (error) {
        console.error("Hata:", error);
        alert("Bir hata oluştu: " + error.message);
      }
    });
  }

  // Tahsilat ve Ödeme tablolarını oluştur (35 satır)
  function createTahsilatTable() {
    const tbody = document.getElementById("tahsilat-tbody");
    if (!tbody) return;
    tbody.innerHTML = "";
    for (let i = 1; i <= 35; i++) {
      const row = document.createElement("tr");
      row.setAttribute("data-sira", i);
      row.innerHTML = `
        <td><input type="text" name="tahsilat_aciklama_${i}" data-sira="${i}" data-field="aciklama" value=""></td>
        <td><input type="text" name="tahsilat_tl_${i}" data-sira="${i}" data-field="tl" inputmode="numeric" value=""></td>
        <td class="onay-cell"></td>
      `;
      tbody.appendChild(row);
      
      // Çift tıklama ile hücre temizleme
      const inputs = row.querySelectorAll("input");
      inputs.forEach(input => {
        const field = input.getAttribute("data-field");
        const sira = input.getAttribute("data-sira");
        
        // localStorage'dan yükle
        const saved = localStorage.getItem(`tahsilat_${field}_${sira}`);
        if (saved) {
          // TL alanı ise formatlanmış olarak yükle, değilse direkt yükle
          if (field === "tl") {
            // Eğer formatlanmamışsa formatla
            const numValue = parseInt(saved.replace(/[^\d]/g, "")) || 0;
            if (numValue > 0) {
              input.value = numValue.toLocaleString("tr-TR");
            } else {
              input.value = saved;
            }
          } else {
            input.value = saved;
          }
        }
        
        // Değişiklikleri localStorage'a kaydet (TL için özel event listener var, buraya gelmemeli)
        if (field !== "tl") {
          input.addEventListener("input", () => {
            if (input.value.trim()) {
              localStorage.setItem(`tahsilat_${field}_${sira}`, input.value);
            } else {
              localStorage.removeItem(`tahsilat_${field}_${sira}`);
            }
          });
        }
        
        input.addEventListener("dblclick", () => {
          if (input.value.trim()) {
            input.value = "";
            localStorage.removeItem(`tahsilat_${field}_${sira}`);
            // TL input'u temizlenince ONAY butonunu gizle
            if (field === "tl") {
              // Onay butonu kaldırıldı
              row.classList.remove("aktif");
            }
          }
        });
      });
      
      // TL input değişince ONAY butonunu göster/gizle
      const tlInput = row.querySelector("input[data-field='tl']");
      const onayBtn = row.querySelector(".onay-toggle-btn");
      if (tlInput && onayBtn) {
        // Sayfa yüklendiğinde kontrol et
        if (tlInput.value.trim()) {
          onayBtn.style.display = "flex";
        }
        
        // Aktif durumu localStorage'dan yükle (buton kaldırıldı)
        const aktifDurum = localStorage.getItem(`tahsilat_aktif_${i}`);
        if (aktifDurum === "true") {
          row.classList.add("aktif");
        }
        
        tlInput.addEventListener("input", (e) => {
          // Sadece rakamları al
          let value = e.target.value.replace(/[^\d]/g, "");
          
          if (value.trim()) {
            // Sayıya çevir ve 1000'lik ayırıcı ile formatla
            const numValue = parseInt(value) || 0;
            const formatted = numValue.toLocaleString("tr-TR");
            e.target.value = formatted;
            
            // localStorage'a kaydet (formatlanmış değeri)
            localStorage.setItem(`tahsilat_tl_${i}`, formatted);
          } else {
            e.target.value = "";
            localStorage.removeItem(`tahsilat_tl_${i}`);
            row.classList.remove("aktif");
            localStorage.removeItem(`tahsilat_aktif_${i}`);
          }
          // TL değiştiğinde toplamı güncelle (sadece ONAYLI ise)
          if (row.classList.contains("aktif")) {
            hesaplaTahsilatToplam();
          }
        });
      }
      
      // ONAY butonu: tek tıklama toggle, çift tıklama satırı sil
      if (onayBtn) {
        let lastClickTime = 0;
        let clickTimer = null;
        
        // onayBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          const currentTime = Date.now();
          const timeDiff = currentTime - lastClickTime;
          
          // Çift tıklama kontrolü (300ms içinde)
          if (timeDiff < 300 && clickTimer) {
            clearTimeout(clickTimer);
            clickTimer = null;
            lastClickTime = 0;
            // Çift tıklama - satırı sil
            const sira = onayBtn.getAttribute("data-sira");
            const inputs = row.querySelectorAll("input");
            inputs.forEach(input => {
              const field = input.getAttribute("data-field");
              input.value = "";
              localStorage.removeItem(`tahsilat_${field}_${sira}`);
            });
            onayBtn.style.display = "none";
            onayBtn.classList.remove("aktif");
            onayBtn.textContent = "ONAYSIZ";
            row.classList.remove("aktif");
            localStorage.removeItem(`tahsilat_aktif_${sira}`);
            return;
          }
          
          lastClickTime = currentTime;
          
          // Tek tıklama - toggle
          clickTimer = setTimeout(() => {
            clickTimer = null;
            const sira = onayBtn.getAttribute("data-sira");
            if (row.classList.contains("aktif")) {
              row.classList.remove("aktif");
              onayBtn.classList.remove("aktif");
              onayBtn.textContent = "ONAYSIZ";
              localStorage.removeItem(`tahsilat_aktif_${sira}`);
            } else {
              row.classList.add("aktif");
              onayBtn.classList.add("aktif");
              onayBtn.textContent = "ONAYLI";
              localStorage.setItem(`tahsilat_aktif_${sira}`, "true");
            }
            // Toggle sonrası toplamı güncelle
            hesaplaTahsilatToplam();
          }, 250);
        });
      }
      
      // Sayfa yüklendiğinde TL değerini kontrol et ve ONAY butonunu göster
      if (tlInput && onayBtn && tlInput.value.trim()) {
        onayBtn.style.display = "flex";
      }
    }
  }

  // Tahsilat TL toplamını hesapla (sadece ONAYLI satırlar)
  function hesaplaTahsilatToplam() {
    try {
      const rows = document.querySelectorAll("#tahsilat-tbody tr");
      let toplam = 0;
      
      rows.forEach(row => {
        // Sadece aktif (ONAYLI) satırları hesapla
        if (row.classList.contains("aktif")) {
          const tlInput = row.querySelector("input[data-field='tl']");
          if (tlInput && tlInput.value.trim()) {
            // Formatlanmış değeri parse et (noktaları kaldır)
            const deger = parseFloat(tlInput.value.replace(/[^\d]/g, "")) || 0;
            toplam += deger;
          }
        }
      });
      
      // Yeşil bara yaz (1000'lik ayırıcı ile)
      const tahTotal = document.getElementById("tahTotal");
      if (tahTotal) {
        tahTotal.textContent = "₺" + toplam.toLocaleString("tr-TR", {minimumFractionDigits: 0, maximumFractionDigits: 0});
      }
      // Genel toplamı güncelle
      hesaplaGenelToplam();
    } catch (error) {
      console.error("Tahsilat toplam hesaplama hatası:", error);
    }
  }

  // Ödeme TL toplamını hesapla (sadece ONAYLI satırlar)
  function hesaplaOdemeToplam() {
    try {
      const rows = document.querySelectorAll("#odeme-tbody tr");
      let toplam = 0;
      
      rows.forEach(row => {
        // Sadece aktif (ONAYLI) satırları hesapla
        if (row.classList.contains("aktif")) {
          const tlInput = row.querySelector("input[data-field='tl']");
          if (tlInput && tlInput.value.trim()) {
            // Formatlanmış değeri parse et (noktaları kaldır)
            const deger = parseFloat(tlInput.value.replace(/[^\d]/g, "")) || 0;
            toplam += deger;
          }
        }
      });
      
      // Kırmızı bara yaz (1000'lik ayırıcı ile)
      const odemeTotal = document.getElementById("odemeTotal");
      if (odemeTotal) {
        odemeTotal.textContent = "₺" + toplam.toLocaleString("tr-TR", {minimumFractionDigits: 0, maximumFractionDigits: 0});
      }
      // Genel toplamı güncelle
      hesaplaGenelToplam();
    } catch (error) {
      console.error("Ödeme toplam hesaplama hatası:", error);
    }
  }

  // Genel toplamı hesapla: Tahsilat - Ödeme
  function hesaplaGenelToplam() {
    try {
      const tahTotalElement = document.getElementById("tahTotal");
      const odemeTotalElement = document.getElementById("odemeTotal");
      const genelTotalElement = document.getElementById("genelTotal");
      
      if (!tahTotalElement || !odemeTotalElement || !genelTotalElement) {
        return;
      }
      
      // Tahsilat toplamını al (binlik ayırıcıları kaldır)
      const tahTotalText = tahTotalElement.textContent.replace(/[^\d.,]/g, "").replace(/\./g, "").replace(",", ".");
      const tahTotal = parseFloat(tahTotalText) || 0;
      
      // Ödeme toplamını al (binlik ayırıcıları kaldır)
      const odemeTotalText = odemeTotalElement.textContent.replace(/[^\d.,]/g, "").replace(/\./g, "").replace(",", ".");
      const odemeTotal = parseFloat(odemeTotalText) || 0;
      
      // Genel toplam = Tahsilat - Ödeme
      const genelToplam = tahTotal - odemeTotal;
      
      // Genel toplam barına yaz (1000'lik ayırıcı ile)
      genelTotalElement.textContent = "₺" + genelToplam.toLocaleString("tr-TR", {minimumFractionDigits: 0, maximumFractionDigits: 0});
    } catch (error) {
      console.error("Genel toplam hesaplama hatası:", error);
    }
  }

  // Tahsilat tablosunu temizle
  function temizleTahsilatTable() {
    const rows = document.querySelectorAll("#tahsilat-tbody tr");
    rows.forEach(row => {
      const sira = row.getAttribute("data-sira");
      const inputs = row.querySelectorAll("input");
      inputs.forEach(input => {
        const field = input.getAttribute("data-field");
        input.value = "";
        localStorage.removeItem(`tahsilat_${field}_${sira}`);
      });
      // Onay butonu kaldırıldı - aktif durumu temizle
      row.classList.remove("aktif");
      localStorage.removeItem(`tahsilat_aktif_${sira}`);
    });
    // Toplamı sıfırla
    hesaplaTahsilatToplam();
  }

  // Ödeme tablosunu temizle
  function temizleOdemeTable() {
    const rows = document.querySelectorAll("#odeme-tbody tr");
    rows.forEach(row => {
      const sira = row.getAttribute("data-sira");
      const inputs = row.querySelectorAll("input");
      inputs.forEach(input => {
        const field = input.getAttribute("data-field");
        input.value = "";
        input.readOnly = false; // readOnly özelliğini kaldır
        localStorage.removeItem(`odeme_${field}_${sira}`);
      });
      // Onay butonu kaldırıldı - aktif durumu temizle
      row.classList.remove("aktif");
      localStorage.removeItem(`odeme_aktif_${sira}`);
      
      // Eğer "NAMDAR HYPCO DBS" veya "ARIA HYPCO DBS" satırı varsa, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
      kontrolOdemeNamdarDBSSilindi(row);
      kontrolOdemeAriaDBSSilindi(row);
      kontrolOdemeAriaNakitSilindi(row);
      kontrolOdemeAriaKKSilindi(row);
    });
    // Toplamı sıfırla
    hesaplaOdemeToplam();
  }
  
  // Ödeme tablosunda NAMDAR HYPCO DBS satırı silindiğinde Yakıt Alımları tablosundaki NAMDAR DBS ONAYLI satırları ONAYSIZ'a çevir
  function kontrolOdemeNamdarDBSSilindi(odemeRow) {
    const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
    const tlInput = odemeRow.querySelector("input[data-field='tl']");
    // const onayBtn = odemeRow.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
    
    // Eğer AÇIKLAMA boşsa veya "NAMDAR HYPCO DBS" değilse, veya TL boşsa, veya ONAY butonu görünmüyorsa
    const aciklamaDegeri = aciklamaInput ? aciklamaInput.value.trim() : "";
    const tlDegeri = tlInput ? tlInput.value.trim() : "";
    const onayGorunuyor = onayBtn && onayBtn.style.display !== "none";
    
    // Eğer satır tamamen temizlenmişse veya "NAMDAR HYPCO DBS"/"NAMDAR HYPCO NAKİT"/"NAMDAR HYPCO K.K" değilse, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
    if ((!aciklamaDegeri || (aciklamaDegeri !== "NAMDAR HYPCO DBS" && aciklamaDegeri !== "NAMDAR HYPCO NAKİT" && aciklamaDegeri !== "NAMDAR HYPCO K.K")) || !tlDegeri || !onayGorunuyor) {
      // Input'ların readOnly özelliğini kaldır (artık manuel yazılabilir)
      if (aciklamaInput) {
        aciklamaInput.readOnly = false;
      }
      if (tlInput) {
        tlInput.readOnly = false;
      }
      const yakitTable = document.querySelector(".yakit-table");
      if (yakitTable) {
        const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
        yakitRows.forEach((yakitRow, yakitIdx) => {
          const firmaCell = yakitRow.querySelector("td:first-child");
          const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
          const onayYakitBtn = yakitRow.querySelector(".onay-yakit-btn");
          
          if (firmaCell && odemeTurCell && onayYakitBtn) {
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const isOnayli = onayYakitBtn.classList.contains("aktif");
            
            // NAMDAR DBS, NAKİT veya K.K ONAYLI satırları ONAYSIZ'a çevir
            if (firmaValue === "NAMDAR" && isOnayli) {
              if (odemeTurValue === "DBS") {
                onayYakitBtn.classList.remove("aktif");
                onayYakitBtn.textContent = "ONAYSIZ";
                yakitRow.classList.remove("aktif");
                localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
              } else if (odemeTurValue === "NAKİT") {
                onayYakitBtn.classList.remove("aktif");
                onayYakitBtn.textContent = "ONAYSIZ";
                yakitRow.classList.remove("aktif");
                localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
              } else if (odemeTurValue === "K.K") {
                onayYakitBtn.classList.remove("aktif");
                onayYakitBtn.textContent = "ONAYSIZ";
                yakitRow.classList.remove("aktif");
                localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
              }
            }
          }
        });
      }
    }
  }
  
  // Ödeme tablosunda ARIA HYPCO DBS satırı silindiğinde Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR DBS ONAYLI satırları ONAYSIZ'a çevir
  function kontrolOdemeAriaDBSSilindi(odemeRow) {
    const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
    const tlInput = odemeRow.querySelector("input[data-field='tl']");
    // const onayBtn = odemeRow.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
    
    const aciklamaDegeri = aciklamaInput ? aciklamaInput.value.trim() : "";
    const tlDegeri = tlInput ? tlInput.value.trim() : "";
    const onayGorunuyor = onayBtn && onayBtn.style.display !== "none";
    
    // Eğer satır tamamen temizlenmişse veya "ARIA HYPCO DBS" değilse, Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR DBS ONAYLI satırları ONAYSIZ'a çevir
    if ((!aciklamaDegeri || aciklamaDegeri !== "ARIA HYPCO DBS") || !tlDegeri || !onayGorunuyor) {
      // Input'ların readOnly özelliğini kaldır (artık manuel yazılabilir)
      if (aciklamaInput) {
        aciklamaInput.readOnly = false;
      }
      if (tlInput) {
        tlInput.readOnly = false;
      }
      const yakitTable = document.querySelector(".yakit-table");
      if (yakitTable) {
        const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
        yakitRows.forEach((yakitRow, yakitIdx) => {
          const firmaCell = yakitRow.querySelector("td:first-child");
          const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
          const onayYakitBtn = yakitRow.querySelector(".onay-yakit-btn");
          
          if (firmaCell && odemeTurCell && onayYakitBtn) {
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const isOnayli = onayYakitBtn.classList.contains("aktif");
            
            // NAMDAR HARİCİ TÜM FİRMALAR DBS ONAYLI satırları ONAYSIZ'a çevir
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "DBS" && isOnayli) {
              onayYakitBtn.classList.remove("aktif");
              onayYakitBtn.textContent = "ONAYSIZ";
              yakitRow.classList.remove("aktif");
              localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
            }
          }
        });
      }
    }
  }
  
  // Ödeme tablosunda ARIA HYPCO NAKİT satırı silindiğinde Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR NAKİT ONAYLI satırları ONAYSIZ'a çevir
  function kontrolOdemeAriaNakitSilindi(odemeRow) {
    const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
    const tlInput = odemeRow.querySelector("input[data-field='tl']");
    // const onayBtn = odemeRow.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
    
    const aciklamaDegeri = aciklamaInput ? aciklamaInput.value.trim() : "";
    const tlDegeri = tlInput ? tlInput.value.trim() : "";
    const onayGorunuyor = onayBtn && onayBtn.style.display !== "none";
    
    // Eğer satır tamamen temizlenmişse veya "ARIA HYPCO NAKİT" değilse, Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR NAKİT ONAYLI satırları ONAYSIZ'a çevir
    if ((!aciklamaDegeri || aciklamaDegeri !== "ARIA HYPCO NAKİT") || !tlDegeri || !onayGorunuyor) {
      // Input'ların readOnly özelliğini kaldır (artık manuel yazılabilir)
      if (aciklamaInput) {
        aciklamaInput.readOnly = false;
      }
      if (tlInput) {
        tlInput.readOnly = false;
      }
      const yakitTable = document.querySelector(".yakit-table");
      if (yakitTable) {
        const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
        yakitRows.forEach((yakitRow, yakitIdx) => {
          const firmaCell = yakitRow.querySelector("td:first-child");
          const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
          const onayYakitBtn = yakitRow.querySelector(".onay-yakit-btn");
          
          if (firmaCell && odemeTurCell && onayYakitBtn) {
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const isOnayli = onayYakitBtn.classList.contains("aktif");
            
            // NAMDAR HARİCİ TÜM FİRMALAR NAKİT ONAYLI satırları ONAYSIZ'a çevir
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "NAKİT" && isOnayli) {
              onayYakitBtn.classList.remove("aktif");
              onayYakitBtn.textContent = "ONAYSIZ";
              yakitRow.classList.remove("aktif");
              localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
            }
          }
        });
      }
    }
  }
  
  // Ödeme tablosunda ARIA HYPCO K.K satırı silindiğinde Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR K.K ONAYLI satırları ONAYSIZ'a çevir
  function kontrolOdemeAriaKKSilindi(odemeRow) {
    const aciklamaInput = odemeRow.querySelector("input[data-field='aciklama']");
    const tlInput = odemeRow.querySelector("input[data-field='tl']");
    // const onayBtn = odemeRow.querySelector(".onay-toggle-btn"); // Buton kaldırıldı
    
    const aciklamaDegeri = aciklamaInput ? aciklamaInput.value.trim() : "";
    const tlDegeri = tlInput ? tlInput.value.trim() : "";
    const onayGorunuyor = onayBtn && onayBtn.style.display !== "none";
    
    // Eğer satır tamamen temizlenmişse veya "ARIA HYPCO K.K" değilse, Yakıt Alımları tablosundaki NAMDAR HARİCİ FİRMALAR K.K ONAYLI satırları ONAYSIZ'a çevir
    if ((!aciklamaDegeri || aciklamaDegeri !== "ARIA HYPCO K.K") || !tlDegeri || !onayGorunuyor) {
      // Input'ların readOnly özelliğini kaldır (artık manuel yazılabilir)
      if (aciklamaInput) {
        aciklamaInput.readOnly = false;
      }
      if (tlInput) {
        tlInput.readOnly = false;
      }
      const yakitTable = document.querySelector(".yakit-table");
      if (yakitTable) {
        const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
        yakitRows.forEach((yakitRow, yakitIdx) => {
          const firmaCell = yakitRow.querySelector("td:first-child");
          const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
          const onayYakitBtn = yakitRow.querySelector(".onay-yakit-btn");
          
          if (firmaCell && odemeTurCell && onayYakitBtn) {
            const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
            const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
            const isOnayli = onayYakitBtn.classList.contains("aktif");
            
            // NAMDAR HARİCİ TÜM FİRMALAR K.K ONAYLI satırları ONAYSIZ'a çevir
            if (firmaValue && firmaValue !== "NAMDAR" && odemeTurValue === "K.K" && isOnayli) {
              onayYakitBtn.classList.remove("aktif");
              onayYakitBtn.textContent = "ONAYSIZ";
              yakitRow.classList.remove("aktif");
              localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
            }
          }
        });
      }
    }
  }
  
  function createOdemeTable() {
    const tbody = document.getElementById("odeme-tbody");
    if (!tbody) return;
    tbody.innerHTML = "";
    for (let i = 1; i <= 35; i++) {
      const row = document.createElement("tr");
      row.setAttribute("data-sira", i);
      row.innerHTML = `
        <td><input type="text" name="odeme_aciklama_${i}" data-sira="${i}" data-field="aciklama" value=""></td>
        <td><input type="text" name="odeme_tl_${i}" data-sira="${i}" data-field="tl" inputmode="numeric" value=""></td>
        <td class="onay-cell"></td>
      `;
      tbody.appendChild(row);
      
      // Çift tıklama ile hücre temizleme
      const inputs = row.querySelectorAll("input");
      inputs.forEach(input => {
        const field = input.getAttribute("data-field");
        const sira = input.getAttribute("data-sira");
        
        // localStorage'dan yükle
        const saved = localStorage.getItem(`odeme_${field}_${sira}`);
        if (saved) {
          // TL alanı ise formatlanmış olarak yükle, değilse direkt yükle
          if (field === "tl") {
            // Eğer formatlanmamışsa formatla
            const numValue = parseInt(saved.replace(/[^\d]/g, "")) || 0;
            if (numValue > 0) {
              input.value = numValue.toLocaleString("tr-TR");
            } else {
              input.value = saved;
            }
          } else {
            input.value = saved;
          }
          
          // Eğer AÇIKLAMA "NAMDAR HYPCO DBS", "NAMDAR HYPCO NAKİT", "NAMDAR HYPCO K.K", "ARIA HYPCO DBS", "ARIA HYPCO NAKİT" veya "ARIA HYPCO K.K" ise, input'u readonly yap
          if (field === "aciklama" && (saved === "NAMDAR HYPCO DBS" || saved === "NAMDAR HYPCO NAKİT" || saved === "NAMDAR HYPCO K.K" || saved === "ARIA HYPCO DBS" || saved === "ARIA HYPCO NAKİT" || saved === "ARIA HYPCO K.K")) {
            input.readOnly = true;
            // TL input'unu da readonly yap
            const tlInputRow = row.querySelector("input[data-field='tl']");
            if (tlInputRow) {
              tlInputRow.readOnly = true;
            }
          }
        }
        
        // Değişiklikleri localStorage'a kaydet (TL için özel event listener var, buraya gelmemeli)
        if (field !== "tl") {
          // Eğer AÇIKLAMA "NAMDAR HYPCO DBS", "NAMDAR HYPCO NAKİT", "NAMDAR HYPCO K.K", "ARIA HYPCO DBS", "ARIA HYPCO NAKİT" veya "ARIA HYPCO K.K" ise, input'u readonly yap
          if (field === "aciklama" && (input.value.trim() === "NAMDAR HYPCO DBS" || input.value.trim() === "NAMDAR HYPCO NAKİT" || input.value.trim() === "NAMDAR HYPCO K.K" || input.value.trim() === "ARIA HYPCO DBS" || input.value.trim() === "ARIA HYPCO NAKİT" || input.value.trim() === "ARIA HYPCO K.K")) {
            input.readOnly = true;
          }
          
          input.addEventListener("input", () => {
            if (input.value.trim()) {
              localStorage.setItem(`odeme_${field}_${sira}`, input.value);
              // Eğer AÇIKLAMA "NAMDAR HYPCO DBS", "NAMDAR HYPCO NAKİT", "NAMDAR HYPCO K.K", "ARIA HYPCO DBS", "ARIA HYPCO NAKİT" veya "ARIA HYPCO K.K" olarak değiştirilirse, readonly yap
              if (field === "aciklama" && (input.value.trim() === "NAMDAR HYPCO DBS" || input.value.trim() === "NAMDAR HYPCO NAKİT" || input.value.trim() === "NAMDAR HYPCO K.K" || input.value.trim() === "ARIA HYPCO DBS" || input.value.trim() === "ARIA HYPCO NAKİT" || input.value.trim() === "ARIA HYPCO K.K")) {
                input.readOnly = true;
                // TL input'unu da readonly yap
                if (input.value.trim() === "ARIA HYPCO DBS" || input.value.trim() === "ARIA HYPCO NAKİT" || input.value.trim() === "ARIA HYPCO K.K") {
                  const tlInputRow = row.querySelector("input[data-field='tl']");
                  if (tlInputRow) {
                    tlInputRow.readOnly = true;
                  }
                }
              } else if (field === "aciklama") {
                input.readOnly = false;
              }
            } else {
              localStorage.removeItem(`odeme_${field}_${sira}`);
              // Eğer AÇIKLAMA siliniyorsa ve "NAMDAR HYPCO DBS" veya "ARIA HYPCO DBS" ise, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
              if (field === "aciklama") {
                input.readOnly = false;
                kontrolOdemeNamdarDBSSilindi(row);
                kontrolOdemeAriaDBSSilindi(row);
              }
            }
          });
        }
        
        input.addEventListener("dblclick", () => {
          // Eğer input readonly ise (NAMDAR HYPCO DBS/NAKİT/K.K), çift tıklama ile silme yapılmasın
          if (input.readOnly) {
            return;
          }
          
          if (input.value.trim()) {
            input.value = "";
            localStorage.removeItem(`odeme_${field}_${sira}`);
            // TL input'u temizlenince ONAY butonunu gizle
            if (field === "tl") {
              // Onay butonu kaldırıldı
              row.classList.remove("aktif");
            }
            // Eğer "NAMDAR HYPCO DBS", "ARIA HYPCO DBS" veya "ARIA HYPCO NAKİT" satırı siliniyorsa, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
            kontrolOdemeNamdarDBSSilindi(row);
            kontrolOdemeAriaDBSSilindi(row);
            kontrolOdemeAriaNakitSilindi(row);
          }
        });
      });
      
      // TL input değişince ONAY butonunu göster/gizle
      const tlInput = row.querySelector("input[data-field='tl']");
      const onayBtn = row.querySelector(".onay-toggle-btn");
      if (tlInput && onayBtn) {
        // Sayfa yüklendiğinde kontrol et
        if (tlInput.value.trim()) {
          onayBtn.style.display = "flex";
        }
        
        // Aktif durumu localStorage'dan yükle
        const aktifDurum = localStorage.getItem(`odeme_aktif_${i}`);
        if (aktifDurum === "true") {
          row.classList.add("aktif");
          onayBtn.classList.add("aktif");
          onayBtn.textContent = "ONAYLI";
        } else {
          onayBtn.textContent = "ONAYSIZ";
        }
        
        tlInput.addEventListener("input", (e) => {
          // Sadece rakamları al
          let value = e.target.value.replace(/[^\d]/g, "");
          
          if (value.trim()) {
            // Sayıya çevir ve 1000'lik ayırıcı ile formatla
            const numValue = parseInt(value) || 0;
            const formatted = numValue.toLocaleString("tr-TR");
            e.target.value = formatted;
            
            // localStorage'a kaydet (formatlanmış değeri)
            localStorage.setItem(`odeme_tl_${i}`, formatted);
            
            onayBtn.style.display = "flex";
          } else {
            e.target.value = "";
            localStorage.removeItem(`odeme_tl_${i}`);
            onayBtn.style.display = "none";
            onayBtn.classList.remove("aktif");
            onayBtn.textContent = "ONAYSIZ";
            row.classList.remove("aktif");
            localStorage.removeItem(`odeme_aktif_${i}`);
            // Eğer "NAMDAR HYPCO DBS", "ARIA HYPCO DBS" veya "ARIA HYPCO NAKİT" satırı siliniyorsa, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
            kontrolOdemeNamdarDBSSilindi(row);
            kontrolOdemeAriaDBSSilindi(row);
            kontrolOdemeAriaNakitSilindi(row);
          }
          // TL değiştiğinde toplamı güncelle (sadece ONAYLI ise)
          if (row.classList.contains("aktif")) {
            hesaplaOdemeToplam();
          }
        });
      }
      
      // ONAY butonu: tek tıklama toggle, çift tıklama satırı sil
      if (onayBtn) {
        let lastClickTime = 0;
        let clickTimer = null;
        
        // onayBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          const currentTime = Date.now();
          const timeDiff = currentTime - lastClickTime;
          
          // Çift tıklama kontrolü (300ms içinde)
          if (timeDiff < 300 && clickTimer) {
            clearTimeout(clickTimer);
            clickTimer = null;
            lastClickTime = 0;
            // Çift tıklama - satırı sil
            const sira = onayBtn.getAttribute("data-sira");
            const inputs = row.querySelectorAll("input");
            inputs.forEach(input => {
              const field = input.getAttribute("data-field");
              input.value = "";
              input.readOnly = false; // readOnly özelliğini kaldır
              localStorage.removeItem(`odeme_${field}_${sira}`);
            });
            onayBtn.style.display = "none";
            onayBtn.classList.remove("aktif");
            onayBtn.textContent = "ONAYSIZ";
            row.classList.remove("aktif");
            localStorage.removeItem(`odeme_aktif_${sira}`);
            // Eğer "NAMDAR HYPCO DBS", "ARIA HYPCO DBS" veya "ARIA HYPCO NAKİT" satırı siliniyorsa, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
            kontrolOdemeNamdarDBSSilindi(row);
            kontrolOdemeAriaDBSSilindi(row);
            kontrolOdemeAriaNakitSilindi(row);
            hesaplaOdemeToplam();
            return;
          }
          
          lastClickTime = currentTime;
          
          // Tek tıklama - toggle
          clickTimer = setTimeout(() => {
            clickTimer = null;
            const sira = onayBtn.getAttribute("data-sira");
            if (row.classList.contains("aktif")) {
              // ONAYLI → ONAYSIZ
              row.classList.remove("aktif");
              onayBtn.classList.remove("aktif");
              onayBtn.textContent = "ONAYSIZ";
              localStorage.removeItem(`odeme_aktif_${sira}`);
              
              // Eğer bu satır "NAMDAR DBS/NAKİT/K.K" veya "ARIA HYPCO DBS" ise, Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir ve Ödeme satırını temizle
              const aciklamaInput = row.querySelector("input[data-field='aciklama']");
              const aciklamaDegeri = aciklamaInput ? aciklamaInput.value.trim() : "";
              
              if (aciklamaDegeri === "NAMDAR HYPCO DBS" || aciklamaDegeri === "NAMDAR HYPCO NAKİT" || aciklamaDegeri === "NAMDAR HYPCO K.K" || aciklamaDegeri === "ARIA HYPCO DBS" || aciklamaDegeri === "ARIA HYPCO NAKİT" || aciklamaDegeri === "ARIA HYPCO K.K") {
                // Ödeme tablosundaki satırı temizle
                const inputs = row.querySelectorAll("input");
                inputs.forEach(input => {
                  const field = input.getAttribute("data-field");
                  input.value = "";
                  input.readOnly = false; // readOnly özelliğini kaldır
                  localStorage.removeItem(`odeme_${field}_${sira}`);
                });
                onayBtn.style.display = "none";
                
                // Yakıt Alımları tablosundaki ilgili ONAYLI satırları ONAYSIZ'a çevir
                const yakitTable = document.querySelector(".yakit-table");
                if (yakitTable) {
                  const yakitRows = Array.from(yakitTable.querySelectorAll("tbody tr"));
                  yakitRows.forEach((yakitRow, yakitIdx) => {
                    const firmaCell = yakitRow.querySelector("td:first-child");
                    const odemeTurCell = yakitRow.querySelector("td:nth-child(5)");
                    // const onayYakitBtn = yakitRow.querySelector(".onay-yakit-btn"); // Buton kaldırıldı
                    
                    if (firmaCell && odemeTurCell && onayYakitBtn) {
                      const firmaValue = firmaCell.querySelector(".firma-value")?.textContent?.trim();
                      const odemeTurValue = odemeTurCell.querySelector(".odeme-tur-value")?.textContent?.trim();
                      const isOnayli = onayYakitBtn.classList.contains("aktif");
                      
                      // NAMDAR DBS, NAKİT veya K.K ONAYLI satırları ONAYSIZ'a çevir
                      if (firmaValue === "NAMDAR" && isOnayli) {
                        if (aciklamaDegeri === "NAMDAR HYPCO DBS" && odemeTurValue === "DBS") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        } else if (aciklamaDegeri === "NAMDAR HYPCO NAKİT" && odemeTurValue === "NAKİT") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        } else if (aciklamaDegeri === "NAMDAR HYPCO K.K" && odemeTurValue === "K.K") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        }
                      }
                      
                      // NAMDAR HARİCİ TÜM FİRMALAR DBS ONAYLI satırları ONAYSIZ'a çevir
                      if (firmaValue && firmaValue !== "NAMDAR" && isOnayli) {
                        if (aciklamaDegeri === "ARIA HYPCO DBS" && odemeTurValue === "DBS") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        } else if (aciklamaDegeri === "ARIA HYPCO NAKİT" && odemeTurValue === "NAKİT") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        } else if (aciklamaDegeri === "ARIA HYPCO K.K" && odemeTurValue === "K.K") {
                          onayYakitBtn.classList.remove("aktif");
                          onayYakitBtn.textContent = "ONAYSIZ";
                          yakitRow.classList.remove("aktif");
                          localStorage.removeItem(`yakit_onay_aktif_${yakitIdx}`);
                        }
                      }
                    }
                  });
                }
              } else {
                // "NAMDAR HYPCO DBS/NAKİT/K.K" değilse, readOnly özelliğini kaldır (manuel yazılabilir)
                if (aciklamaInput) {
                  aciklamaInput.readOnly = false;
                }
                const tlInputRow = row.querySelector("input[data-field='tl']");
                if (tlInputRow) {
                  tlInputRow.readOnly = false;
                }
              }
            } else {
              // ONAYSIZ → ONAYLI
              row.classList.add("aktif");
              onayBtn.classList.add("aktif");
              onayBtn.textContent = "ONAYLI";
              localStorage.setItem(`odeme_aktif_${sira}`, "true");
            }
            // Toggle sonrası toplamı güncelle
            hesaplaOdemeToplam();
          }, 250);
        });
      }
      
      // Sayfa yüklendiğinde TL değerini kontrol et ve ONAY butonunu göster
      if (tlInput && onayBtn && tlInput.value.trim()) {
        onayBtn.style.display = "flex";
      }
    }
    // Ödeme datalist'i güncelle
    updateOdemeDatalist();
  }

  // HYPCO tablosunu oluştur
  function createHypcoTable() {
    const tbody = document.getElementById("hypco-tbody");
    if (!tbody) return;
    tbody.innerHTML = "";
    // 3 veri satırı: 1. satır Aria, 2. satır Namdar (mavi başlık gibi), 3. satır boş input
    const row1 = document.createElement("tr");
    row1.setAttribute("data-sira", 1);
    row1.innerHTML = `
      <td style="background:#1e3a8a;color:#fff;font-weight:700;text-align:center;padding:6px 4px;">Aria</td>
      <td><input type="text" name="hypco_nakit_limit_1" data-sira="1" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_dbs_limit_1" data-sira="1" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_top_borc_1" data-sira="1" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row1);
    
    const row2 = document.createElement("tr");
    row2.setAttribute("data-sira", 2);
    row2.innerHTML = `
      <td style="background:#1e3a8a;color:#fff;font-weight:700;text-align:center;padding:6px 4px;">Namdar</td>
      <td><input type="text" name="hypco_nakit_limit_2" data-sira="2" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_dbs_limit_2" data-sira="2" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_top_borc_2" data-sira="2" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row2);
    
    const row3 = document.createElement("tr");
    row3.setAttribute("data-sira", 3);
    row3.innerHTML = `
      <td><input type="text" name="hypco_firma_3" data-sira="3" data-field="firma" value=""></td>
      <td><input type="text" name="hypco_nakit_limit_3" data-sira="3" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_dbs_limit_3" data-sira="3" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="hypco_top_borc_3" data-sira="3" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row3);
  }

  // AYGAZ tablosunu oluştur
  function createAygazTable() {
    const tbody = document.getElementById("aygaz-tbody");
    if (!tbody) return;
    tbody.innerHTML = "";
    // 3 veri satırı: 1. satır Aria, 2. satır Namdar (mavi başlık gibi), 3. satır boş input
    const row1 = document.createElement("tr");
    row1.setAttribute("data-sira", 1);
    row1.innerHTML = `
      <td style="background:#1e3a8a;color:#fff;font-weight:700;text-align:center;padding:6px 4px;">Aria</td>
      <td><input type="text" name="aygaz_nakit_limit_1" data-sira="1" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_dbs_limit_1" data-sira="1" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_top_borc_1" data-sira="1" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row1);
    
    const row2 = document.createElement("tr");
    row2.setAttribute("data-sira", 2);
    row2.innerHTML = `
      <td style="background:#1e3a8a;color:#fff;font-weight:700;text-align:center;padding:6px 4px;">Namdar</td>
      <td><input type="text" name="aygaz_nakit_limit_2" data-sira="2" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_dbs_limit_2" data-sira="2" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_top_borc_2" data-sira="2" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row2);
    
    const row3 = document.createElement("tr");
    row3.setAttribute("data-sira", 3);
    row3.innerHTML = `
      <td><input type="text" name="aygaz_firma_3" data-sira="3" data-field="firma" value=""></td>
      <td><input type="text" name="aygaz_nakit_limit_3" data-sira="3" data-field="nakit_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_dbs_limit_3" data-sira="3" data-field="dbs_limit" inputmode="numeric" value=""></td>
      <td><input type="text" name="aygaz_top_borc_3" data-sira="3" data-field="top_borc" inputmode="numeric" value=""></td>
    `;
    tbody.appendChild(row3);
  }

  // Tahsilat Açıklama Modal - Butonlar kaldırıldı
  const tahsilatAciklamaModal = document.getElementById("tahsilat-aciklama-modal");
  const tahsilatAciklamaInputs = document.getElementById("tahsilat-aciklama-inputs");

  // 15 satır input oluştur
  function createTahsilatAciklamaInputs() {
    if (!tahsilatAciklamaInputs) return;
    tahsilatAciklamaInputs.innerHTML = "";
    for (let i = 1; i <= 15; i++) {
      const row = document.createElement("div");
      row.className = "tahsilat-aciklama-input-row";
      row.innerHTML = `
        <label>${i}:</label>
        <input type="text" id="tahsilat-aciklama-${i}" data-sira="${i}" placeholder="Açıklama ${i}">
      `;
      tahsilatAciklamaInputs.appendChild(row);
    }
  }

  // localStorage'dan yükle (modal'daki veriler için farklı key kullan)
  function loadTahsilatAciklama() {
    for (let i = 1; i <= 15; i++) {
      const input = document.getElementById(`tahsilat-aciklama-${i}`);
      if (input) {
        const saved = localStorage.getItem(`tahsilat_aciklama_modal_${i}`);
        if (saved) {
          input.value = saved;
        }
      }
    }
    updateTahsilatDatalist();
  }

  // localStorage'a kaydet ve datalist güncelle (modal'daki veriler için farklı key kullan)
  function saveTahsilatAciklama() {
    const aciklamalar = [];
    for (let i = 1; i <= 20; i++) {
      const input = document.getElementById(`tahsilat-aciklama-${i}`);
      if (input) {
        const value = input.value.trim();
        if (value) {
          localStorage.setItem(`tahsilat_aciklama_modal_${i}`, value);
          aciklamalar.push(value);
        } else {
          localStorage.removeItem(`tahsilat_aciklama_modal_${i}`);
        }
      }
    }
    updateTahsilatDatalist();
    return aciklamalar;
  }

  // Tahsilat tablosundaki AÇIKLAMA hücrelerine datalist ekle (sadece modal'dan gelen veriler)
  function updateTahsilatDatalist() {
    const aciklamalar = [];
    for (let i = 1; i <= 15; i++) {
      const saved = localStorage.getItem(`tahsilat_aciklama_modal_${i}`);
      if (saved && saved.trim()) {
        aciklamalar.push(saved.trim());
      }
    }

    // Datalist oluştur veya güncelle
    let datalist = document.getElementById("tahsilat-aciklama-datalist");
    if (!datalist) {
      datalist = document.createElement("datalist");
      datalist.id = "tahsilat-aciklama-datalist";
      document.body.appendChild(datalist);
    }
    datalist.innerHTML = "";
    aciklamalar.forEach(aciklama => {
      const option = document.createElement("option");
      option.value = aciklama;
      datalist.appendChild(option);
    });

    // Tüm AÇIKLAMA input'larına datalist bağla
    const aciklamaInputs = document.querySelectorAll("#tahsilat-tbody input[data-field='aciklama']");
    aciklamaInputs.forEach(input => {
      input.setAttribute("list", "tahsilat-aciklama-datalist");
    });
  }

  // Modal aç/kapat/kaydet butonları kaldırıldı
  function closeTahsilatAciklamaModal() {
    tahsilatAciklamaModal.classList.remove("show");
  }

  // Modal dışına tıklayınca kapat
  if (tahsilatAciklamaModal) {
    tahsilatAciklamaModal.addEventListener("click", (e) => {
      if (e.target === tahsilatAciklamaModal) {
        closeTahsilatAciklamaModal();
      }
    });
  }

  // Ödeme Açıklama Modal - Butonlar kaldırıldı
  const odemeAciklamaModal = document.getElementById("odeme-aciklama-modal");
  const odemeAciklamaInputs = document.getElementById("odeme-aciklama-inputs");

  // 15 satır input oluştur
  function createOdemeAciklamaInputs() {
    if (!odemeAciklamaInputs) return;
    odemeAciklamaInputs.innerHTML = "";
    for (let i = 1; i <= 15; i++) {
      const row = document.createElement("div");
      row.className = "odeme-aciklama-input-row";
      row.innerHTML = `
        <label>${i}:</label>
        <input type="text" id="odeme-aciklama-${i}" data-sira="${i}" placeholder="Açıklama ${i}">
      `;
      odemeAciklamaInputs.appendChild(row);
    }
  }

  // localStorage'dan yükle (modal'daki veriler için farklı key kullan)
  function loadOdemeAciklama() {
    for (let i = 1; i <= 20; i++) {
      const input = document.getElementById(`odeme-aciklama-${i}`);
      if (input) {
        const saved = localStorage.getItem(`odeme_aciklama_modal_${i}`);
        if (saved) {
          input.value = saved;
        }
      }
    }
    updateOdemeDatalist();
  }

  // localStorage'a kaydet ve datalist güncelle (modal'daki veriler için farklı key kullan)
  function saveOdemeAciklama() {
    const aciklamalar = [];
    for (let i = 1; i <= 15; i++) {
      const input = document.getElementById(`odeme-aciklama-${i}`);
      if (input) {
        const value = input.value.trim();
        if (value) {
          localStorage.setItem(`odeme_aciklama_modal_${i}`, value);
          aciklamalar.push(value);
        } else {
          localStorage.removeItem(`odeme_aciklama_modal_${i}`);
        }
      }
    }
    updateOdemeDatalist();
    return aciklamalar;
  }

  // Ödeme tablosundaki AÇIKLAMA hücrelerine datalist ekle (sadece modal'dan gelen veriler)
  function updateOdemeDatalist() {
    const aciklamalar = [];
    for (let i = 1; i <= 15; i++) {
      const saved = localStorage.getItem(`odeme_aciklama_modal_${i}`);
      if (saved && saved.trim()) {
        aciklamalar.push(saved.trim());
      }
    }

    // Datalist oluştur veya güncelle
    let datalist = document.getElementById("odeme-aciklama-datalist");
    if (!datalist) {
      datalist = document.createElement("datalist");
      datalist.id = "odeme-aciklama-datalist";
      document.body.appendChild(datalist);
    }
    datalist.innerHTML = "";
    aciklamalar.forEach(aciklama => {
      const option = document.createElement("option");
      option.value = aciklama;
      datalist.appendChild(option);
    });

    // Ödeme tablosundaki tüm AÇIKLAMA input'larına datalist ekle
    const odemeAciklamaInputs = document.querySelectorAll("#odeme-tbody input[data-field='aciklama']");
    odemeAciklamaInputs.forEach(input => {
      input.setAttribute("list", "odeme-aciklama-datalist");
    });
  }

  // Modal aç/kapat/kaydet butonları kaldırıldı
  function closeOdemeAciklamaModal() {
    odemeAciklamaModal.classList.remove("show");
  }

  // Modal dışına tıklayınca kapat
  if (odemeAciklamaModal) {
    odemeAciklamaModal.addEventListener("click", (e) => {
      if (e.target === odemeAciklamaModal) {
        closeOdemeAciklamaModal();
      }
    });
  }

  // Tahsilat ve Ödeme Temizle butonları kaldırıldı

  // Sayfa yüklendiğinde tabloları oluştur
  document.addEventListener("DOMContentLoaded", () => {
    createTahsilatTable();
    createOdemeTable();
    createHypcoTable();
    createAygazTable();
    // Tahsilat datalist'i güncelle ve toplamı hesapla
    setTimeout(() => {
      updateTahsilatDatalist();
      hesaplaTahsilatToplam();
    }, 100);
    // Ödeme datalist'i güncelle ve toplamı hesapla
    setTimeout(() => {
      updateOdemeDatalist();
      hesaplaOdemeToplam();
    }, 100);
    // Genel toplamı hesapla
    setTimeout(() => {
      hesaplaGenelToplam();
    }, 150);
  });

  // Telerik Grid - MOTORİN Tablosu
  $(document).ready(function() {
    // Örnek veri (gerçek veriler localStorage'dan veya API'den gelecek)
    var motorinData = [];
    
    // Tarih satırlarını oluştur
    var tarihler = ["11.01 Pazar", "12.01 Pazartesi", "13.01 Salı", "14.01 Çarşamba", "15.01 Perşembe", "16.01 Cuma", "17.01 Cumartesi", "18.01 Pazar", "19.01 Pazartesi", "20.01 Salı", "21.01 Çarşamba", "22.01 Perşembe", "23.01 Cuma", "24.01 Cumartesi", "25.01 Pazar"];
    
    for (var i = 0; i < tarihler.length; i++) {
      motorinData.push({
        tarih: tarihler[i],
        yagcilar: Math.floor(Math.random() * 3000) + 4000,
        tepekum: Math.floor(Math.random() * 3000) + 4000,
        namdar: Math.floor(Math.random() * 2000) + 2000,
        seker: Math.floor(Math.random() * 3000) + 3000,
        akova: Math.floor(Math.random() * 3000) + 3000,
        koop: Math.floor(Math.random() * 3000) + 3000,
        nazilli: Math.floor(Math.random() * 3000) + 4000
      });
    }
    
    // Sayıyı parse et
    function parseNum(str) {
      if (!str || str.trim() === "") return null;
      return parseFloat(String(str).replace(/\./g, "").replace(",", ".")) || null;
    }
    
    // Renk kontrolü için template
    function getCellTemplate(fieldName) {
      return function(dataItem) {
        var value = dataItem[fieldName];
        var numValue = parseNum(value);
        var cellClass = "";
        var cellStyle = "";
        
        if (numValue !== null) {
          if (numValue < 6000) {
            cellClass = "warning-cell";
            cellStyle = "background-color: #dc3545 !important; color: #fff !important; font-weight: 700;";
          } else if (numValue >= 6000) {
            cellClass = "success-cell";
            cellStyle = "background-color: #1fa34a !important; color: #fff !important; font-weight: 700;";
          }
        }
        
        return "<span class='" + cellClass + "' style='" + cellStyle + "'>" + (value || "") + "</span>";
      };
    }
    
    // Telerik Grid oluştur
    $("#motorin-telerik-grid-container").kendoGrid({
      dataSource: {
        data: motorinData,
        pageSize: 10,
        schema: {
          model: {
            fields: {
              tarih: { type: "string" },
              yagcilar: { type: "number" },
              tepekum: { type: "number" },
              namdar: { type: "number" },
              seker: { type: "number" },
              akova: { type: "number" },
              koop: { type: "number" },
              nazilli: { type: "number" }
            }
          }
        }
      },
      height: 400,
      scrollable: true,
      sortable: {
        mode: "multiple",
        allowUnsort: true
      },
      filterable: {
        mode: "row"
      },
      pageable: {
        pageSizes: [5, 10, 20, "all"],
        buttonCount: 5,
        pageSize: 10
      },
      columns: [
        { field: "tarih", title: "Tarih", width: "120px", filterable: { cell: { operator: "contains" } } },
        { field: "yagcilar", title: "YAĞCILAR", width: "100px", template: getCellTemplate("yagcilar"), filterable: { cell: { operator: "gte" } } },
        { field: "tepekum", title: "TEPEKUM", width: "100px", template: getCellTemplate("tepekum"), filterable: { cell: { operator: "gte" } } },
        { field: "namdar", title: "NAMDAR", width: "100px", template: getCellTemplate("namdar"), filterable: { cell: { operator: "gte" } } },
        { field: "seker", title: "ŞEKER", width: "100px", template: getCellTemplate("seker"), filterable: { cell: { operator: "gte" } } },
        { field: "akova", title: "AKOVA", width: "100px", template: getCellTemplate("akova"), filterable: { cell: { operator: "gte" } } },
        { field: "koop", title: "KOOP.", width: "100px", template: getCellTemplate("koop"), filterable: { cell: { operator: "gte" } } },
        { field: "nazilli", title: "NAZİLLİ", width: "100px", template: getCellTemplate("nazilli"), filterable: { cell: { operator: "gte" } } }
      ]
    });
  });
</script>
</body>
</html>
